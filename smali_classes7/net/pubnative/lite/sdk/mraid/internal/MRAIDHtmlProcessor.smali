.class public Lnet/pubnative/lite/sdk/mraid/internal/MRAIDHtmlProcessor;
.super Ljava/lang/Object;
.source "MRAIDHtmlProcessor.java"


# direct methods
.method public constructor <init>()V
    .locals 0

    .line 1
    invoke-direct {p0}, Ljava/lang/Object;-><init>()V

    return-void
.end method

.method public static processRawHtml(Ljava/lang/String;)Ljava/lang/String;
    .locals 9

    .line 1
    new-instance v0, Ljava/lang/StringBuffer;

    invoke-direct {v0, p0}, Ljava/lang/StringBuffer;-><init>(Ljava/lang/String;)V

    const-string v1, "<script\\s+[^>]*\\bsrc\\s*=\\s*([\"\'])mraid\\.js\\1[^>]*>\\s*</script>\\n*"

    const/4 v2, 0x2

    .line 2
    invoke-static {v1, v2}, Ljava/util/regex/Pattern;->compile(Ljava/lang/String;I)Ljava/util/regex/Pattern;

    move-result-object v1

    .line 3
    invoke-virtual {v1, v0}, Ljava/util/regex/Pattern;->matcher(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;

    .line 4
    invoke-static {p0}, Lnet/pubnative/lite/sdk/mraid/internal/MRAIDHtmlProcessor;->removeAllScripts(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v1

    const-string v3, "<html"

    invoke-virtual {v1, v3}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v1

    .line 5
    invoke-static {p0}, Lnet/pubnative/lite/sdk/mraid/internal/MRAIDHtmlProcessor;->removeAllScripts(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    const-string v4, "<head"

    invoke-virtual {v3, v4}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v3

    .line 6
    invoke-static {p0}, Lnet/pubnative/lite/sdk/mraid/internal/MRAIDHtmlProcessor;->removeAllScripts(Ljava/lang/String;)Ljava/lang/String;

    move-result-object p0

    const-string v4, "<body"

    invoke-virtual {p0, v4}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result p0

    const-string v4, "line.separator"

    .line 7
    invoke-static {v4}, Ljava/lang/System;->getProperty(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v4

    const-string v5, "</head>"

    const-string v6, "<head>"

    const/4 v7, 0x0

    if-nez v1, :cond_2

    if-nez p0, :cond_0

    .line 8
    new-instance p0, Ljava/lang/StringBuilder;

    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "<body><div id=\'hybid-ad\' align=\'center\'>"

    invoke-virtual {p0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {p0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object p0

    invoke-virtual {v0, v7, p0}, Ljava/lang/StringBuffer;->insert(ILjava/lang/String;)Ljava/lang/StringBuffer;

    const-string p0, "</div></body>"

    .line 9
    invoke-virtual {v0, p0}, Ljava/lang/StringBuffer;->append(Ljava/lang/String;)Ljava/lang/StringBuffer;

    :cond_0
    if-nez v3, :cond_1

    .line 10
    new-instance p0, Ljava/lang/StringBuilder;

    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {p0, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {p0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {p0, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {p0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object p0

    invoke-virtual {v0, v7, p0}, Ljava/lang/StringBuffer;->insert(ILjava/lang/String;)Ljava/lang/StringBuffer;

    .line 11
    :cond_1
    new-instance p0, Ljava/lang/StringBuilder;

    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "<html>"

    invoke-virtual {p0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {p0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object p0

    invoke-virtual {v0, v7, p0}, Ljava/lang/StringBuffer;->insert(ILjava/lang/String;)Ljava/lang/StringBuffer;

    .line 12
    invoke-virtual {v0, v4}, Ljava/lang/StringBuffer;->append(Ljava/lang/String;)Ljava/lang/StringBuffer;

    const-string p0, "</html>"

    invoke-virtual {v0, p0}, Ljava/lang/StringBuffer;->append(Ljava/lang/String;)Ljava/lang/StringBuffer;

    goto :goto_1

    :cond_2
    if-nez v3, :cond_3

    const-string p0, "<html[^>]*>"

    .line 13
    invoke-static {p0, v2}, Ljava/util/regex/Pattern;->compile(Ljava/lang/String;I)Ljava/util/regex/Pattern;

    move-result-object p0

    .line 14
    invoke-virtual {p0, v0}, Ljava/util/regex/Pattern;->matcher(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;

    move-result-object p0

    const/4 v1, 0x0

    .line 15
    :goto_0
    invoke-virtual {p0, v1}, Ljava/util/regex/Matcher;->find(I)Z

    move-result v1

    if-eqz v1, :cond_3

    .line 16
    invoke-virtual {p0}, Ljava/util/regex/Matcher;->end()I

    move-result v1

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v0, v1, v3}, Ljava/lang/StringBuffer;->insert(ILjava/lang/String;)Ljava/lang/StringBuffer;

    .line 17
    invoke-virtual {p0}, Ljava/util/regex/Matcher;->end()I

    move-result v1

    goto :goto_0

    :cond_3
    :goto_1
    const-string p0, "Ly8KLy8gIG1yYWlkLmpzCi8vCgooZnVuY3Rpb24gKCkgewoKICAgIGNvbnNvbGUubG9nKCJNUkFJRCBvYmplY3QgbG9hZGluZy4uLiIpOwoKICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKICAgICAqIGNvbnNvbGUgbG9nZ2luZyBoZWxwZXIKICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCiAgICB2YXIgTG9nTGV2ZWxFbnVtID0gewogICAgICAgICJERUJVRyI6IDAsCiAgICAgICAgIklORk8iOiAxLAogICAgICAgICJXQVJOSU5HIjogMiwKICAgICAgICAiRVJST1IiOiAzLAogICAgICAgICJOT05FIjogNAogICAgfTsKCiAgICB2YXIgbG9nTGV2ZWwgPSBMb2dMZXZlbEVudW0uREVCVUc7CiAgICB2YXIgbG9nID0ge307CgogICAgbG9nLmQgPSBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgaWYgKGxvZ0xldmVsIDw9IExvZ0xldmVsRW51bS5ERUJVRykgewogICAgICAgICAgICBjb25zb2xlLmxvZygiKEQtbXJhaWQuanMpICIgKyBtc2cpOwogICAgICAgIH0KICAgIH07CgogICAgbG9nLmkgPSBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgaWYgKGxvZ0xldmVsIDw9IExvZ0xldmVsRW51bS5JTkZPKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCIoSS1tcmFpZC5qcykgIiArIG1zZyk7CiAgICAgICAgfQogICAgfTsKCiAgICBsb2cudyA9IGZ1bmN0aW9uIChtc2cpIHsKICAgICAgICBpZiAobG9nTGV2ZWwgPD0gTG9nTGV2ZWxFbnVtLldBUk5JTkcpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIihXLW1yYWlkLmpzKSAiICsgbXNnKTsKICAgICAgICB9CiAgICB9OwoKICAgIGxvZy5lID0gZnVuY3Rpb24gKG1zZykgewogICAgICAgIGlmIChsb2dMZXZlbCA8PSBMb2dMZXZlbEVudW0uRVJST1IpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIihFLW1yYWlkLmpzKSAiICsgbXNnKTsKICAgICAgICB9CiAgICB9OwoKICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKICAgICAqIE1SQUlEIGRlY2xhcmF0aW9uCiAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgogICAgdmFyIG1yYWlkID0gd2luZG93Lm1yYWlkID0ge307CgogICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogICAgICogVlBBSUQgZGVjbGFyYXRpb24gKG9wdGlvbmFsKQogICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKICAgIHZhciB2cGFpZCA9IG51bGw7CgogICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogICAgICogY29uc3RhbnRzCiAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgogICAgdmFyIFZFUlNJT04gPSAiMy4wIjsKCiAgICB2YXIgU0RLID0gIkh5QmlkIjsKCiAgICB2YXIgU1RBVEVTID0gbXJhaWQuU1RBVEVTID0gewogICAgICAgICJMT0FESU5HIjogImxvYWRpbmciLAogICAgICAgICJERUZBVUxUIjogImRlZmF1bHQiLAogICAgICAgICJFWFBBTkRFRCI6ICJleHBhbmRlZCIsCiAgICAgICAgIlJFU0laRUQiOiAicmVzaXplZCIsCiAgICAgICAgIkhJRERFTiI6ICJoaWRkZW4iCiAgICB9OwoKICAgIHZhciBQTEFDRU1FTlRfVFlQRVMgPSBtcmFpZC5QTEFDRU1FTlRfVFlQRVMgPSB7CiAgICAgICAgIklOTElORSI6ICJpbmxpbmUiLAogICAgICAgICJJTlRFUlNUSVRJQUwiOiAiaW50ZXJzdGl0aWFsIgogICAgfTsKCiAgICB2YXIgUkVTSVpFX1BST1BFUlRJRVNfQ1VTVE9NX0NMT1NFX1BPU0lUSU9OID0gbXJhaWQuUkVTSVpFX1BST1BFUlRJRVNfQ1VTVE9NX0NMT1NFX1BPU0lUSU9OID0gewogICAgICAgICJUT1BfTEVGVCI6ICJ0b3AtbGVmdCIsCiAgICAgICAgIlRPUF9DRU5URVIiOiAidG9wLWNlbnRlciIsCiAgICAgICAgIlRPUF9SSUdIVCI6ICJ0b3AtcmlnaHQiLAogICAgICAgICJDRU5URVIiOiAiY2VudGVyIiwKICAgICAgICAiQk9UVE9NX0xFRlQiOiAiYm90dG9tLWxlZnQiLAogICAgICAgICJCT1RUT01fQ0VOVEVSIjogImJvdHRvbS1jZW50ZXIiLAogICAgICAgICJCT1RUT01fUklHSFQiOiAiYm90dG9tLXJpZ2h0IgogICAgfTsKCiAgICB2YXIgT1JJRU5UQVRJT05fUFJPUEVSVElFU19GT1JDRV9PUklFTlRBVElPTiA9IG1yYWlkLk9SSUVOVEFUSU9OX1BST1BFUlRJRVNfRk9SQ0VfT1JJRU5UQVRJT04gPSB7CiAgICAgICAgIlBPUlRSQUlUIjogInBvcnRyYWl0IiwKICAgICAgICAiTEFORFNDQVBFIjogImxhbmRzY2FwZSIsCiAgICAgICAgIk5PTkUiOiAibm9uZSIKICAgIH07CgogICAgdmFyIEVWRU5UUyA9IG1yYWlkLkVWRU5UUyA9IHsKICAgICAgICAiRVJST1IiOiAiZXJyb3IiLAogICAgICAgICJSRUFEWSI6ICJyZWFkeSIsCiAgICAgICAgIlNJWkVDSEFOR0UiOiAic2l6ZUNoYW5nZSIsCiAgICAgICAgIlNUQVRFQ0hBTkdFIjogInN0YXRlQ2hhbmdlIiwKICAgICAgICAiRVhQT1NVUkVDSEFOR0UiOiAiZXhwb3N1cmVDaGFuZ2UiLAogICAgICAgICJBVURJT1ZPTFVNRUNIQU5HRSI6ICJhdWRpb1ZvbHVtZUNoYW5nZSIsCiAgICAgICAgIlZJRVdBQkxFQ0hBTkdFIjogInZpZXdhYmxlQ2hhbmdlIgogICAgfTsKCiAgICB2YXIgU1VQUE9SVEVEX0ZFQVRVUkVTID0gbXJhaWQuU1VQUE9SVEVEX0ZFQVRVUkVTID0gewogICAgICAgICJTTVMiOiAic21zIiwKICAgICAgICAiVEVMIjogInRlbCIsCiAgICAgICAgIkNBTEVOREFSIjogImNhbGVuZGFyIiwKICAgICAgICAiU1RPUkVQSUNUVVJFIjogInN0b3JlUGljdHVyZSIsCiAgICAgICAgIklOTElORVZJREVPIjogImlubGluZVZpZGVvIiwKICAgICAgICAiVlBBSUQiOiAidnBhaWQiLAogICAgICAgICJMT0NBVElPTiI6ICJsb2NhdGlvbiIKICAgIH07CgogICAgdmFyIExPQ0FUSU9OX1NPVVJDRVMgPSBtcmFpZC5MT0NBVElPTl9TT1VSQ0VTID0gewogICAgICAgICJHUFMiOiAxLAogICAgICAgICJJUCI6IDIsCiAgICAgICAgIlVTRVJfUFJPVklERUQiOiAzCiAgICB9CgogICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogICAgICogc3RhdGUKICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCiAgICB2YXIgc3RhdGUgPSBTVEFURVMuTE9BRElORzsKICAgIHZhciBwbGFjZW1lbnRUeXBlID0gUExBQ0VNRU5UX1RZUEVTLklOTElORTsKICAgIHZhciBzdXBwb3J0ZWRGZWF0dXJlcyA9IHt9OwogICAgdmFyIGlzVmlld2FibGUgPSBmYWxzZTsKICAgIHZhciBpc0V4cGFuZFByb3BlcnRpZXNTZXQgPSBmYWxzZTsKICAgIHZhciBpc1Jlc2l6ZVJlYWR5ID0gZmFsc2U7CgogICAgdmFyIGV4cG9zdXJlID0gewogICAgICAgICJleHBvc2VkUGVyY2VudGFnZSI6IDAuMCwKICAgICAgICAidmlzaWJsZVJlY3RhbmdsZSI6IHsKICAgICAgICAgICAgIngiOiAwLAogICAgICAgICAgICAieSI6IDAsCiAgICAgICAgICAgICJ3aWR0aCI6IDAsCiAgICAgICAgICAgICJoZWlnaHQiOiAwCiAgICAgICAgfSwKICAgICAgICAib2NjbHVzaW9uUmVjdGFuZ2xlcyI6IG51bGwKICAgIH0KCiAgICB2YXIgdm9sdW1lUGVyY2VudGFnZSA9IDAuMDsKCgogICAgdmFyIGV4cGFuZFByb3BlcnRpZXMgPSB7CiAgICAgICAgIndpZHRoIjogMCwKICAgICAgICAiaGVpZ2h0IjogMCwKICAgICAgICAidXNlQ3VzdG9tQ2xvc2UiOiBmYWxzZSwKICAgICAgICAiaXNNb2RhbCI6IHRydWUKICAgIH07CgogICAgdmFyIG9yaWVudGF0aW9uUHJvcGVydGllcyA9IHsKICAgICAgICAiYWxsb3dPcmllbnRhdGlvbkNoYW5nZSI6IHRydWUsCiAgICAgICAgImZvcmNlT3JpZW50YXRpb24iOiBPUklFTlRBVElPTl9QUk9QRVJUSUVTX0ZPUkNFX09SSUVOVEFUSU9OLk5PTkUKICAgIH07CgogICAgdmFyIGN1cnJlbnRBcHBPcmllbnRhdGlvbiA9IHsKICAgICAgICAib3JpZW50YXRpb24iOiBPUklFTlRBVElPTl9QUk9QRVJUSUVTX0ZPUkNFX09SSUVOVEFUSU9OLlBPUlRSQUlULAogICAgICAgICJsb2NrZWQiOiBmYWxzZQogICAgfTsKCiAgICB2YXIgcmVzaXplUHJvcGVydGllcyA9IHsKICAgICAgICAid2lkdGgiOiAwLAogICAgICAgICJoZWlnaHQiOiAwLAogICAgICAgICJjdXN0b21DbG9zZVBvc2l0aW9uIjogUkVTSVpFX1BST1BFUlRJRVNfQ1VTVE9NX0NMT1NFX1BPU0lUSU9OLlRPUF9SSUdIVCwKICAgICAgICAib2Zmc2V0WCI6IDAsCiAgICAgICAgIm9mZnNldFkiOiAwLAogICAgICAgICJhbGxvd09mZnNjcmVlbiI6IHRydWUKICAgIH07CgogICAgdmFyIGN1cnJlbnRQb3NpdGlvbiA9IHsKICAgICAgICAieCI6IDAsCiAgICAgICAgInkiOiAwLAogICAgICAgICJ3aWR0aCI6IDAsCiAgICAgICAgImhlaWdodCI6IDAKICAgIH07CgogICAgdmFyIGRlZmF1bHRQb3NpdGlvbiA9IHsKICAgICAgICAieCI6IDAsCiAgICAgICAgInkiOiAwLAogICAgICAgICJ3aWR0aCI6IDAsCiAgICAgICAgImhlaWdodCI6IDAKICAgIH07CgogICAgdmFyIG1heFNpemUgPSB7CiAgICAgICAgIndpZHRoIjogMCwKICAgICAgICAiaGVpZ2h0IjogMAogICAgfTsKCiAgICB2YXIgc2NyZWVuU2l6ZSA9IHsKICAgICAgICAid2lkdGgiOiAwLAogICAgICAgICJoZWlnaHQiOiAwCiAgICB9OwoKICAgIHZhciBsb2NhdGlvbiA9IHsKICAgICAgICAibGF0IjogLTEsCiAgICAgICAgImxvbiI6IC0xLAogICAgICAgICJ0eXBlIjogTE9DQVRJT05fU09VUkNFUy5HUFMsCiAgICAgICAgImFjY3VyYWN5IjogLTEsCiAgICAgICAgImxhc3RmaXgiOiAtMSwKICAgICAgICAiaXBzZXJ2aWNlIjogIm5vbmUiCiAgICB9CgogICAgdmFyIGxpc3RlbmVycyA9IHt9OwogICAgd2luZG93Lmxpc3RlbmVycyA9IGxpc3RlbmVyczsKCiAgICB2YXIgbXJhaWRFbnYgPSB7CiAgICAgICAgInZlcnNpb24iOiBWRVJTSU9OLAogICAgICAgICJzZGsiOiBTREssCiAgICAgICAgInNka1ZlcnNpb24iOiBudWxsLAogICAgICAgICJhcHBJZCI6IG51bGwsCiAgICAgICAgImlmYSI6IG51bGwsCiAgICAgICAgImxpbWl0QWRUcmFja2luZyI6IGZhbHNlLAogICAgICAgICJjb3BwYSI6IGZhbHNlCiAgICB9OwoKICAgIHdpbmRvdy5NUkFJRF9FTlYgPSBtcmFpZEVudjsKCiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAgICAgKiAib2ZmaWNpYWwiIEFQSTogbWV0aG9kcyBjYWxsZWQgYnkgY3JlYXRpdmUKICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCiAgICBtcmFpZC5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50LCBsaXN0ZW5lcikgewogICAgICAgIGxvZy5pKCJtcmFpZC5hZGRFdmVudExpc3RlbmVyICIgKyBldmVudCArICI6ICIgKyBTdHJpbmcobGlzdGVuZXIpKTsKICAgICAgICBpZiAoIWV2ZW50IHx8ICFsaXN0ZW5lcikgewogICAgICAgICAgICBtcmFpZC5maXJlRXJyb3JFdmVudCgiQm90aCBldmVudCBhbmQgbGlzdGVuZXIgYXJlIHJlcXVpcmVkLiIsICJhZGRFdmVudExpc3RlbmVyIik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKCFjb250YWlucyhldmVudCwgRVZFTlRTKSkgewogICAgICAgICAgICBtcmFpZC5maXJlRXJyb3JFdmVudCgiVW5rbm93biBNUkFJRCBldmVudDogIiArIGV2ZW50LCAiYWRkRXZlbnRMaXN0ZW5lciIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHZhciBsaXN0ZW5lcnNGb3JFdmVudCA9IGxpc3RlbmVyc1tldmVudF0gPSBsaXN0ZW5lcnNbZXZlbnRdIHx8IFtdOwogICAgICAgIC8vIGNoZWNrIHRvIG1ha2Ugc3VyZSB0aGF0IHRoZSBsaXN0ZW5lciBpc24ndCBhbHJlYWR5IHJlZ2lzdGVyZWQKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3RlbmVyc0ZvckV2ZW50Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBzdHIxID0gU3RyaW5nKGxpc3RlbmVyKTsKICAgICAgICAgICAgdmFyIHN0cjIgPSBTdHJpbmcobGlzdGVuZXJzRm9yRXZlbnRbaV0pOwogICAgICAgICAgICBpZiAobGlzdGVuZXIgPT09IGxpc3RlbmVyc0ZvckV2ZW50W2ldIHx8IHN0cjEgPT09IHN0cjIpIHsKICAgICAgICAgICAgICAgIGxvZy5pKCJsaXN0ZW5lciAiICsgc3RyMSArICIgaXMgYWxyZWFkeSByZWdpc3RlcmVkIGZvciBldmVudCAiICsgZXZlbnQpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGxpc3RlbmVyc0ZvckV2ZW50LnB1c2gobGlzdGVuZXIpOwogICAgfTsKCiAgICBtcmFpZC5jcmVhdGVDYWxlbmRhckV2ZW50ID0gZnVuY3Rpb24gKHBhcmFtZXRlcnMpIHsKICAgICAgICBsb2cuaSgibXJhaWQuY3JlYXRlQ2FsZW5kYXJFdmVudCB3aXRoICIgKyBwYXJhbWV0ZXJzKTsKICAgICAgICBpZiAoc3VwcG9ydGVkRmVhdHVyZXNbbXJhaWQuU1VQUE9SVEVEX0ZFQVRVUkVTLkNBTEVOREFSXSkgewogICAgICAgICAgICBjYWxsTmF0aXZlKCJjcmVhdGVDYWxlbmRhckV2ZW50P2V2ZW50SlNPTj0iICsgSlNPTi5zdHJpbmdpZnkocGFyYW1ldGVycykpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGxvZy5lKCJjcmVhdGVDYWxlbmRhckV2ZW50IGlzIG5vdCBzdXBwb3J0ZWQiKTsKICAgICAgICB9CiAgICB9OwoKICAgIG1yYWlkLmNsb3NlID0gZnVuY3Rpb24gKCkgewogICAgICAgIGxvZy5pKCJtcmFpZC5jbG9zZSIpOwogICAgICAgIGlmIChzdGF0ZSA9PT0gU1RBVEVTLkxPQURJTkcKICAgICAgICAgICAgfHwgKHN0YXRlID09PSBTVEFURVMuREVGQVVMVCAmJiBwbGFjZW1lbnRUeXBlID09PSBQTEFDRU1FTlRfVFlQRVMuSU5MSU5FKQogICAgICAgICAgICB8fCBzdGF0ZSA9PT0gU1RBVEVTLkhJRERFTikgewogICAgICAgICAgICAvLyBkbyBub3RoaW5nCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgY2FsbE5hdGl2ZSgiY2xvc2UiKTsKICAgIH07CgogICAgbXJhaWQuZXhwYW5kID0gZnVuY3Rpb24gKHVybCkgewogICAgICAgIGlmICh1cmwgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBsb2cuaSgibXJhaWQuZXhwYW5kICgxLXBhcnQpIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbG9nLmkoIm1yYWlkLmV4cGFuZCAiICsgdXJsKTsKICAgICAgICB9CiAgICAgICAgLy8gVGhlIG9ubHkgdGltZSBpdCBpcyB2YWxpZCB0byBjYWxsIGV4cGFuZCBpcyB3aGVuIHRoZSBhZCBpcwogICAgICAgIC8vIGEgYmFubmVyIGN1cnJlbnRseSBpbiBlaXRoZXIgZGVmYXVsdCBvciByZXNpemVkIHN0YXRlLgogICAgICAgIGlmIChwbGFjZW1lbnRUeXBlICE9PSBQTEFDRU1FTlRfVFlQRVMuSU5MSU5FCiAgICAgICAgICAgIHx8IChzdGF0ZSAhPT0gU1RBVEVTLkRFRkFVTFQgJiYgc3RhdGUgIT09IFNUQVRFUy5SRVNJWkVEKSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmICh1cmwgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjYWxsTmF0aXZlKCJleHBhbmQiKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjYWxsTmF0aXZlKCJleHBhbmQ/dXJsPSIgKyBlbmNvZGVVUklDb21wb25lbnQodXJsKSk7CiAgICAgICAgfQogICAgfTsKCiAgICBtcmFpZC5nZXRDdXJyZW50UG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgbG9nLmkoIm1yYWlkLmdldEN1cnJlbnRQb3NpdGlvbiIpOwogICAgICAgIHJldHVybiBjdXJyZW50UG9zaXRpb247CiAgICB9OwoKICAgIG1yYWlkLmdldERlZmF1bHRQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBsb2cuaSgibXJhaWQuZ2V0RGVmYXVsdFBvc2l0aW9uIik7CiAgICAgICAgcmV0dXJuIGRlZmF1bHRQb3NpdGlvbjsKICAgIH07CgogICAgbXJhaWQuZ2V0RXhwYW5kUHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBsb2cuaSgibXJhaWQuZ2V0RXhwYW5kUHJvcGVydGllcyIpOwogICAgICAgIHJldHVybiBleHBhbmRQcm9wZXJ0aWVzOwogICAgfTsKCiAgICBtcmFpZC5nZXRNYXhTaXplID0gZnVuY3Rpb24gKCkgewogICAgICAgIGxvZy5pKCJtcmFpZC5nZXRNYXhTaXplIik7CiAgICAgICAgcmV0dXJuIG1heFNpemU7CiAgICB9OwoKICAgIG1yYWlkLmdldE9yaWVudGF0aW9uUHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBsb2cuaSgibXJhaWQuZ2V0T3JpZW50YXRpb25Qcm9wZXJ0aWVzIik7CiAgICAgICAgcmV0dXJuIG9yaWVudGF0aW9uUHJvcGVydGllczsKICAgIH07CgogICAgbXJhaWQuZ2V0Q3VycmVudEFwcE9yaWVudGF0aW9uID0gZnVuY3Rpb24gKCkgewogICAgICAgIGxvZy5pKCJtcmFpZC5nZXRDdXJyZW50QXBwT3JpZW50YXRpb24iKTsKICAgICAgICByZXR1cm4gY3VycmVudEFwcE9yaWVudGF0aW9uOwogICAgfTsKCiAgICBtcmFpZC5nZXRQbGFjZW1lbnRUeXBlID0gZnVuY3Rpb24gKCkgewogICAgICAgIGxvZy5pKCJtcmFpZC5nZXRQbGFjZW1lbnRUeXBlIik7CiAgICAgICAgcmV0dXJuIHBsYWNlbWVudFR5cGU7CiAgICB9OwoKICAgIG1yYWlkLmdldFJlc2l6ZVByb3BlcnRpZXMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgbG9nLmkoIm1yYWlkLmdldFJlc2l6ZVByb3BlcnRpZXMiKTsKICAgICAgICByZXR1cm4gcmVzaXplUHJvcGVydGllczsKICAgIH07CgogICAgbXJhaWQuZ2V0U2NyZWVuU2l6ZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBsb2cuaSgibXJhaWQuZ2V0U2NyZWVuU2l6ZSIpOwogICAgICAgIHJldHVybiBzY3JlZW5TaXplOwogICAgfTsKCiAgICBtcmFpZC5nZXRTdGF0ZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBsb2cuaSgibXJhaWQuZ2V0U3RhdGUiKTsKICAgICAgICByZXR1cm4gc3RhdGU7CiAgICB9OwoKICAgIG1yYWlkLmdldFZlcnNpb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgbG9nLmkoIm1yYWlkLmdldFZlcnNpb24iKTsKICAgICAgICByZXR1cm4gVkVSU0lPTjsKICAgIH07CgogICAgbXJhaWQuZ2V0TG9jYXRpb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgbG9nLmkoIm1yYWlkLmdldExvY2F0aW9uIik7CiAgICAgICAgcmV0dXJuIGxvY2F0aW9uOwogICAgfTsKCiAgICBtcmFpZC5pc1ZpZXdhYmxlID0gZnVuY3Rpb24gKCkgewogICAgICAgIGxvZy5pKCJtcmFpZC5pc1ZpZXdhYmxlIik7CiAgICAgICAgcmV0dXJuIGlzVmlld2FibGU7CiAgICB9OwoKICAgIG1yYWlkLm9wZW4gPSBmdW5jdGlvbiAodXJsKSB7CiAgICAgICAgbG9nLmkoIm1yYWlkLm9wZW4gIiArIHVybCk7CiAgICAgICAgY2FsbE5hdGl2ZSgib3Blbj91cmw9IiArIGVuY29kZVVSSUNvbXBvbmVudCh1cmwpKTsKICAgIH07CgogICAgbXJhaWQucGxheVZpZGVvID0gZnVuY3Rpb24gKHVybCkgewogICAgICAgIGxvZy5pKCJtcmFpZC5wbGF5VmlkZW8gIiArIHVybCk7CiAgICAgICAgY2FsbE5hdGl2ZSgicGxheVZpZGVvP3VybD0iICsgZW5jb2RlVVJJQ29tcG9uZW50KHVybCkpOwogICAgfTsKCiAgICBtcmFpZC5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50LCBsaXN0ZW5lcikgewogICAgICAgIGxvZy5pKCJtcmFpZC5yZW1vdmVFdmVudExpc3RlbmVyICIgKyBldmVudCArICIgOiAiICsgU3RyaW5nKGxpc3RlbmVyKSk7CiAgICAgICAgaWYgKCFldmVudCkgewogICAgICAgICAgICBtcmFpZC5maXJlRXJyb3JFdmVudCgiRXZlbnQgaXMgcmVxdWlyZWQuIiwgInJlbW92ZUV2ZW50TGlzdGVuZXIiKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAoIWNvbnRhaW5zKGV2ZW50LCBFVkVOVFMpKSB7CiAgICAgICAgICAgIG1yYWlkLmZpcmVFcnJvckV2ZW50KCJVbmtub3duIE1SQUlEIGV2ZW50OiAiICsgZXZlbnQsICJyZW1vdmVFdmVudExpc3RlbmVyIik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKGxpc3RlbmVycy5oYXNPd25Qcm9wZXJ0eShldmVudCkpIHsKICAgICAgICAgICAgaWYgKGxpc3RlbmVyKSB7CiAgICAgICAgICAgICAgICB2YXIgbGlzdGVuZXJzRm9yRXZlbnQgPSBsaXN0ZW5lcnNbZXZlbnRdOwogICAgICAgICAgICAgICAgLy8gdHJ5IHRvIGZpbmQgdGhlIGdpdmVuIGxpc3RlbmVyCiAgICAgICAgICAgICAgICB2YXIgbGVuID0gbGlzdGVuZXJzRm9yRXZlbnQubGVuZ3RoOwogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgICAgICAgICAgICAgICAgIHZhciByZWdpc3RlcmVkTGlzdGVuZXIgPSBsaXN0ZW5lcnNGb3JFdmVudFtpXTsKICAgICAgICAgICAgICAgICAgICB2YXIgc3RyMSA9IFN0cmluZyhsaXN0ZW5lcik7CiAgICAgICAgICAgICAgICAgICAgdmFyIHN0cjIgPSBTdHJpbmcocmVnaXN0ZXJlZExpc3RlbmVyKTsKICAgICAgICAgICAgICAgICAgICBpZiAobGlzdGVuZXIgPT09IHJlZ2lzdGVyZWRMaXN0ZW5lciB8fCBzdHIxID09PSBzdHIyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RlbmVyc0ZvckV2ZW50LnNwbGljZShpLCAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGkgPT09IGxlbikgewogICAgICAgICAgICAgICAgICAgIGxvZy5pKCJsaXN0ZW5lciAiICsgc3RyMSArICIgbm90IGZvdW5kIGZvciBldmVudCAiICsgZXZlbnQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGxpc3RlbmVyc0ZvckV2ZW50Lmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBsaXN0ZW5lcnNbZXZlbnRdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gbm8gbGlzdGVuZXIgdG8gcmVtb3ZlIHdhcyBwcm92aWRlZCwgc28gcmVtb3ZlIGFsbCBsaXN0ZW5lcnMKICAgICAgICAgICAgICAgIC8vIGZvciBnaXZlbiBldmVudAogICAgICAgICAgICAgICAgZGVsZXRlIGxpc3RlbmVyc1tldmVudF07CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsb2cuaSgibm8gbGlzdGVuZXJzIHJlZ2lzdGVyZWQgZm9yIGV2ZW50ICIgKyBldmVudCk7CiAgICAgICAgfQogICAgfTsKCiAgICBtcmFpZC5yZXNpemUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgbG9nLmkoIm1yYWlkLnJlc2l6ZSIpOwogICAgICAgIC8vIFRoZSBvbmx5IHRpbWUgaXQgaXMgdmFsaWQgdG8gY2FsbCByZXNpemUgaXMgd2hlbiB0aGUgYWQgaXMKICAgICAgICAvLyBhIGJhbm5lciBjdXJyZW50bHkgaW4gZWl0aGVyIGRlZmF1bHQgb3IgcmVzaXplZCBzdGF0ZS4KICAgICAgICAvLyBUcmlnZ2VyIGFuIGVycm9yIGlmIHRoZSBjdXJyZW50IHN0YXRlIGlzIGV4cGFuZGVkLgogICAgICAgIGlmIChwbGFjZW1lbnRUeXBlID09PSBQTEFDRU1FTlRfVFlQRVMuSU5URVJTVElUSUFMIHx8IHN0YXRlID09PSBTVEFURVMuTE9BRElORyB8fCBzdGF0ZSA9PT0gU1RBVEVTLkhJRERFTikgewogICAgICAgICAgICAvLyBkbyBub3RoaW5nCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKHN0YXRlID09PSBTVEFURVMuRVhQQU5ERUQpIHsKICAgICAgICAgICAgbXJhaWQuZmlyZUVycm9yRXZlbnQoIm1yYWlkLnJlc2l6ZSBjYWxsZWQgd2hlbiBhZCBpcyBpbiBleHBhbmRlZCBzdGF0ZSIsICJtcmFpZC5yZXNpemUiKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAoIWlzUmVzaXplUmVhZHkpIHsKICAgICAgICAgICAgbXJhaWQuZmlyZUVycm9yRXZlbnQoIm1yYWlkLnJlc2l6ZSBpcyBub3QgcmVhZHkgdG8gYmUgY2FsbGVkIiwgIm1yYWlkLnJlc2l6ZSIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNhbGxOYXRpdmUoInJlc2l6ZSIpOwogICAgfTsKCiAgICBtcmFpZC5zZXRFeHBhbmRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKHByb3BlcnRpZXMpIHsKICAgICAgICBsb2cuaSgibXJhaWQuc2V0RXhwYW5kUHJvcGVydGllcyIpOwoKICAgICAgICBpZiAoIXZhbGlkYXRlKHByb3BlcnRpZXMsICJzZXRFeHBhbmRQcm9wZXJ0aWVzIikpIHsKICAgICAgICAgICAgbG9nLmUoImZhaWxlZCB2YWxpZGF0aW9uIik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHZhciBvbGRVc2VDdXN0b21DbG9zZSA9IGV4cGFuZFByb3BlcnRpZXMudXNlQ3VzdG9tQ2xvc2U7CgogICAgICAgIC8vIGV4cGFuZFByb3BlcnRpZXMgY29udGFpbnMgMyByZWFkLXdyaXRlIHByb3BlcnRpZXM6IHdpZHRoLCBoZWlnaHQsIGFuZCB1c2VDdXN0b21DbG9zZTsKICAgICAgICAvLyB0aGUgaXNNb2RhbCBwcm9wZXJ0eSBpcyByZWFkLW9ubHkKICAgICAgICB2YXIgcndQcm9wcyA9IFsid2lkdGgiLCAiaGVpZ2h0IiwgInVzZUN1c3RvbUNsb3NlIl07CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByd1Byb3BzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBwcm9wbmFtZSA9IHJ3UHJvcHNbaV07CiAgICAgICAgICAgIGlmIChwcm9wZXJ0aWVzLmhhc093blByb3BlcnR5KHByb3BuYW1lKSkgewogICAgICAgICAgICAgICAgZXhwYW5kUHJvcGVydGllc1twcm9wbmFtZV0gPSBwcm9wZXJ0aWVzW3Byb3BuYW1lXTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gSW4gTVJBSUQgdjIuMCwgYWxsIGV4cGFuZGVkIGFkcyBieSBkZWZpbml0aW9uIGNvdmVyIHRoZSBlbnRpcmUgc2NyZWVuLAogICAgICAgIC8vIHNvIHRoZSBvbmx5IHByb3BlcnR5IHRoYXQgdGhlIG5hdGl2ZSBzaWRlIGhhcyB0byBrbm93IGFib3V0IGlzIHVzZUN1c3RvbUNsb3NlLgogICAgICAgIC8vIChUaGF0IGlzLCB0aGUgd2lkdGggYW5kIGhlaWdodCBwcm9wZXJ0aWVzIGFyZSBub3QgbmVlZGVkIGJ5IHRoZSBuYXRpdmUgY29kZS4pCiAgICAgICAgaWYgKGV4cGFuZFByb3BlcnRpZXMudXNlQ3VzdG9tQ2xvc2UgIT09IG9sZFVzZUN1c3RvbUNsb3NlKSB7CiAgICAgICAgICAgIGNhbGxOYXRpdmUoInVzZUN1c3RvbUNsb3NlP3VzZUN1c3RvbUNsb3NlPSIgKyBleHBhbmRQcm9wZXJ0aWVzLnVzZUN1c3RvbUNsb3NlKTsKICAgICAgICB9CgogICAgICAgIGlzRXhwYW5kUHJvcGVydGllc1NldCA9IHRydWU7CiAgICB9OwoKICAgIG1yYWlkLnNldE9yaWVudGF0aW9uUHJvcGVydGllcyA9IGZ1bmN0aW9uIChwcm9wZXJ0aWVzKSB7CiAgICAgICAgbG9nLmkoIm1yYWlkLnNldE9yaWVudGF0aW9uUHJvcGVydGllcyIpOwoKICAgICAgICBpZiAoIXZhbGlkYXRlKHByb3BlcnRpZXMsICJzZXRPcmllbnRhdGlvblByb3BlcnRpZXMiKSkgewogICAgICAgICAgICBsb2cuZSgiZmFpbGVkIHZhbGlkYXRpb24iKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIG5ld09yaWVudGF0aW9uUHJvcGVydGllcyA9IHt9OwogICAgICAgIG5ld09yaWVudGF0aW9uUHJvcGVydGllcy5hbGxvd09yaWVudGF0aW9uQ2hhbmdlID0gb3JpZW50YXRpb25Qcm9wZXJ0aWVzLmFsbG93T3JpZW50YXRpb25DaGFuZ2UsCiAgICAgICAgICAgIG5ld09yaWVudGF0aW9uUHJvcGVydGllcy5mb3JjZU9yaWVudGF0aW9uID0gb3JpZW50YXRpb25Qcm9wZXJ0aWVzLmZvcmNlT3JpZW50YXRpb247CgogICAgICAgIC8vIG9yaWVudGF0aW9uUHJvcGVydGllcyBjb250YWlucyAyIHJlYWQtd3JpdGUgcHJvcGVydGllczoKICAgICAgICAvLyBhbGxvd09yaWVudGF0aW9uQ2hhbmdlIGFuZCBmb3JjZU9yaWVudGF0aW9uCiAgICAgICAgdmFyIHJ3UHJvcHMgPSBbImFsbG93T3JpZW50YXRpb25DaGFuZ2UiLCAiZm9yY2VPcmllbnRhdGlvbiJdOwogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcndQcm9wcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB2YXIgcHJvcG5hbWUgPSByd1Byb3BzW2ldOwogICAgICAgICAgICBpZiAocHJvcGVydGllcy5oYXNPd25Qcm9wZXJ0eShwcm9wbmFtZSkpIHsKICAgICAgICAgICAgICAgIG5ld09yaWVudGF0aW9uUHJvcGVydGllc1twcm9wbmFtZV0gPSBwcm9wZXJ0aWVzW3Byb3BuYW1lXTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gU2V0dGluZyBhbGxvd09yaWVudGF0aW9uQ2hhbmdlIHRvIHRydWUgd2hpbGUgc2V0dGluZyBmb3JjZU9yaWVudGF0aW9uCiAgICAgICAgLy8gdG8gZWl0aGVyIHBvcnRyYWl0IG9yIGxhbmRzY2FwZQogICAgICAgIC8vIGlzIGNvbnNpZGVyZWQgYW4gZXJyb3IgY29uZGl0aW9uLgogICAgICAgIGlmIChuZXdPcmllbnRhdGlvblByb3BlcnRpZXMuYWxsb3dPcmllbnRhdGlvbkNoYW5nZQogICAgICAgICAgICAmJiBuZXdPcmllbnRhdGlvblByb3BlcnRpZXMuZm9yY2VPcmllbnRhdGlvbiAhPT0gbXJhaWQuT1JJRU5UQVRJT05fUFJPUEVSVElFU19GT1JDRV9PUklFTlRBVElPTi5OT05FKSB7CiAgICAgICAgICAgIG1yYWlkLmZpcmVFcnJvckV2ZW50KAogICAgICAgICAgICAgICAgImFsbG93T3JpZW50YXRpb25DaGFuZ2UgaXMgdHJ1ZSBidXQgZm9yY2VPcmllbnRhdGlvbiBpcyAiCiAgICAgICAgICAgICAgICArIG5ld09yaWVudGF0aW9uUHJvcGVydGllcy5mb3JjZU9yaWVudGF0aW9uLAogICAgICAgICAgICAgICAgInNldE9yaWVudGF0aW9uUHJvcGVydGllcyIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBvcmllbnRhdGlvblByb3BlcnRpZXMuYWxsb3dPcmllbnRhdGlvbkNoYW5nZSA9IG5ld09yaWVudGF0aW9uUHJvcGVydGllcy5hbGxvd09yaWVudGF0aW9uQ2hhbmdlOwogICAgICAgIG9yaWVudGF0aW9uUHJvcGVydGllcy5mb3JjZU9yaWVudGF0aW9uID0gbmV3T3JpZW50YXRpb25Qcm9wZXJ0aWVzLmZvcmNlT3JpZW50YXRpb247CgogICAgICAgIHZhciBwYXJhbXMgPSAiYWxsb3dPcmllbnRhdGlvbkNoYW5nZT0iCiAgICAgICAgICAgICsgb3JpZW50YXRpb25Qcm9wZXJ0aWVzLmFsbG93T3JpZW50YXRpb25DaGFuZ2UKICAgICAgICAgICAgKyAiJmZvcmNlT3JpZW50YXRpb249IiArIG9yaWVudGF0aW9uUHJvcGVydGllcy5mb3JjZU9yaWVudGF0aW9uOwoKICAgICAgICBjYWxsTmF0aXZlKCJzZXRPcmllbnRhdGlvblByb3BlcnRpZXM/IiArIHBhcmFtcyk7CiAgICB9OwoKICAgIG1yYWlkLnNldFJlc2l6ZVByb3BlcnRpZXMgPSBmdW5jdGlvbiAocHJvcGVydGllcykgewogICAgICAgIGxvZy5pKCJtcmFpZC5zZXRSZXNpemVQcm9wZXJ0aWVzIik7CgogICAgICAgIGlzUmVzaXplUmVhZHkgPSBmYWxzZTsKCiAgICAgICAgLy8gcmVzaXplUHJvcGVydGllcyBjb250YWlucyA2IHJlYWQtd3JpdGUgcHJvcGVydGllczoKICAgICAgICAvLyB3aWR0aCwgaGVpZ2h0LCBvZmZzZXRYLCBvZmZzZXRZLCBjdXN0b21DbG9zZVBvc2l0aW9uLCBhbGxvd09mZnNjcmVlbgoKICAgICAgICAvLyBUaGUgcHJvcGVydGllcyBvYmplY3QgcGFzc2VkIGludG8gdGhpcyBmdW5jdGlvbiBtdXN0IGNvbnRhaW4gd2lkdGgsIGhlaWdodCwgb2Zmc2V0WCwgb2Zmc2V0WS4KICAgICAgICAvLyBUaGUgcmVtYWluaW5nIHR3byBwcm9wZXJ0aWVzIGFyZSBvcHRpb25hbC4KICAgICAgICB2YXIgcmVxdWlyZWRQcm9wcyA9IFsid2lkdGgiLCAiaGVpZ2h0IiwgIm9mZnNldFgiLCAib2Zmc2V0WSJdOwogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVxdWlyZWRQcm9wcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB2YXIgcHJvcG5hbWUgPSByZXF1aXJlZFByb3BzW2ldOwogICAgICAgICAgICBpZiAoIXByb3BlcnRpZXMuaGFzT3duUHJvcGVydHkocHJvcG5hbWUpKSB7CiAgICAgICAgICAgICAgICBtcmFpZC5maXJlRXJyb3JFdmVudCgKICAgICAgICAgICAgICAgICAgICAicmVxdWlyZWQgcHJvcGVydHkgIiArIHByb3BuYW1lICsgIiBpcyBtaXNzaW5nIiwKICAgICAgICAgICAgICAgICAgICAibXJhaWQuc2V0UmVzaXplUHJvcGVydGllcyIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoIXZhbGlkYXRlKHByb3BlcnRpZXMsICJzZXRSZXNpemVQcm9wZXJ0aWVzIikpIHsKICAgICAgICAgICAgbXJhaWQuZmlyZUVycm9yRXZlbnQoImZhaWxlZCB2YWxpZGF0aW9uIiwgIm1yYWlkLnNldFJlc2l6ZVByb3BlcnRpZXMiKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIGFkanVzdG1lbnRzID0geyJ4IjogMCwgInkiOiAwfTsKCiAgICAgICAgdmFyIGFsbG93T2Zmc2NyZWVuID0gcHJvcGVydGllcy5oYXNPd25Qcm9wZXJ0eSgiYWxsb3dPZmZzY3JlZW4iKSA/IHByb3BlcnRpZXMuYWxsb3dPZmZzY3JlZW4gOiByZXNpemVQcm9wZXJ0aWVzLmFsbG93T2Zmc2NyZWVuOwogICAgICAgIGlmICghYWxsb3dPZmZzY3JlZW4pIHsKICAgICAgICAgICAgaWYgKHByb3BlcnRpZXMud2lkdGggPiBtYXhTaXplLndpZHRoIHx8IHByb3BlcnRpZXMuaGVpZ2h0ID4gbWF4U2l6ZS5oZWlnaHQpIHsKICAgICAgICAgICAgICAgIG1yYWlkLmZpcmVFcnJvckV2ZW50KCJyZXNpemUgd2lkdGggb3IgaGVpZ2h0IGlzIGdyZWF0ZXIgdGhhbiB0aGUgbWF4U2l6ZSB3aWR0aCBvciBoZWlnaHQiLCAibXJhaWQuc2V0UmVzaXplUHJvcGVydGllcyIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGFkanVzdG1lbnRzID0gZml0UmVzaXplVmlld09uU2NyZWVuKHByb3BlcnRpZXMpOwogICAgICAgIH0gZWxzZSBpZiAoIWlzQ2xvc2VSZWdpb25PblNjcmVlbihwcm9wZXJ0aWVzKSkgewogICAgICAgICAgICBtcmFpZC5maXJlRXJyb3JFdmVudCgiY2xvc2UgZXZlbnQgcmVnaW9uIHdpbGwgbm90IGFwcGVhciBlbnRpcmVseSBvbnNjcmVlbiIsICJtcmFpZC5zZXRSZXNpemVQcm9wZXJ0aWVzIik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHZhciByd1Byb3BzID0gWyJ3aWR0aCIsICJoZWlnaHQiLCAib2Zmc2V0WCIsICJvZmZzZXRZIiwgImN1c3RvbUNsb3NlUG9zaXRpb24iLCAiYWxsb3dPZmZzY3JlZW4iXTsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJ3UHJvcHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdmFyIHByb3BuYW1lID0gcndQcm9wc1tpXTsKICAgICAgICAgICAgaWYgKHByb3BlcnRpZXMuaGFzT3duUHJvcGVydHkocHJvcG5hbWUpKSB7CiAgICAgICAgICAgICAgICByZXNpemVQcm9wZXJ0aWVzW3Byb3BuYW1lXSA9IHByb3BlcnRpZXNbcHJvcG5hbWVdOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB2YXIgcGFyYW1zID0KICAgICAgICAgICAgIndpZHRoPSIgKyByZXNpemVQcm9wZXJ0aWVzLndpZHRoICsKICAgICAgICAgICAgIiZoZWlnaHQ9IiArIHJlc2l6ZVByb3BlcnRpZXMuaGVpZ2h0ICsKICAgICAgICAgICAgIiZvZmZzZXRYPSIgKyAocmVzaXplUHJvcGVydGllcy5vZmZzZXRYICsgYWRqdXN0bWVudHMueCkgKwogICAgICAgICAgICAiJm9mZnNldFk9IiArIChyZXNpemVQcm9wZXJ0aWVzLm9mZnNldFkgKyBhZGp1c3RtZW50cy55KSArCiAgICAgICAgICAgICImY3VzdG9tQ2xvc2VQb3NpdGlvbj0iICsgcmVzaXplUHJvcGVydGllcy5jdXN0b21DbG9zZVBvc2l0aW9uICsKICAgICAgICAgICAgIiZhbGxvd09mZnNjcmVlbj0iICsgcmVzaXplUHJvcGVydGllcy5hbGxvd09mZnNjcmVlbjsKCiAgICAgICAgY2FsbE5hdGl2ZSgic2V0UmVzaXplUHJvcGVydGllcz8iICsgcGFyYW1zKTsKCiAgICAgICAgaXNSZXNpemVSZWFkeSA9IHRydWU7CiAgICB9OwoKICAgIG1yYWlkLnN0b3JlUGljdHVyZSA9IGZ1bmN0aW9uICh1cmwpIHsKICAgICAgICBsb2cuaSgibXJhaWQuc3RvcmVQaWN0dXJlICIgKyB1cmwpOwogICAgICAgIGlmIChzdXBwb3J0ZWRGZWF0dXJlc1ttcmFpZC5TVVBQT1JURURfRkVBVFVSRVMuU1RPUkVQSUNUVVJFXSkgewogICAgICAgICAgICBjYWxsTmF0aXZlKCJzdG9yZVBpY3R1cmU/dXJsPSIgKyBlbmNvZGVVUklDb21wb25lbnQodXJsKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbG9nLmUoInN0b3JlUGljdHVyZSBpcyBub3Qgc3VwcG9ydGVkIik7CiAgICAgICAgfQogICAgfTsKCiAgICBtcmFpZC5zdXBwb3J0cyA9IGZ1bmN0aW9uIChmZWF0dXJlKSB7CiAgICAgICAgbG9nLmkoIm1yYWlkLnN1cHBvcnRzICIgKyBmZWF0dXJlICsgIiAiICsgc3VwcG9ydGVkRmVhdHVyZXNbZmVhdHVyZV0pOwogICAgICAgIHZhciByZXR2YWwgPSBzdXBwb3J0ZWRGZWF0dXJlc1tmZWF0dXJlXTsKICAgICAgICBpZiAodHlwZW9mIHJldHZhbCA9PT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgICAgcmV0dmFsID0gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXR2YWw7CiAgICB9OwoKCiAgICBtcmFpZC51c2VDdXN0b21DbG9zZSA9IGZ1bmN0aW9uIChpc0N1c3RvbUNsb3NlKSB7CiAgICAgICAgbG9nLmkoIm1yYWlkLnVzZUN1c3RvbUNsb3NlICIgKyBpc0N1c3RvbUNsb3NlKTsKICAgICAgICBpZiAoZXhwYW5kUHJvcGVydGllcy51c2VDdXN0b21DbG9zZSAhPT0gaXNDdXN0b21DbG9zZSkgewogICAgICAgICAgICBleHBhbmRQcm9wZXJ0aWVzLnVzZUN1c3RvbUNsb3NlID0gaXNDdXN0b21DbG9zZTsKICAgICAgICAgICAgY2FsbE5hdGl2ZSgidXNlQ3VzdG9tQ2xvc2U/dXNlQ3VzdG9tQ2xvc2U9IgogICAgICAgICAgICAgICAgKyBleHBhbmRQcm9wZXJ0aWVzLnVzZUN1c3RvbUNsb3NlKTsKICAgICAgICB9CiAgICB9OwoKICAgIG1yYWlkLnVubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgIH07CgogICAgbXJhaWQuaW5pdFZwYWlkID0gZnVuY3Rpb24gKHZwYWlkT2JqZWN0KSB7CiAgICAgICAgdnBhaWQgPSB2cGFpZE9iamVjdDsKICAgIH07CgogICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogICAgICogaGVscGVyIG1ldGhvZHMgY2FsbGVkIGJ5IFNESwogICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKICAgIC8vIHNldHRlcnMgdG8gY2hhbmdlIHN0YXRlCiAgICBtcmFpZC5zZXRDdXJyZW50UG9zaXRpb24gPSBmdW5jdGlvbiAoeCwgeSwgd2lkdGgsIGhlaWdodCkgewogICAgICAgIGxvZy5pKCJtcmFpZC5zZXRDdXJyZW50UG9zaXRpb24gIiArIHggKyAiLCIgKyB5ICsgIiwiICsgd2lkdGggKyAiLCIgKyBoZWlnaHQpOwoKICAgICAgICB2YXIgcHJldmlvdXNTaXplID0ge307CiAgICAgICAgcHJldmlvdXNTaXplLndpZHRoID0gY3VycmVudFBvc2l0aW9uLndpZHRoOwogICAgICAgIHByZXZpb3VzU2l6ZS5oZWlnaHQgPSBjdXJyZW50UG9zaXRpb24uaGVpZ2h0OwogICAgICAgIGxvZy5pKCJwcmV2aW91c1NpemUgIiArIHByZXZpb3VzU2l6ZS53aWR0aCArICIsIiArIHByZXZpb3VzU2l6ZS5oZWlnaHQpOwoKICAgICAgICBjdXJyZW50UG9zaXRpb24ueCA9IHg7CiAgICAgICAgY3VycmVudFBvc2l0aW9uLnkgPSB5OwogICAgICAgIGN1cnJlbnRQb3NpdGlvbi53aWR0aCA9IHdpZHRoOwogICAgICAgIGN1cnJlbnRQb3NpdGlvbi5oZWlnaHQgPSBoZWlnaHQ7CgogICAgICAgIGlmICh3aWR0aCAhPT0gcHJldmlvdXNTaXplLndpZHRoIHx8IGhlaWdodCAhPT0gcHJldmlvdXNTaXplLmhlaWdodCkgewogICAgICAgICAgICBtcmFpZC5maXJlU2l6ZUNoYW5nZUV2ZW50KHdpZHRoLCBoZWlnaHQpOwogICAgICAgIH0KICAgIH07CgogICAgbXJhaWQuc2V0RGVmYXVsdFBvc2l0aW9uID0gZnVuY3Rpb24gKHgsIHksIHdpZHRoLCBoZWlnaHQpIHsKICAgICAgICBsb2cuaSgibXJhaWQuc2V0RGVmYXVsdFBvc2l0aW9uICIgKyB4ICsgIiwiICsgeSArICIsIiArIHdpZHRoICsgIiwiICsgaGVpZ2h0KTsKICAgICAgICBkZWZhdWx0UG9zaXRpb24ueCA9IHg7CiAgICAgICAgZGVmYXVsdFBvc2l0aW9uLnkgPSB5OwogICAgICAgIGRlZmF1bHRQb3NpdGlvbi53aWR0aCA9IHdpZHRoOwogICAgICAgIGRlZmF1bHRQb3NpdGlvbi5oZWlnaHQgPSBoZWlnaHQ7CiAgICB9OwoKICAgIG1yYWlkLnNldEV4cGFuZFNpemUgPSBmdW5jdGlvbiAod2lkdGgsIGhlaWdodCkgewogICAgICAgIGxvZy5pKCJtcmFpZC5zZXRFeHBhbmRTaXplICIgKyB3aWR0aCArICJ4IiArIGhlaWdodCk7CiAgICAgICAgZXhwYW5kUHJvcGVydGllcy53aWR0aCA9IHdpZHRoOwogICAgICAgIGV4cGFuZFByb3BlcnRpZXMuaGVpZ2h0ID0gaGVpZ2h0OwogICAgfTsKCiAgICBtcmFpZC5zZXRNYXhTaXplID0gZnVuY3Rpb24gKHdpZHRoLCBoZWlnaHQpIHsKICAgICAgICBsb2cuaSgibXJhaWQuc2V0TWF4U2l6ZSAiICsgd2lkdGggKyAieCIgKyBoZWlnaHQpOwogICAgICAgIG1heFNpemUud2lkdGggPSB3aWR0aDsKICAgICAgICBtYXhTaXplLmhlaWdodCA9IGhlaWdodDsKICAgIH07CgogICAgbXJhaWQuc2V0UGxhY2VtZW50VHlwZSA9IGZ1bmN0aW9uIChwdCkgewogICAgICAgIGxvZy5pKCJtcmFpZC5zZXRQbGFjZW1lbnRUeXBlICIgKyBwdCk7CiAgICAgICAgcGxhY2VtZW50VHlwZSA9IHB0OwogICAgfTsKCiAgICBtcmFpZC5zZXRTY3JlZW5TaXplID0gZnVuY3Rpb24gKHdpZHRoLCBoZWlnaHQpIHsKICAgICAgICBsb2cuaSgibXJhaWQuc2V0U2NyZWVuU2l6ZSAiICsgd2lkdGggKyAieCIgKyBoZWlnaHQpOwogICAgICAgIHNjcmVlblNpemUud2lkdGggPSB3aWR0aDsKICAgICAgICBzY3JlZW5TaXplLmhlaWdodCA9IGhlaWdodDsKICAgICAgICB1cGRhdGVDcmVhdGl2ZVNpemUod2lkdGgsIGhlaWdodCk7CiAgICAgICAgaWYgKCFpc0V4cGFuZFByb3BlcnRpZXNTZXQpIHsKICAgICAgICAgICAgZXhwYW5kUHJvcGVydGllcy53aWR0aCA9IHdpZHRoOwogICAgICAgICAgICBleHBhbmRQcm9wZXJ0aWVzLmhlaWdodCA9IGhlaWdodDsKICAgICAgICB9CiAgICB9OwoKICAgIG1yYWlkLnNldFN1cHBvcnRzID0gZnVuY3Rpb24gKGZlYXR1cmUsIHN1cHBvcnRlZCkgewogICAgICAgIGxvZy5pKCJtcmFpZC5zZXRTdXBwb3J0cyAiICsgZmVhdHVyZSArICIgIiArIHN1cHBvcnRlZCk7CiAgICAgICAgc3VwcG9ydGVkRmVhdHVyZXNbZmVhdHVyZV0gPSBzdXBwb3J0ZWQ7CiAgICB9OwoKICAgIG1yYWlkLnNldFNka1ZlcnNpb24gPSBmdW5jdGlvbiAoc2RrVmVyc2lvbikgewogICAgICAgIGxvZy5pKCJtcmFpZC5zZXRTZGtWZXJzaW9uICIgKyBzZGtWZXJzaW9uKTsKICAgICAgICBpZiAoc2RrVmVyc2lvbiAmJiBzZGtWZXJzaW9uICE9PSAiIikgewogICAgICAgICAgICBtcmFpZEVudi5zZGtWZXJzaW9uID0gc2RrVmVyc2lvbjsKICAgICAgICB9CiAgICB9OwoKICAgIG1yYWlkLnNldEFwcElkID0gZnVuY3Rpb24gKGJ1bmRsZU5hbWUpIHsKICAgICAgICBsb2cuaSgibXJhaWQuc2V0QXBwSWQgIiArIGJ1bmRsZU5hbWUpOwogICAgICAgIGlmIChidW5kbGVOYW1lICYmIGJ1bmRsZU5hbWUgIT09ICIiKSB7CiAgICAgICAgICAgIG1yYWlkRW52LmFwcElkID0gYnVuZGxlTmFtZTsKICAgICAgICB9CiAgICB9OwoKICAgIG1yYWlkLnNldElmYSA9IGZ1bmN0aW9uIChpZmEpIHsKICAgICAgICBsb2cuaSgibXJhaWQuc2V0SWZhICIgKyBpZmEpOwogICAgICAgIGlmIChpZmEgJiYgaWZhICE9PSAiIikgewogICAgICAgICAgICBtcmFpZEVudi5zZGtWZXJzaW9uID0gaWZhOwogICAgICAgIH0KICAgIH07CgogICAgbXJhaWQuc2V0TGltaXRBZFRyYWNraW5nID0gZnVuY3Rpb24gKGxpbWl0QWRUcmFja2luZykgewogICAgICAgIGxvZy5pKCJtcmFpZC5zZXRMaW1pdEFkVHJhY2tpbmcgIiArIGxpbWl0QWRUcmFja2luZyk7CiAgICAgICAgbXJhaWRFbnYubGltaXRBZFRyYWNraW5nID0gbGltaXRBZFRyYWNraW5nOwogICAgfTsKCiAgICBtcmFpZC5zZXRDb3BwYSA9IGZ1bmN0aW9uIChjb3BwYSkgewogICAgICAgIGxvZy5pKCJtcmFpZC5zZXRDb3BwYSAiICsgY29wcGEpOwogICAgICAgIG1yYWlkRW52LmNvcHBhID0gY29wcGE7CiAgICB9OwoKICAgIG1yYWlkLnNldEN1cnJlbnRBcHBPcmllbnRhdGlvbiA9IGZ1bmN0aW9uIChuZXdBcHBPcmllbnRhdGlvbikgewogICAgICAgIGxvZy5pKCJtcmFpZC5zZXRDdXJyZW50QXBwT3JpZW50YXRpb24gIiArIG5ld0FwcE9yaWVudGF0aW9uKTsKICAgICAgICBpZiAobmV3QXBwT3JpZW50YXRpb24pIHsKICAgICAgICAgICAgY3VycmVudEFwcE9yaWVudGF0aW9uID0gbmV3QXBwT3JpZW50YXRpb247CiAgICAgICAgfQogICAgfTsKCiAgICBtcmFpZC5zZXRMb2NhdGlvbiA9IGZ1bmN0aW9uIChuZXdMb2NhdGlvbikgewogICAgICAgIGxvZy5pKCJtcmFpZC5zZXRMb2NhdGlvbiAiICsgbmV3TG9jYXRpb24pOwogICAgICAgIGlmIChuZXdMb2NhdGlvbikgewogICAgICAgICAgICBsb2NhdGlvbiA9IG5ld0xvY2F0aW9uOwogICAgICAgIH0KICAgIH07CgogICAgLy8gbWV0aG9kcyB0byBmaXJlIGV2ZW50cwoKICAgIG1yYWlkLmZpcmVFcnJvckV2ZW50ID0gZnVuY3Rpb24gKG1lc3NhZ2UsIGFjdGlvbikgewogICAgICAgIGxvZy5pKCJtcmFpZC5maXJlRXJyb3JFdmVudCAiICsgbWVzc2FnZSArICIgIiArIGFjdGlvbik7CiAgICAgICAgZmlyZUV2ZW50KG1yYWlkLkVWRU5UUy5FUlJPUiwgbWVzc2FnZSwgYWN0aW9uKTsKICAgIH07CgogICAgbXJhaWQuZmlyZVJlYWR5RXZlbnQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgbG9nLmkoIm1yYWlkLmZpcmVSZWFkeUV2ZW50Iik7CiAgICAgICAgZmlyZUV2ZW50KG1yYWlkLkVWRU5UUy5SRUFEWSk7CiAgICB9OwoKICAgIG1yYWlkLmZpcmVTaXplQ2hhbmdlRXZlbnQgPSBmdW5jdGlvbiAod2lkdGgsIGhlaWdodCkgewogICAgICAgIGxvZy5pKCJtcmFpZC5maXJlU2l6ZUNoYW5nZUV2ZW50ICIgKyB3aWR0aCArICJ4IiArIGhlaWdodCk7CiAgICAgICAgaWYgKHN0YXRlICE9PSBtcmFpZC5TVEFURVMuTE9BRElORykgewogICAgICAgICAgICBmaXJlRXZlbnQobXJhaWQuRVZFTlRTLlNJWkVDSEFOR0UsIHdpZHRoLCBoZWlnaHQpOwogICAgICAgIH0KICAgIH07CgogICAgbXJhaWQuZmlyZVN0YXRlQ2hhbmdlRXZlbnQgPSBmdW5jdGlvbiAobmV3U3RhdGUpIHsKICAgICAgICBsb2cuaSgibXJhaWQuZmlyZVN0YXRlQ2hhbmdlRXZlbnQgIiArIG5ld1N0YXRlKTsKICAgICAgICBpZiAoc3RhdGUgIT09IG5ld1N0YXRlKSB7CiAgICAgICAgICAgIHN0YXRlID0gbmV3U3RhdGU7CiAgICAgICAgICAgIGZpcmVFdmVudChtcmFpZC5FVkVOVFMuU1RBVEVDSEFOR0UsIHN0YXRlKTsKICAgICAgICB9CiAgICB9OwoKICAgIG1yYWlkLmZpcmVFeHBvc3VyZUNoYW5nZUV2ZW50ID0gZnVuY3Rpb24gKGV4cG9zZWRQZXJjZW50YWdlLCB2aXNpYmxlUmVjdGFuZ2xlLCBvY2NsdXNpb25SZWN0YW5nbGVzKSB7CiAgICAgICAgbG9nLmkoIm1yYWlkLmZpcmVFeHBvc3VyZUNoYW5nZUV2ZW50ICIgKyBleHBvc2VkUGVyY2VudGFnZSArICIgIiArIHZpc2libGVSZWN0YW5nbGUgKyAiICIgKyBvY2NsdXNpb25SZWN0YW5nbGVzKTsKICAgICAgICBpZiAoc3RhdGUgIT09IG1yYWlkLlNUQVRFUy5MT0FESU5HKSB7CiAgICAgICAgICAgIGV4cG9zdXJlLmV4cG9zZWRQZXJjZW50YWdlID0gZXhwb3NlZFBlcmNlbnRhZ2U7CiAgICAgICAgICAgIGV4cG9zdXJlLnZpc2libGVSZWN0YW5nbGUgPSB2aXNpYmxlUmVjdGFuZ2xlOwogICAgICAgICAgICBpZiAob2NjbHVzaW9uUmVjdGFuZ2xlcykgewogICAgICAgICAgICAgICAgaWYgKGV4cG9zdXJlLm9jY2x1c2lvblJlY3RhbmdsZXMpIHsKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9jY2x1c2lvblJlY3RhbmdsZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3N1cmUub2NjbHVzaW9uUmVjdGFuZ2xlcy5wdXNoKG9jY2x1c2lvblJlY3RhbmdsZXNbaV0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgZXhwb3N1cmUub2NjbHVzaW9uUmVjdGFuZ2xlcyA9IG9jY2x1c2lvblJlY3RhbmdsZXMKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGV4cG9zdXJlLm9jY2x1c2lvblJlY3RhbmdsZXMgPSBudWxsCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZpcmVFdmVudChtcmFpZC5FVkVOVFMuRVhQT1NVUkVDSEFOR0UsIGV4cG9zZWRQZXJjZW50YWdlLCB2aXNpYmxlUmVjdGFuZ2xlLCBvY2NsdXNpb25SZWN0YW5nbGVzKTsKICAgICAgICAgICAgaWYgKGV4cG9zZWRQZXJjZW50YWdlID4gMC4wKSB7CiAgICAgICAgICAgICAgICBpc1ZpZXdhYmxlID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGZpcmVFdmVudChtcmFpZC5FVkVOVFMuVklFV0FCTEVDSEFOR0UsIGlzVmlld2FibGUpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaXNWaWV3YWJsZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgZmlyZUV2ZW50KG1yYWlkLkVWRU5UUy5WSUVXQUJMRUNIQU5HRSwgaXNWaWV3YWJsZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgfTsKCiAgICBtcmFpZC5maXJlQXVkaW9Wb2x1bWVDaGFuZ2VFdmVudCA9IGZ1bmN0aW9uIChuZXdWb2x1bWVQZXJjZW50YWdlKSB7CiAgICAgICAgbG9nLmkoIm1yYWlkLmZpcmVBdWRpb1ZvbHVtZUNoYW5nZUV2ZW50ICIgKyBuZXdWb2x1bWVQZXJjZW50YWdlKTsKICAgICAgICBpZiAodm9sdW1lUGVyY2VudGFnZSAhPT0gbmV3Vm9sdW1lUGVyY2VudGFnZSkgewogICAgICAgICAgICB2b2x1bWVQZXJjZW50YWdlID0gbmV3Vm9sdW1lUGVyY2VudGFnZTsKICAgICAgICAgICAgZmlyZUV2ZW50KG1yYWlkLkVWRU5UUy5BVURJT1ZPTFVNRUNIQU5HRSwgdm9sdW1lUGVyY2VudGFnZSk7CiAgICAgICAgfQogICAgfTsKCiAgICBtcmFpZC5maXJlVmlld2FibGVDaGFuZ2VFdmVudCA9IGZ1bmN0aW9uIChuZXdJc1ZpZXdhYmxlKSB7CiAgICAgICAgbG9nLmkoIm1yYWlkLmZpcmVWaWV3YWJsZUNoYW5nZUV2ZW50ICIgKyBuZXdJc1ZpZXdhYmxlKTsKICAgICAgICBpZiAoaXNWaWV3YWJsZSAhPT0gbmV3SXNWaWV3YWJsZSkgewogICAgICAgICAgICBpc1ZpZXdhYmxlID0gbmV3SXNWaWV3YWJsZTsKICAgICAgICAgICAgZmlyZUV2ZW50KG1yYWlkLkVWRU5UUy5WSUVXQUJMRUNIQU5HRSwgaXNWaWV3YWJsZSk7CiAgICAgICAgfQogICAgfTsKCiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAgICAgKiBpbnRlcm5hbCBoZWxwZXIgbWV0aG9kcwogICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKICAgIGZ1bmN0aW9uIGNhbGxOYXRpdmUoY29tbWFuZCkgewogICAgICAgIHZhciBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJJRlJBTUUiKTsKICAgICAgICBpZnJhbWUuc2V0QXR0cmlidXRlKCJzcmMiLCAibXJhaWQ6Ly8iICsgY29tbWFuZCk7CiAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKGlmcmFtZSk7CiAgICAgICAgaWZyYW1lLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoaWZyYW1lKTsKICAgICAgICBpZnJhbWUgPSBudWxsOwogICAgfTsKCiAgICBmdW5jdGlvbiBmaXJlRXZlbnQoZXZlbnQpIHsKICAgICAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7CiAgICAgICAgYXJncy5zaGlmdCgpOwogICAgICAgIGxvZy5pKCJmaXJlRXZlbnQgIiArIGV2ZW50ICsgIiBbIiArIGFyZ3MudG9TdHJpbmcoKSArICJdIik7CiAgICAgICAgdmFyIGV2ZW50TGlzdGVuZXJzID0gKGxpc3RlbmVyc1tldmVudF0gfHwgW10pLnNsaWNlKDApOwogICAgICAgIGlmIChldmVudExpc3RlbmVycykgewogICAgICAgICAgICBsb2cuaShldmVudExpc3RlbmVycy5sZW5ndGggKyAiIGxpc3RlbmVyKHMpIGZvdW5kIGZvciAiICsgZXZlbnQpOwogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGV2ZW50TGlzdGVuZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBsb2cuaSgiZmlyaW5nIGxpc3RlbmVyICIgKyBpICsgIiBmb3IgIiArIGV2ZW50ICsgIjogIiArIGV2ZW50TGlzdGVuZXJzW2ldKTsKICAgICAgICAgICAgICAgIGV2ZW50TGlzdGVuZXJzW2ldLmFwcGx5KG51bGwsIGFyZ3MpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbG9nLmkoIm5vIGxpc3RlbmVycyBmb3VuZCIpOwogICAgICAgIH0KICAgIH07CgogICAgZnVuY3Rpb24gY29udGFpbnModmFsdWUsIGFycmF5KSB7CiAgICAgICAgZm9yICh2YXIgaSBpbiBhcnJheSkgewogICAgICAgICAgICBpZiAoYXJyYXlbaV0gPT09IHZhbHVlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9OwoKICAgIC8vIFRoZSBhY3Rpb24gcGFyYW1ldGVyIGlzIGEgc3RyaW5nIHdoaWNoIGlzIHRoZSBuYW1lIG9mIHRoZSBzZXR0ZXIgZnVuY3Rpb24KICAgIC8vIHdoaWNoIGNhbGxlZCB0aGlzIGZ1bmN0aW9uCiAgICAvLyAoaW4gb3RoZXIgd29yZHMsIHNldEV4cGFuZFByb3BldGllcywgc2V0T3JpZW50YXRpb25Qcm9wZXJ0aWVzLCBvcgogICAgLy8gc2V0UmVzaXplUHJvcGVydGllcykuCiAgICAvLyBJdCBzZXJ2ZXMgYm90aCBhcyB0aGUga2V5IHRvIGdldCB0aGUgdGhlIGFwcHJvcHJpYXRlIHNldCBvZiB2YWxpZGF0aW5nCiAgICAvLyBmdW5jdGlvbnMgZnJvbSB0aGUgYWxsVmFsaWRhdG9ycyBvYmplY3QKICAgIC8vIGFzIHdlbGwgYXMgdGhlIGFjdGlvbiBwYXJhbWV0ZXIgb2YgYW55IGVycm9yIGV2ZW50IHRoYXQgbWF5IGJlIHRocm93bi4KICAgIGZ1bmN0aW9uIHZhbGlkYXRlKHByb3BlcnRpZXMsIGFjdGlvbikgewogICAgICAgIHZhciByZXR2YWwgPSB0cnVlOwogICAgICAgIHZhciB2YWxpZGF0b3JzID0gYWxsVmFsaWRhdG9yc1thY3Rpb25dOwogICAgICAgIGZvciAodmFyIHByb3AgaW4gcHJvcGVydGllcykgewogICAgICAgICAgICB2YXIgdmFsaWRhdG9yID0gdmFsaWRhdG9yc1twcm9wXTsKICAgICAgICAgICAgdmFyIHZhbHVlID0gcHJvcGVydGllc1twcm9wXTsKICAgICAgICAgICAgaWYgKHZhbGlkYXRvciAmJiAhdmFsaWRhdG9yKHZhbHVlKSkgewogICAgICAgICAgICAgICAgbXJhaWQuZmlyZUVycm9yRXZlbnQoIlZhbHVlIG9mIHByb3BlcnR5ICIgKyBwcm9wICsgIiAoIiArIHZhbHVlICsgIikgaXMgaW52YWxpZCIsICJtcmFpZC4iICsgYWN0aW9uKTsKICAgICAgICAgICAgICAgIHJldHZhbCA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXR2YWw7CiAgICB9OwoKICAgIHZhciBhbGxWYWxpZGF0b3JzID0gewogICAgICAgICJzZXRFeHBhbmRQcm9wZXJ0aWVzIjogewogICAgICAgICAgICAvLyBJbiBNUkFJRCAyLjAsIHRoZSBvbmx5IHByb3BlcnR5IGluIGV4cGFuZFByb3BlcnRpZXMgd2UgYWN0dWFsbHkgY2FyZSBhYm91dCBpcyB1c2VDdXN0b21DbG9zZS4KICAgICAgICAgICAgLy8gU3RpbGwsIHdlJ2xsIGRvIGEgYmFzaWMgc2FuaXR5IGNoZWNrIG9uIHRoZSB3aWR0aCBhbmQgaGVpZ2h0IHByb3BlcnRpZXMsIHRvby4KICAgICAgICAgICAgIndpZHRoIjogZnVuY3Rpb24gKHdpZHRoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gIWlzTmFOKHdpZHRoKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgImhlaWdodCI6IGZ1bmN0aW9uIChoZWlnaHQpIHsKICAgICAgICAgICAgICAgIHJldHVybiAhaXNOYU4oaGVpZ2h0KTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgInVzZUN1c3RvbUNsb3NlIjogZnVuY3Rpb24gKHVzZUN1c3RvbUNsb3NlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gKHR5cGVvZiB1c2VDdXN0b21DbG9zZSA9PT0gImJvb2xlYW4iKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgInNldE9yaWVudGF0aW9uUHJvcGVydGllcyI6IHsKICAgICAgICAgICAgImFsbG93T3JpZW50YXRpb25DaGFuZ2UiOiBmdW5jdGlvbiAoYWxsb3dPcmllbnRhdGlvbkNoYW5nZSkgewogICAgICAgICAgICAgICAgcmV0dXJuICh0eXBlb2YgYWxsb3dPcmllbnRhdGlvbkNoYW5nZSA9PT0gImJvb2xlYW4iKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgImZvcmNlT3JpZW50YXRpb24iOiBmdW5jdGlvbiAoZm9yY2VPcmllbnRhdGlvbikgewogICAgICAgICAgICAgICAgdmFyIHZhbGlkVmFsdWVzID0gWyJwb3J0cmFpdCIsICJsYW5kc2NhcGUiLCAibm9uZSJdOwogICAgICAgICAgICAgICAgcmV0dXJuICh0eXBlb2YgZm9yY2VPcmllbnRhdGlvbiA9PT0gInN0cmluZyIgJiYgdmFsaWRWYWx1ZXMuaW5kZXhPZihmb3JjZU9yaWVudGF0aW9uKSAhPT0gLTEpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICAic2V0UmVzaXplUHJvcGVydGllcyI6IHsKICAgICAgICAgICAgIndpZHRoIjogZnVuY3Rpb24gKHdpZHRoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gIWlzTmFOKHdpZHRoKSAmJiA1MCA8PSB3aWR0aDsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgImhlaWdodCI6IGZ1bmN0aW9uIChoZWlnaHQpIHsKICAgICAgICAgICAgICAgIHJldHVybiAhaXNOYU4oaGVpZ2h0KSAmJiA1MCA8PSBoZWlnaHQ7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJvZmZzZXRYIjogZnVuY3Rpb24gKG9mZnNldFgpIHsKICAgICAgICAgICAgICAgIHJldHVybiAhaXNOYU4ob2Zmc2V0WCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJvZmZzZXRZIjogZnVuY3Rpb24gKG9mZnNldFkpIHsKICAgICAgICAgICAgICAgIHJldHVybiAhaXNOYU4ob2Zmc2V0WSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJjdXN0b21DbG9zZVBvc2l0aW9uIjogZnVuY3Rpb24gKGN1c3RvbUNsb3NlUG9zaXRpb24pIHsKICAgICAgICAgICAgICAgIHZhciB2YWxpZFBvc2l0aW9ucyA9IFsidG9wLWxlZnQiLCAidG9wLWNlbnRlciIsICJ0b3AtcmlnaHQiLAogICAgICAgICAgICAgICAgICAgICJjZW50ZXIiLAogICAgICAgICAgICAgICAgICAgICJib3R0b20tbGVmdCIsICJib3R0b20tY2VudGVyIiwgImJvdHRvbS1yaWdodCJdOwogICAgICAgICAgICAgICAgcmV0dXJuICh0eXBlb2YgY3VzdG9tQ2xvc2VQb3NpdGlvbiA9PT0gInN0cmluZyIgJiYgdmFsaWRQb3NpdGlvbnMuaW5kZXhPZihjdXN0b21DbG9zZVBvc2l0aW9uKSAhPT0gLTEpOwogICAgICAgICAgICB9LAogICAgICAgICAgICAiYWxsb3dPZmZzY3JlZW4iOiBmdW5jdGlvbiAoYWxsb3dPZmZzY3JlZW4pIHsKICAgICAgICAgICAgICAgIHJldHVybiAodHlwZW9mIGFsbG93T2Zmc2NyZWVuID09PSAiYm9vbGVhbiIpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfTsKCiAgICBmdW5jdGlvbiBpc0Nsb3NlUmVnaW9uT25TY3JlZW4ocHJvcGVydGllcykgewogICAgICAgIGxvZy5kKCJpc0Nsb3NlUmVnaW9uT25TY3JlZW4iKTsKICAgICAgICBsb2cuZCgiZGVmYXVsdFBvc2l0aW9uICIgKyBkZWZhdWx0UG9zaXRpb24ueCArICIgIiArIGRlZmF1bHRQb3NpdGlvbi55KTsKICAgICAgICBsb2cuZCgib2Zmc2V0ICIgKyBwcm9wZXJ0aWVzLm9mZnNldFggKyAiICIgKyBwcm9wZXJ0aWVzLm9mZnNldFkpOwoKICAgICAgICB2YXIgcmVzaXplUmVjdCA9IHt9OwogICAgICAgIHJlc2l6ZVJlY3QueCA9IGRlZmF1bHRQb3NpdGlvbi54ICsgcHJvcGVydGllcy5vZmZzZXRYOwogICAgICAgIHJlc2l6ZVJlY3QueSA9IGRlZmF1bHRQb3NpdGlvbi55ICsgcHJvcGVydGllcy5vZmZzZXRZOwogICAgICAgIHJlc2l6ZVJlY3Qud2lkdGggPSBwcm9wZXJ0aWVzLndpZHRoOwogICAgICAgIHJlc2l6ZVJlY3QuaGVpZ2h0ID0gcHJvcGVydGllcy5oZWlnaHQ7CiAgICAgICAgcHJpbnRSZWN0KCJyZXNpemVSZWN0IiwgcmVzaXplUmVjdCk7CgogICAgICAgIHZhciBjdXN0b21DbG9zZVBvc2l0aW9uID0gcHJvcGVydGllcy5oYXNPd25Qcm9wZXJ0eSgiY3VzdG9tQ2xvc2VQb3NpdGlvbiIpID8KICAgICAgICAgICAgcHJvcGVydGllcy5jdXN0b21DbG9zZVBvc2l0aW9uIDogcmVzaXplUHJvcGVydGllcy5jdXN0b21DbG9zZVBvc2l0aW9uOwogICAgICAgIGxvZy5kKCJjdXN0b21DbG9zZVBvc2l0aW9uICIgKyBjdXN0b21DbG9zZVBvc2l0aW9uKTsKCiAgICAgICAgdmFyIGNsb3NlUmVjdCA9IHsid2lkdGgiOiA1MCwgImhlaWdodCI6IDUwfTsKCiAgICAgICAgaWYgKGN1c3RvbUNsb3NlUG9zaXRpb24uc2VhcmNoKCJsZWZ0IikgIT09IC0xKSB7CiAgICAgICAgICAgIGNsb3NlUmVjdC54ID0gcmVzaXplUmVjdC54OwogICAgICAgIH0gZWxzZSBpZiAoY3VzdG9tQ2xvc2VQb3NpdGlvbi5zZWFyY2goImNlbnRlciIpICE9PSAtMSkgewogICAgICAgICAgICBjbG9zZVJlY3QueCA9IHJlc2l6ZVJlY3QueCArIChyZXNpemVSZWN0LndpZHRoIC8gMikgLSAyNTsKICAgICAgICB9IGVsc2UgaWYgKGN1c3RvbUNsb3NlUG9zaXRpb24uc2VhcmNoKCJyaWdodCIpICE9PSAtMSkgewogICAgICAgICAgICBjbG9zZVJlY3QueCA9IHJlc2l6ZVJlY3QueCArIHJlc2l6ZVJlY3Qud2lkdGggLSA1MDsKICAgICAgICB9CgogICAgICAgIGlmIChjdXN0b21DbG9zZVBvc2l0aW9uLnNlYXJjaCgidG9wIikgIT09IC0xKSB7CiAgICAgICAgICAgIGNsb3NlUmVjdC55ID0gcmVzaXplUmVjdC55OwogICAgICAgIH0gZWxzZSBpZiAoY3VzdG9tQ2xvc2VQb3NpdGlvbiA9PT0gImNlbnRlciIpIHsKICAgICAgICAgICAgY2xvc2VSZWN0LnkgPSByZXNpemVSZWN0LnkgKyAocmVzaXplUmVjdC5oZWlnaHQgLyAyKSAtIDI1OwogICAgICAgIH0gZWxzZSBpZiAoY3VzdG9tQ2xvc2VQb3NpdGlvbi5zZWFyY2goImJvdHRvbSIpICE9PSAtMSkgewogICAgICAgICAgICBjbG9zZVJlY3QueSA9IHJlc2l6ZVJlY3QueSArIHJlc2l6ZVJlY3QuaGVpZ2h0IC0gNTA7CiAgICAgICAgfQoKICAgICAgICB2YXIgbWF4UmVjdCA9IHsieCI6IDAsICJ5IjogMH07CiAgICAgICAgbWF4UmVjdC53aWR0aCA9IG1heFNpemUud2lkdGg7CiAgICAgICAgbWF4UmVjdC5oZWlnaHQgPSBtYXhTaXplLmhlaWdodDsKCiAgICAgICAgcmV0dXJuIGlzUmVjdENvbnRhaW5lZChtYXhSZWN0LCBjbG9zZVJlY3QpOwogICAgfQoKICAgIGZ1bmN0aW9uIGZpdFJlc2l6ZVZpZXdPblNjcmVlbihwcm9wZXJ0aWVzKSB7CiAgICAgICAgbG9nLmQoImZpdFJlc2l6ZVZpZXdPblNjcmVlbiIpOwogICAgICAgIGxvZy5kKCJkZWZhdWx0UG9zaXRpb24gIiArIGRlZmF1bHRQb3NpdGlvbi54ICsgIiAiICsgZGVmYXVsdFBvc2l0aW9uLnkpOwogICAgICAgIGxvZy5kKCJvZmZzZXQgIiArIHByb3BlcnRpZXMub2Zmc2V0WCArICIgIiArIHByb3BlcnRpZXMub2Zmc2V0WSk7CgogICAgICAgIHZhciByZXNpemVSZWN0ID0ge307CiAgICAgICAgcmVzaXplUmVjdC54ID0gZGVmYXVsdFBvc2l0aW9uLnggKyBwcm9wZXJ0aWVzLm9mZnNldFg7CiAgICAgICAgcmVzaXplUmVjdC55ID0gZGVmYXVsdFBvc2l0aW9uLnkgKyBwcm9wZXJ0aWVzLm9mZnNldFk7CiAgICAgICAgcmVzaXplUmVjdC53aWR0aCA9IHByb3BlcnRpZXMud2lkdGg7CiAgICAgICAgcmVzaXplUmVjdC5oZWlnaHQgPSBwcm9wZXJ0aWVzLmhlaWdodDsKICAgICAgICBwcmludFJlY3QoInJlc2l6ZVJlY3QiLCByZXNpemVSZWN0KTsKCiAgICAgICAgdmFyIG1heFJlY3QgPSB7IngiOiAwLCAieSI6IDB9OwogICAgICAgIG1heFJlY3Qud2lkdGggPSBtYXhTaXplLndpZHRoOwogICAgICAgIG1heFJlY3QuaGVpZ2h0ID0gbWF4U2l6ZS5oZWlnaHQ7CgogICAgICAgIHZhciBhZGp1c3RtZW50cyA9IHsieCI6IDAsICJ5IjogMH07CgogICAgICAgIGlmIChpc1JlY3RDb250YWluZWQobWF4UmVjdCwgcmVzaXplUmVjdCkpIHsKICAgICAgICAgICAgbG9nLmQoIm5vIGFkanVzdG1lbnQgbmVjZXNzYXJ5Iik7CiAgICAgICAgICAgIHJldHVybiBhZGp1c3RtZW50czsKICAgICAgICB9CgogICAgICAgIGlmIChyZXNpemVSZWN0LnggPCBtYXhSZWN0LngpIHsKICAgICAgICAgICAgYWRqdXN0bWVudHMueCA9IG1heFJlY3QueCAtIHJlc2l6ZVJlY3QueDsKICAgICAgICB9IGVsc2UgaWYgKChyZXNpemVSZWN0LnggKyByZXNpemVSZWN0LndpZHRoKSA+IChtYXhSZWN0LnggKyBtYXhSZWN0LndpZHRoKSkgewogICAgICAgICAgICBhZGp1c3RtZW50cy54ID0gKG1heFJlY3QueCArIG1heFJlY3Qud2lkdGgpIC0gKHJlc2l6ZVJlY3QueCArIHJlc2l6ZVJlY3Qud2lkdGgpOwogICAgICAgIH0KICAgICAgICBsb2cuZCgiYWRqdXN0bWVudHMueCAiICsgYWRqdXN0bWVudHMueCk7CgogICAgICAgIGlmIChyZXNpemVSZWN0LnkgPCBtYXhSZWN0LnkpIHsKICAgICAgICAgICAgYWRqdXN0bWVudHMueSA9IG1heFJlY3QueSAtIHJlc2l6ZVJlY3QueTsKICAgICAgICB9IGVsc2UgaWYgKChyZXNpemVSZWN0LnkgKyByZXNpemVSZWN0LmhlaWdodCkgPiAobWF4UmVjdC55ICsgbWF4UmVjdC5oZWlnaHQpKSB7CiAgICAgICAgICAgIGFkanVzdG1lbnRzLnkgPSAobWF4UmVjdC55ICsgbWF4UmVjdC5oZWlnaHQpIC0gKHJlc2l6ZVJlY3QueSArIHJlc2l6ZVJlY3QuaGVpZ2h0KTsKICAgICAgICB9CiAgICAgICAgbG9nLmQoImFkanVzdG1lbnRzLnkgIiArIGFkanVzdG1lbnRzLnkpOwoKICAgICAgICByZXNpemVSZWN0LnggPSBkZWZhdWx0UG9zaXRpb24ueCArIHByb3BlcnRpZXMub2Zmc2V0WCArIGFkanVzdG1lbnRzLng7CiAgICAgICAgcmVzaXplUmVjdC55ID0gZGVmYXVsdFBvc2l0aW9uLnkgKyBwcm9wZXJ0aWVzLm9mZnNldFkgKyBhZGp1c3RtZW50cy55OwogICAgICAgIHByaW50UmVjdCgiYWRqdXN0ZWQgcmVzaXplUmVjdCIsIHJlc2l6ZVJlY3QpOwoKICAgICAgICByZXR1cm4gYWRqdXN0bWVudHM7CiAgICB9CgogICAgZnVuY3Rpb24gaXNSZWN0Q29udGFpbmVkKGNvbnRhaW5pbmdSZWN0LCBjb250YWluZWRSZWN0KSB7CiAgICAgICAgbG9nLmQoImlzUmVjdENvbnRhaW5lZCIpOwogICAgICAgIHByaW50UmVjdCgiY29udGFpbmluZ1JlY3QiLCBjb250YWluaW5nUmVjdCk7CiAgICAgICAgcHJpbnRSZWN0KCJjb250YWluZWRSZWN0IiwgY29udGFpbmVkUmVjdCk7CiAgICAgICAgcmV0dXJuIChjb250YWluZWRSZWN0LnggPj0gY29udGFpbmluZ1JlY3QueCAmJgogICAgICAgICAgICAoY29udGFpbmVkUmVjdC54ICsgY29udGFpbmVkUmVjdC53aWR0aCkgPD0gKGNvbnRhaW5pbmdSZWN0LnggKyBjb250YWluaW5nUmVjdC53aWR0aCkgJiYKICAgICAgICAgICAgY29udGFpbmVkUmVjdC55ID49IGNvbnRhaW5pbmdSZWN0LnkgJiYKICAgICAgICAgICAgKGNvbnRhaW5lZFJlY3QueSArIGNvbnRhaW5lZFJlY3QuaGVpZ2h0KSA8PSAoY29udGFpbmluZ1JlY3QueSArIGNvbnRhaW5pbmdSZWN0LmhlaWdodCkpOwogICAgfQoKICAgIGZ1bmN0aW9uIHByaW50UmVjdChsYWJlbCwgcmVjdCkgewogICAgICAgIGxvZy5kKGxhYmVsICsKICAgICAgICAgICAgIiBbIiArIHJlY3QueCArICIsIiArIHJlY3QueSArICJdIiArCiAgICAgICAgICAgICIsWyIgKyAocmVjdC54ICsgcmVjdC53aWR0aCkgKyAiLCIgKyAocmVjdC55ICsgcmVjdC5oZWlnaHQpICsgIl0iICsKICAgICAgICAgICAgIiAoIiArIHJlY3Qud2lkdGggKyAieCIgKyByZWN0LmhlaWdodCArICIpIik7CiAgICB9CgogICAgbXJhaWQuZHVtcExpc3RlbmVycyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgbkV2ZW50cyA9IE9iamVjdC5rZXlzKGxpc3RlbmVycykubGVuZ3RoOwogICAgICAgIGxvZy5pKCJkdW1waW5nIGxpc3RlbmVycyAoIiArIG5FdmVudHMgKyAiIGV2ZW50cykiKTsKICAgICAgICBmb3IgKHZhciBldmVudCBpbiBsaXN0ZW5lcnMpIHsKICAgICAgICAgICAgdmFyIGV2ZW50TGlzdGVuZXJzID0gbGlzdGVuZXJzW2V2ZW50XTsKICAgICAgICAgICAgbG9nLmkoIiAgIiArIGV2ZW50ICsgIiBjb250YWlucyAiICsgZXZlbnRMaXN0ZW5lcnMubGVuZ3RoICsgIiBsaXN0ZW5lcnMiKTsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBldmVudExpc3RlbmVycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgbG9nLmkoIiAgICAiICsgZXZlbnRMaXN0ZW5lcnNbaV0pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfTsKCiAgICBjb25zb2xlLmxvZygiTVJBSUQgb2JqZWN0IGxvYWRlZCIpOwoKfSkoKTs="

    .line 18
    invoke-static {p0, v7}, Landroid/util/Base64;->decode(Ljava/lang/String;I)[B

    move-result-object p0

    .line 19
    new-instance v1, Ljava/lang/String;

    invoke-direct {v1, p0}, Ljava/lang/String;-><init>([B)V

    .line 20
    new-instance p0, Ljava/lang/StringBuilder;

    invoke-direct {p0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "<script>"

    invoke-virtual {p0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {p0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {p0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {p0, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, "</script>"

    invoke-virtual {p0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object p0

    const-string v5, "OyhmdW5jdGlvbihvbWlkR2xvYmFsKSB7CiAgdmFyIG47ZnVuY3Rpb24gYWEoYSl7dmFyIGI9MDtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gYjxhLmxlbmd0aD97ZG9uZTohMSx2YWx1ZTphW2IrK119Ontkb25lOiEwfX19ZnVuY3Rpb24gcChhKXt2YXIgYj0ndW5kZWZpbmVkJyE9dHlwZW9mIFN5bWJvbCYmU3ltYm9sLml0ZXJhdG9yJiZhW1N5bWJvbC5pdGVyYXRvcl07aWYoYilyZXR1cm4gYi5jYWxsKGEpO2lmKCdudW1iZXInPT10eXBlb2YgYS5sZW5ndGgpcmV0dXJue25leHQ6YWEoYSl9O3Rocm93IEVycm9yKFN0cmluZyhhKSsnIGlzIG5vdCBhbiBpdGVyYWJsZSBvciBBcnJheUxpa2UnKTt9ZnVuY3Rpb24gcShhKXtpZighKGEgaW5zdGFuY2VvZiBBcnJheSkpe2E9cChhKTtmb3IodmFyIGIsYz1bXTshKGI9YS5uZXh0KCkpLmRvbmU7KWMucHVzaChiLnZhbHVlKTthPWN9cmV0dXJuIGF9CnZhciBiYT0nZnVuY3Rpb24nPT10eXBlb2YgT2JqZWN0LmNyZWF0ZT9PYmplY3QuY3JlYXRlOmZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoKXt9Yi5wcm90b3R5cGU9YTtyZXR1cm4gbmV3IGJ9LGNhPSdmdW5jdGlvbic9PXR5cGVvZiBPYmplY3QuZGVmaW5lUHJvcGVydGllcz9PYmplY3QuZGVmaW5lUHJvcGVydHk6ZnVuY3Rpb24oYSxiLGMpe2lmKGE9PUFycmF5LnByb3RvdHlwZXx8YT09T2JqZWN0LnByb3RvdHlwZSlyZXR1cm4gYTthW2JdPWMudmFsdWU7cmV0dXJuIGF9OwpmdW5jdGlvbiBkYShhKXthPVsnb2JqZWN0Jz09dHlwZW9mIGdsb2JhbFRoaXMmJmdsb2JhbFRoaXMsYSwnb2JqZWN0Jz09dHlwZW9mIHdpbmRvdyYmd2luZG93LCdvYmplY3QnPT10eXBlb2Ygc2VsZiYmc2VsZiwnb2JqZWN0Jz09dHlwZW9mIGdsb2JhbCYmZ2xvYmFsXTtmb3IodmFyIGI9MDtiPGEubGVuZ3RoOysrYil7dmFyIGM9YVtiXTtpZihjJiZjLk1hdGg9PU1hdGgpcmV0dXJuIGN9dGhyb3cgRXJyb3IoJ0Nhbm5vdCBmaW5kIGdsb2JhbCBvYmplY3QnKTt9dmFyIGVhPWRhKHRoaXMpO2Z1bmN0aW9uIHIoYSxiKXtpZihiKWE6e3ZhciBjPWVhO2E9YS5zcGxpdCgnLicpO2Zvcih2YXIgZD0wO2Q8YS5sZW5ndGgtMTtkKyspe3ZhciBlPWFbZF07aWYoIShlIGluIGMpKWJyZWFrIGE7Yz1jW2VdfWE9YVthLmxlbmd0aC0xXTtkPWNbYV07Yj1iKGQpO2IhPWQmJm51bGwhPWImJmNhKGMsYSx7Y29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwLHZhbHVlOmJ9KX19dmFyIGZhOwppZignZnVuY3Rpb24nPT10eXBlb2YgT2JqZWN0LnNldFByb3RvdHlwZU9mKWZhPU9iamVjdC5zZXRQcm90b3R5cGVPZjtlbHNle3ZhciBoYTthOnt2YXIgaWE9e2E6ITB9LGphPXt9O3RyeXtqYS5fX3Byb3RvX189aWE7aGE9amEuYTticmVhayBhfWNhdGNoKGEpe31oYT0hMX1mYT1oYT9mdW5jdGlvbihhLGIpe2EuX19wcm90b19fPWI7aWYoYS5fX3Byb3RvX18hPT1iKXRocm93IG5ldyBUeXBlRXJyb3IoYSsnIGlzIG5vdCBleHRlbnNpYmxlJyk7cmV0dXJuIGF9Om51bGx9dmFyIGthPWZhOwpmdW5jdGlvbiBsYShhLGIpe2EucHJvdG90eXBlPWJhKGIucHJvdG90eXBlKTthLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1hO2lmKGthKWthKGEsYik7ZWxzZSBmb3IodmFyIGMgaW4gYilpZigncHJvdG90eXBlJyE9YylpZihPYmplY3QuZGVmaW5lUHJvcGVydGllcyl7dmFyIGQ9T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihiLGMpO2QmJk9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLGMsZCl9ZWxzZSBhW2NdPWJbY107YS5LYT1iLnByb3RvdHlwZX1mdW5jdGlvbiB1KCl7Zm9yKHZhciBhPU51bWJlcih0aGlzKSxiPVtdLGM9YTtjPGFyZ3VtZW50cy5sZW5ndGg7YysrKWJbYy1hXT1hcmd1bWVudHNbY107cmV0dXJuIGJ9ZnVuY3Rpb24gdihhLGIpe3JldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYSxiKX0KdmFyIG1hPSdmdW5jdGlvbic9PXR5cGVvZiBPYmplY3QuYXNzaWduP09iamVjdC5hc3NpZ246ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9MTtjPGFyZ3VtZW50cy5sZW5ndGg7YysrKXt2YXIgZD1hcmd1bWVudHNbY107aWYoZClmb3IodmFyIGUgaW4gZCl2KGQsZSkmJihhW2VdPWRbZV0pfXJldHVybiBhfTtyKCdPYmplY3QuYXNzaWduJyxmdW5jdGlvbihhKXtyZXR1cm4gYXx8bWF9KTsKcignU3ltYm9sJyxmdW5jdGlvbihhKXtmdW5jdGlvbiBiKGYpe2lmKHRoaXMgaW5zdGFuY2VvZiBiKXRocm93IG5ldyBUeXBlRXJyb3IoJ1N5bWJvbCBpcyBub3QgYSBjb25zdHJ1Y3RvcicpO3JldHVybiBuZXcgYyhkKyhmfHwnJykrJ18nK2UrKyxmKX1mdW5jdGlvbiBjKGYsbCl7dGhpcy5nPWY7Y2EodGhpcywnZGVzY3JpcHRpb24nLHtjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITAsdmFsdWU6bH0pfWlmKGEpcmV0dXJuIGE7Yy5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nfTt2YXIgZD0nanNjb21wX3N5bWJvbF8nKygxRTkqTWF0aC5yYW5kb20oKT4+PjApKydfJyxlPTA7cmV0dXJuIGJ9KTsKcignU3ltYm9sLml0ZXJhdG9yJyxmdW5jdGlvbihhKXtpZihhKXJldHVybiBhO2E9U3ltYm9sKCdTeW1ib2wuaXRlcmF0b3InKTtmb3IodmFyIGI9J0FycmF5IEludDhBcnJheSBVaW50OEFycmF5IFVpbnQ4Q2xhbXBlZEFycmF5IEludDE2QXJyYXkgVWludDE2QXJyYXkgSW50MzJBcnJheSBVaW50MzJBcnJheSBGbG9hdDMyQXJyYXkgRmxvYXQ2NEFycmF5Jy5zcGxpdCgnICcpLGM9MDtjPGIubGVuZ3RoO2MrKyl7dmFyIGQ9ZWFbYltjXV07J2Z1bmN0aW9uJz09PXR5cGVvZiBkJiYnZnVuY3Rpb24nIT10eXBlb2YgZC5wcm90b3R5cGVbYV0mJmNhKGQucHJvdG90eXBlLGEse2NvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMCx2YWx1ZTpmdW5jdGlvbigpe3JldHVybiBuYShhYSh0aGlzKSl9fSl9cmV0dXJuIGF9KTtmdW5jdGlvbiBuYShhKXthPXtuZXh0OmF9O2FbU3ltYm9sLml0ZXJhdG9yXT1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtyZXR1cm4gYX0KcignV2Vha01hcCcsZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYihoKXt0aGlzLmc9KGcrPU1hdGgucmFuZG9tKCkrMSkudG9TdHJpbmcoKTtpZihoKXtoPXAoaCk7Zm9yKHZhciBrOyEoaz1oLm5leHQoKSkuZG9uZTspaz1rLnZhbHVlLHRoaXMuc2V0KGtbMF0sa1sxXSl9fWZ1bmN0aW9uIGMoKXt9ZnVuY3Rpb24gZChoKXt2YXIgaz10eXBlb2YgaDtyZXR1cm4nb2JqZWN0Jz09PWsmJm51bGwhPT1ofHwnZnVuY3Rpb24nPT09a31mdW5jdGlvbiBlKGgpe2lmKCF2KGgsbCkpe3ZhciBrPW5ldyBjO2NhKGgsbCx7dmFsdWU6a30pfX1mdW5jdGlvbiBmKGgpe3ZhciBrPU9iamVjdFtoXTtrJiYoT2JqZWN0W2hdPWZ1bmN0aW9uKG0pe2lmKG0gaW5zdGFuY2VvZiBjKXJldHVybiBtO09iamVjdC5pc0V4dGVuc2libGUobSkmJmUobSk7cmV0dXJuIGsobSl9KX1pZihmdW5jdGlvbigpe2lmKCFhfHwhT2JqZWN0LnNlYWwpcmV0dXJuITE7dHJ5e3ZhciBoPU9iamVjdC5zZWFsKHt9KSxrPU9iamVjdC5zZWFsKHt9KSwKbT1uZXcgYShbW2gsMl0sW2ssM11dKTtpZigyIT1tLmdldChoKXx8MyE9bS5nZXQoaykpcmV0dXJuITE7bS5kZWxldGUoaCk7bS5zZXQoayw0KTtyZXR1cm4hbS5oYXMoaCkmJjQ9PW0uZ2V0KGspfWNhdGNoKHQpe3JldHVybiExfX0oKSlyZXR1cm4gYTt2YXIgbD0nJGpzY29tcF9oaWRkZW5fJytNYXRoLnJhbmRvbSgpO2YoJ2ZyZWV6ZScpO2YoJ3ByZXZlbnRFeHRlbnNpb25zJyk7Zignc2VhbCcpO3ZhciBnPTA7Yi5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKGgsayl7aWYoIWQoaCkpdGhyb3cgRXJyb3IoJ0ludmFsaWQgV2Vha01hcCBrZXknKTtlKGgpO2lmKCF2KGgsbCkpdGhyb3cgRXJyb3IoJ1dlYWtNYXAga2V5IGZhaWw6ICcraCk7aFtsXVt0aGlzLmddPWs7cmV0dXJuIHRoaXN9O2IucHJvdG90eXBlLmdldD1mdW5jdGlvbihoKXtyZXR1cm4gZChoKSYmdihoLGwpP2hbbF1bdGhpcy5nXTp2b2lkIDB9O2IucHJvdG90eXBlLmhhcz1mdW5jdGlvbihoKXtyZXR1cm4gZChoKSYmdihoLApsKSYmdihoW2xdLHRoaXMuZyl9O2IucHJvdG90eXBlLmRlbGV0ZT1mdW5jdGlvbihoKXtyZXR1cm4gZChoKSYmdihoLGwpJiZ2KGhbbF0sdGhpcy5nKT9kZWxldGUgaFtsXVt0aGlzLmddOiExfTtyZXR1cm4gYn0pOwpyKCdNYXAnLGZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoKXt2YXIgZz17fTtyZXR1cm4gZy5HPWcubmV4dD1nLmhlYWQ9Z31mdW5jdGlvbiBjKGcsaCl7dmFyIGs9Zy5nO3JldHVybiBuYShmdW5jdGlvbigpe2lmKGspe2Zvcig7ay5oZWFkIT1nLmc7KWs9ay5HO2Zvcig7ay5uZXh0IT1rLmhlYWQ7KXJldHVybiBrPWsubmV4dCx7ZG9uZTohMSx2YWx1ZTpoKGspfTtrPW51bGx9cmV0dXJue2RvbmU6ITAsdmFsdWU6dm9pZCAwfX0pfWZ1bmN0aW9uIGQoZyxoKXt2YXIgaz1oJiZ0eXBlb2YgaDsnb2JqZWN0Jz09a3x8J2Z1bmN0aW9uJz09az9mLmhhcyhoKT9rPWYuZ2V0KGgpOihrPScnKyArK2wsZi5zZXQoaCxrKSk6az0ncF8nK2g7dmFyIG09Zy5oW2tdO2lmKG0mJnYoZy5oLGspKWZvcihnPTA7ZzxtLmxlbmd0aDtnKyspe3ZhciB0PW1bZ107aWYoaCE9PWgmJnQua2V5IT09dC5rZXl8fGg9PT10LmtleSlyZXR1cm57aWQ6ayxsaXN0Om0saW5kZXg6ZyxCOnR9fXJldHVybntpZDprLGxpc3Q6bSwKaW5kZXg6LTEsQjp2b2lkIDB9fWZ1bmN0aW9uIGUoZyl7dGhpcy5oPXt9O3RoaXMuZz1iKCk7dGhpcy5zaXplPTA7aWYoZyl7Zz1wKGcpO2Zvcih2YXIgaDshKGg9Zy5uZXh0KCkpLmRvbmU7KWg9aC52YWx1ZSx0aGlzLnNldChoWzBdLGhbMV0pfX1pZihmdW5jdGlvbigpe2lmKCFhfHwnZnVuY3Rpb24nIT10eXBlb2YgYXx8IWEucHJvdG90eXBlLmVudHJpZXN8fCdmdW5jdGlvbichPXR5cGVvZiBPYmplY3Quc2VhbClyZXR1cm4hMTt0cnl7dmFyIGc9T2JqZWN0LnNlYWwoe3g6NH0pLGg9bmV3IGEocChbW2csJ3MnXV0pKTtpZigncychPWguZ2V0KGcpfHwxIT1oLnNpemV8fGguZ2V0KHt4OjR9KXx8aC5zZXQoe3g6NH0sJ3QnKSE9aHx8MiE9aC5zaXplKXJldHVybiExO3ZhciBrPWguZW50cmllcygpLG09ay5uZXh0KCk7aWYobS5kb25lfHxtLnZhbHVlWzBdIT1nfHwncychPW0udmFsdWVbMV0pcmV0dXJuITE7bT1rLm5leHQoKTtyZXR1cm4gbS5kb25lfHw0IT1tLnZhbHVlWzBdLnh8fAondCchPW0udmFsdWVbMV18fCFrLm5leHQoKS5kb25lPyExOiEwfWNhdGNoKHQpe3JldHVybiExfX0oKSlyZXR1cm4gYTt2YXIgZj1uZXcgV2Vha01hcDtlLnByb3RvdHlwZS5zZXQ9ZnVuY3Rpb24oZyxoKXtnPTA9PT1nPzA6Zzt2YXIgaz1kKHRoaXMsZyk7ay5saXN0fHwoay5saXN0PXRoaXMuaFtrLmlkXT1bXSk7ay5CP2suQi52YWx1ZT1oOihrLkI9e25leHQ6dGhpcy5nLEc6dGhpcy5nLkcsaGVhZDp0aGlzLmcsa2V5OmcsdmFsdWU6aH0say5saXN0LnB1c2goay5CKSx0aGlzLmcuRy5uZXh0PWsuQix0aGlzLmcuRz1rLkIsdGhpcy5zaXplKyspO3JldHVybiB0aGlzfTtlLnByb3RvdHlwZS5kZWxldGU9ZnVuY3Rpb24oZyl7Zz1kKHRoaXMsZyk7cmV0dXJuIGcuQiYmZy5saXN0PyhnLmxpc3Quc3BsaWNlKGcuaW5kZXgsMSksZy5saXN0Lmxlbmd0aHx8ZGVsZXRlIHRoaXMuaFtnLmlkXSxnLkIuRy5uZXh0PWcuQi5uZXh0LGcuQi5uZXh0Lkc9Zy5CLkcsZy5CLmhlYWQ9bnVsbCx0aGlzLnNpemUtLSwKITApOiExfTtlLnByb3RvdHlwZS5jbGVhcj1mdW5jdGlvbigpe3RoaXMuaD17fTt0aGlzLmc9dGhpcy5nLkc9YigpO3RoaXMuc2l6ZT0wfTtlLnByb3RvdHlwZS5oYXM9ZnVuY3Rpb24oZyl7cmV0dXJuISFkKHRoaXMsZykuQn07ZS5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGcpe3JldHVybihnPWQodGhpcyxnKS5CKSYmZy52YWx1ZX07ZS5wcm90b3R5cGUuZW50cmllcz1mdW5jdGlvbigpe3JldHVybiBjKHRoaXMsZnVuY3Rpb24oZyl7cmV0dXJuW2cua2V5LGcudmFsdWVdfSl9O2UucHJvdG90eXBlLmtleXM9ZnVuY3Rpb24oKXtyZXR1cm4gYyh0aGlzLGZ1bmN0aW9uKGcpe3JldHVybiBnLmtleX0pfTtlLnByb3RvdHlwZS52YWx1ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gYyh0aGlzLGZ1bmN0aW9uKGcpe3JldHVybiBnLnZhbHVlfSl9O2UucHJvdG90eXBlLmZvckVhY2g9ZnVuY3Rpb24oZyxoKXtmb3IodmFyIGs9dGhpcy5lbnRyaWVzKCksbTshKG09ay5uZXh0KCkpLmRvbmU7KW09bS52YWx1ZSwKZy5jYWxsKGgsbVsxXSxtWzBdLHRoaXMpfTtlLnByb3RvdHlwZVtTeW1ib2wuaXRlcmF0b3JdPWUucHJvdG90eXBlLmVudHJpZXM7dmFyIGw9MDtyZXR1cm4gZX0pO3IoJ09iamVjdC52YWx1ZXMnLGZ1bmN0aW9uKGEpe3JldHVybiBhP2E6ZnVuY3Rpb24oYil7dmFyIGM9W10sZDtmb3IoZCBpbiBiKXYoYixkKSYmYy5wdXNoKGJbZF0pO3JldHVybiBjfX0pO2Z1bmN0aW9uIG9hKGEsYil7YSBpbnN0YW5jZW9mIFN0cmluZyYmKGErPScnKTt2YXIgYz0wLGQ9ITEsZT17bmV4dDpmdW5jdGlvbigpe2lmKCFkJiZjPGEubGVuZ3RoKXt2YXIgZj1jKys7cmV0dXJue3ZhbHVlOmIoZixhW2ZdKSxkb25lOiExfX1kPSEwO3JldHVybntkb25lOiEwLHZhbHVlOnZvaWQgMH19fTtlW1N5bWJvbC5pdGVyYXRvcl09ZnVuY3Rpb24oKXtyZXR1cm4gZX07cmV0dXJuIGV9cignQXJyYXkucHJvdG90eXBlLmtleXMnLGZ1bmN0aW9uKGEpe3JldHVybiBhP2E6ZnVuY3Rpb24oKXtyZXR1cm4gb2EodGhpcyxmdW5jdGlvbihiKXtyZXR1cm4gYn0pfX0pOwpyKCdTZXQnLGZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYyl7dGhpcy5nPW5ldyBNYXA7aWYoYyl7Yz1wKGMpO2Zvcih2YXIgZDshKGQ9Yy5uZXh0KCkpLmRvbmU7KXRoaXMuYWRkKGQudmFsdWUpfXRoaXMuc2l6ZT10aGlzLmcuc2l6ZX1pZihmdW5jdGlvbigpe2lmKCFhfHwnZnVuY3Rpb24nIT10eXBlb2YgYXx8IWEucHJvdG90eXBlLmVudHJpZXN8fCdmdW5jdGlvbichPXR5cGVvZiBPYmplY3Quc2VhbClyZXR1cm4hMTt0cnl7dmFyIGM9T2JqZWN0LnNlYWwoe3g6NH0pLGQ9bmV3IGEocChbY10pKTtpZighZC5oYXMoYyl8fDEhPWQuc2l6ZXx8ZC5hZGQoYykhPWR8fDEhPWQuc2l6ZXx8ZC5hZGQoe3g6NH0pIT1kfHwyIT1kLnNpemUpcmV0dXJuITE7dmFyIGU9ZC5lbnRyaWVzKCksZj1lLm5leHQoKTtpZihmLmRvbmV8fGYudmFsdWVbMF0hPWN8fGYudmFsdWVbMV0hPWMpcmV0dXJuITE7Zj1lLm5leHQoKTtyZXR1cm4gZi5kb25lfHxmLnZhbHVlWzBdPT1jfHw0IT1mLnZhbHVlWzBdLnh8fApmLnZhbHVlWzFdIT1mLnZhbHVlWzBdPyExOmUubmV4dCgpLmRvbmV9Y2F0Y2gobCl7cmV0dXJuITF9fSgpKXJldHVybiBhO2IucHJvdG90eXBlLmFkZD1mdW5jdGlvbihjKXtjPTA9PT1jPzA6Yzt0aGlzLmcuc2V0KGMsYyk7dGhpcy5zaXplPXRoaXMuZy5zaXplO3JldHVybiB0aGlzfTtiLnByb3RvdHlwZS5kZWxldGU9ZnVuY3Rpb24oYyl7Yz10aGlzLmcuZGVsZXRlKGMpO3RoaXMuc2l6ZT10aGlzLmcuc2l6ZTtyZXR1cm4gY307Yi5wcm90b3R5cGUuY2xlYXI9ZnVuY3Rpb24oKXt0aGlzLmcuY2xlYXIoKTt0aGlzLnNpemU9MH07Yi5wcm90b3R5cGUuaGFzPWZ1bmN0aW9uKGMpe3JldHVybiB0aGlzLmcuaGFzKGMpfTtiLnByb3RvdHlwZS5lbnRyaWVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZy5lbnRyaWVzKCl9O2IucHJvdG90eXBlLnZhbHVlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmcudmFsdWVzKCl9O2IucHJvdG90eXBlLmtleXM9Yi5wcm90b3R5cGUudmFsdWVzO2IucHJvdG90eXBlW1N5bWJvbC5pdGVyYXRvcl09CmIucHJvdG90eXBlLnZhbHVlcztiLnByb3RvdHlwZS5mb3JFYWNoPWZ1bmN0aW9uKGMsZCl7dmFyIGU9dGhpczt0aGlzLmcuZm9yRWFjaChmdW5jdGlvbihmKXtyZXR1cm4gYy5jYWxsKGQsZixmLGUpfSl9O3JldHVybiBifSk7cignT2JqZWN0LmlzJyxmdW5jdGlvbihhKXtyZXR1cm4gYT9hOmZ1bmN0aW9uKGIsYyl7cmV0dXJuIGI9PT1jPzAhPT1ifHwxL2I9PT0xL2M6YiE9PWImJmMhPT1jfX0pO3IoJ0FycmF5LnByb3RvdHlwZS5pbmNsdWRlcycsZnVuY3Rpb24oYSl7cmV0dXJuIGE/YTpmdW5jdGlvbihiLGMpe3ZhciBkPXRoaXM7ZCBpbnN0YW5jZW9mIFN0cmluZyYmKGQ9U3RyaW5nKGQpKTt2YXIgZT1kLmxlbmd0aDtjPWN8fDA7Zm9yKDA+YyYmKGM9TWF0aC5tYXgoYytlLDApKTtjPGU7YysrKXt2YXIgZj1kW2NdO2lmKGY9PT1ifHxPYmplY3QuaXMoZixiKSlyZXR1cm4hMH1yZXR1cm4hMX19KTsKcignU3RyaW5nLnByb3RvdHlwZS5pbmNsdWRlcycsZnVuY3Rpb24oYSl7cmV0dXJuIGE/YTpmdW5jdGlvbihiLGMpe2lmKG51bGw9PXRoaXMpdGhyb3cgbmV3IFR5cGVFcnJvcigiVGhlICd0aGlzJyB2YWx1ZSBmb3IgU3RyaW5nLnByb3RvdHlwZS5pbmNsdWRlcyBtdXN0IG5vdCBiZSBudWxsIG9yIHVuZGVmaW5lZCIpO2lmKGIgaW5zdGFuY2VvZiBSZWdFeHApdGhyb3cgbmV3IFR5cGVFcnJvcignRmlyc3QgYXJndW1lbnQgdG8gU3RyaW5nLnByb3RvdHlwZS5pbmNsdWRlcyBtdXN0IG5vdCBiZSBhIHJlZ3VsYXIgZXhwcmVzc2lvbicpO3JldHVybi0xIT09dGhpcy5pbmRleE9mKGIsY3x8MCl9fSk7cignT2JqZWN0LmVudHJpZXMnLGZ1bmN0aW9uKGEpe3JldHVybiBhP2E6ZnVuY3Rpb24oYil7dmFyIGM9W10sZDtmb3IoZCBpbiBiKXYoYixkKSYmYy5wdXNoKFtkLGJbZF1dKTtyZXR1cm4gY319KTsKdmFyIHc9e3hhOidsb2FkZWQnLEZhOidzdGFydCcscmE6J2ZpcnN0UXVhcnRpbGUnLHphOidtaWRwb2ludCcsR2E6J3RoaXJkUXVhcnRpbGUnLHBhOidjb21wbGV0ZScsQmE6J3BhdXNlJyxEYToncmVzdW1lJyxvYTonYnVmZmVyU3RhcnQnLG5hOididWZmZXJGaW5pc2gnLEVhOidza2lwcGVkJyxJYTondm9sdW1lQ2hhbmdlJyxDYToncGxheWVyU3RhdGVDaGFuZ2UnLGthOidhZFVzZXJJbnRlcmFjdGlvbid9LHBhPXt1YTonZ2VuZXJpYycsSGE6J3ZpZGVvJyx5YTonbWVkaWEnfSxxYT17YWE6J25hdGl2ZScsdmE6J2h0bWwnLFg6J2phdmFzY3JpcHQnfSxyYT17YWE6J25hdGl2ZScsWDonamF2YXNjcmlwdCcsTk9ORTonbm9uZSd9LHNhPXt0YTonZnVsbCcscWE6J2RvbWFpbicsd2E6J2xpbWl0ZWQnfSx0YT17bWE6J2JhY2tncm91bmRlZCcsc2E6J2ZvcmVncm91bmRlZCd9LHVhPXtsYTonYXBwJyxKYTond2ViJ307ZnVuY3Rpb24geChhLGIpe3RoaXMueD1udWxsIT1hLng/YS54OmEubGVmdDt0aGlzLnk9bnVsbCE9YS55P2EueTphLnRvcDt0aGlzLndpZHRoPWEud2lkdGg7dGhpcy5oZWlnaHQ9YS5oZWlnaHQ7dGhpcy5lbmRYPXRoaXMueCt0aGlzLndpZHRoO3RoaXMuZW5kWT10aGlzLnkrdGhpcy5oZWlnaHQ7dGhpcy5hZFNlc3Npb25JZD1hLmFkU2Vzc2lvbklkfHx2b2lkIDA7dGhpcy5pc0ZyaWVuZGx5T2JzdHJ1Y3Rpb25Gb3I9YS5pc0ZyaWVuZGx5T2JzdHJ1Y3Rpb25Gb3J8fFtdO3RoaXMuaD1hLmZyaWVuZGx5T2JzdHJ1Y3Rpb25DbGFzc3x8dm9pZCAwO3RoaXMuaT1hLmZyaWVuZGx5T2JzdHJ1Y3Rpb25QdXJwb3NlfHx2b2lkIDA7dGhpcy5qPWEuZnJpZW5kbHlPYnN0cnVjdGlvblJlYXNvbnx8dm9pZCAwO3RoaXMuY2xpcHNUb0JvdW5kcz12b2lkIDAhPT1hLmNsaXBzVG9Cb3VuZHM/ITA9PT1hLmNsaXBzVG9Cb3VuZHM6ITA7dGhpcy5sPXZvaWQgMCE9PWEuaGFzV2luZG93Rm9jdXM/ITA9PT0KYS5oYXNXaW5kb3dGb2N1czohMDt0aGlzLm5vdFZpc2libGVSZWFzb249YS5ub3RWaXNpYmxlUmVhc29ufHx2b2lkIDA7dGhpcy5ub091dHB1dERldmljZT1hLm5vT3V0cHV0RGV2aWNlfHx2b2lkIDA7dGhpcy5jaGlsZFZpZXdzPWEuY2hpbGRWaWV3c3x8W107dGhpcy5pc0NyZWF0aXZlPWEuaXNDcmVhdGl2ZXx8ITE7dGhpcy5nPWJ9ZnVuY3Rpb24gdmEoYSl7dmFyIGI9e307cmV0dXJuIGIud2lkdGg9YS53aWR0aCxiLmhlaWdodD1hLmhlaWdodCxifWZ1bmN0aW9uIHkoYSl7dmFyIGI9e307cmV0dXJuIE9iamVjdC5hc3NpZ24oe30sdmEoYSksKGIueD1hLngsYi55PWEueSxiKSl9ZnVuY3Rpb24gd2EoYSl7dmFyIGI9eShhKSxjPXt9O3JldHVybiBPYmplY3QuYXNzaWduKHt9LGIsKGMuZW5kWD1hLmVuZFgsYy5lbmRZPWEuZW5kWSxjKSl9ZnVuY3Rpb24geGEoYSxiLGMpe2EueCs9YjthLnkrPWM7YS5lbmRYKz1iO2EuZW5kWSs9Y30KeC5wcm90b3R5cGUuTz1mdW5jdGlvbihhKXtpZihudWxsPT1hKXJldHVybiExO2E9eShhKTt2YXIgYj1hLnksYz1hLndpZHRoLGQ9YS5oZWlnaHQ7cmV0dXJuIHRoaXMueD09PWEueCYmdGhpcy55PT09YiYmdGhpcy53aWR0aD09PWMmJnRoaXMuaGVpZ2h0PT09ZH07ZnVuY3Rpb24geWEoYSl7cmV0dXJuIGEud2lkdGgqYS5oZWlnaHR9ZnVuY3Rpb24gemEoYSl7cmV0dXJuIDA9PT1hLndpZHRofHwwPT09YS5oZWlnaHR9O2Z1bmN0aW9uIEFhKGEsYil7YT15KGEpO2Zvcih2YXIgYz1bXSxkPVtdLGU9MDtlPGIubGVuZ3RoO2UrKyl7dmFyIGY9eShiW2VdKTtmPUJhKGEsZik7Q2EoYyxmLngpO0NhKGMsZi5lbmRYKTtDYShkLGYueSk7Q2EoZCxmLmVuZFkpfWM9Yy5zb3J0KGZ1bmN0aW9uKGwsZyl7cmV0dXJuIGwtZ30pO2Q9ZC5zb3J0KGZ1bmN0aW9uKGwsZyl7cmV0dXJuIGwtZ30pO3JldHVybntpYTpjLGphOmR9fWZ1bmN0aW9uIEJhKGEsYil7cmV0dXJue3g6TWF0aC5tYXgoYS54LGIueCkseTpNYXRoLm1heChhLnksYi55KSxlbmRYOk1hdGgubWluKGEueCthLndpZHRoLGIueCtiLndpZHRoKSxlbmRZOk1hdGgubWluKGEueSthLmhlaWdodCxiLnkrYi5oZWlnaHQpfX1mdW5jdGlvbiBDYShhLGIpey0xPT09YS5pbmRleE9mKGIpJiZhLnB1c2goYil9O2Z1bmN0aW9uIERhKCl7dGhpcy5oPXRoaXMuZz10aGlzLkQ9dGhpcy51PXRoaXMubD10aGlzLnM9dm9pZCAwO3RoaXMuQT0wO3RoaXMubT1bXTt0aGlzLnY9W107dGhpcy5DPTA7dGhpcy5vPVtdO3RoaXMuaj1bXTt0aGlzLmk9W119RGEucHJvdG90eXBlLk89ZnVuY3Rpb24oYSl7cmV0dXJuIG51bGw9PWE/ITE6SlNPTi5zdHJpbmdpZnkoRWEodGhpcykpPT09SlNPTi5zdHJpbmdpZnkoRWEoYSkpfTsKZnVuY3Rpb24gRWEoYSl7dmFyIGI9W10sYz1bXSxkPXt2aWV3cG9ydDphLnMsYWRWaWV3OntwZXJjZW50YWdlSW5WaWV3OmEuQSxwaXhlbHNJblZpZXc6YS5DLHJlYXNvbnM6YS5pfSxkZWNsYXJlZEZyaWVuZGx5T2JzdHJ1Y3Rpb25zOmEubS5sZW5ndGh9O2lmKHZvaWQgMCE9PWEuZyl7ZC5hZFZpZXcuZ2VvbWV0cnk9eShhLmcpO2QuYWRWaWV3Lmdlb21ldHJ5LnBpeGVscz15YShhLmcpO2QuYWRWaWV3Lm9uU2NyZWVuR2VvbWV0cnk9eShhLmgpO2QuYWRWaWV3Lm9uU2NyZWVuR2VvbWV0cnkucGl4ZWxzPUZhKGEpO2Zvcih2YXIgZT0wO2U8YS5qLmxlbmd0aDtlKyspYi5wdXNoKHkoYS5qW2VdKSk7Zm9yKGU9MDtlPGEudi5sZW5ndGg7ZSsrKXt2YXIgZj1hLnZbZV0sbD1mLGc9e307bC5oJiYoZy5vYnN0cnVjdGlvbkNsYXNzPWwuaCk7bC5pJiYoZy5vYnN0cnVjdGlvblB1cnBvc2U9bC5pKTtsLmomJihnLm9ic3RydWN0aW9uUmVhc29uPWwuaik7Zj1CYShhLmcsZik7Yy5wdXNoKE9iamVjdC5hc3NpZ24oe30sCnt4OmYueCx5OmYueSx3aWR0aDpmLmVuZFgtZi54LGhlaWdodDpmLmVuZFktZi55fSxnKSl9ZC5hZFZpZXcub25TY3JlZW5HZW9tZXRyeS5vYnN0cnVjdGlvbnM9YjtkLmFkVmlldy5vblNjcmVlbkdlb21ldHJ5LmZyaWVuZGx5T2JzdHJ1Y3Rpb25zPWM7dm9pZCAwIT09YS51JiZ2b2lkIDAhPT1hLkQmJihkLmFkVmlldy5jb250YWluZXJHZW9tZXRyeT15KGEudSksZC5hZFZpZXcub25TY3JlZW5Db250YWluZXJHZW9tZXRyeT15KGEuRCksZC5hZFZpZXcubWVhc3VyaW5nRWxlbWVudD0hMCl9cmV0dXJuIGR9ZnVuY3Rpb24gR2EoYSxiKXtiPXZhKGIpO2Eucz17fTthLnMud2lkdGg9Yi53aWR0aDthLnMuaGVpZ2h0PWIuaGVpZ2h0O2EubD17fTthLmwueD0wO2EubC55PTA7YS5sLndpZHRoPWIud2lkdGg7YS5sLmhlaWdodD1iLmhlaWdodDthLmwuZW5kWD1iLndpZHRoO2EubC5lbmRZPWIuaGVpZ2h0fQpmdW5jdGlvbiBIYSgpe3JldHVybnt4OjAseTowLGVuZFg6MCxlbmRZOjAsd2lkdGg6MCxoZWlnaHQ6MH19ZnVuY3Rpb24gSWEoYSxiKXt2YXIgYz17fTtjLng9TWF0aC5tYXgoYS54LGIueCk7Yy55PU1hdGgubWF4KGEueSxiLnkpO2MuZW5kWD1NYXRoLm1pbihhLmVuZFgsYi5lbmRYKTtjLmVuZFk9TWF0aC5taW4oYS5lbmRZLGIuZW5kWSk7Yy53aWR0aD1NYXRoLm1heCgwLGMuZW5kWC1jLngpO2MuaGVpZ2h0PU1hdGgubWF4KDAsYy5lbmRZLWMueSk7cmV0dXJuIGN9ZnVuY3Rpb24gSmEoYSxiKXtyZXR1cm4uMDE8Yi53aWR0aC1hLndpZHRofHwuMDE8Yi5oZWlnaHQtYS5oZWlnaHR9ZnVuY3Rpb24gS2EoYSl7aWYoLTEhPT1hLmkuaW5kZXhPZignYmFja2dyb3VuZGVkJykpYS5BPTAsYS5DPTA7ZWxzZXt2YXIgYj15YShhLmcpO2lmKDAhPT1iKXt2YXIgYz1GYShhKTthLkE9TWF0aC5yb3VuZChjL2IqMTAwKTthLkM9Y319fQpmdW5jdGlvbiBMYShhLGIpe2lmKHphKGIpfHwhYS5oKWI9ITE7ZWxzZXt2YXIgYz13YShhLmgpLGQ9Yy55LGU9Yy5lbmRYO2E9Yy5lbmRZO3ZhciBmPWIuZW5kWDtjPWMueDsoZj1mPGN8fC4wMT5NYXRoLmFicyhmLWMpKXx8KGY9Yi54LGY9Zj5lfHwuMDE+TWF0aC5hYnMoZi1lKSk7KGU9Zil8fChlPWIuZW5kWSxlPWU8ZHx8LjAxPk1hdGguYWJzKGUtZCkpOyhkPWUpfHwoYj1iLnksZD1iPmF8fC4wMT5NYXRoLmFicyhiLWEpKTtiPSFkfXJldHVybiBifWZ1bmN0aW9uIHooYSxiKXtmb3IodmFyIGM9ITEsZD0wO2Q8YS5pLmxlbmd0aDtkKyspYS5pW2RdPT09YiYmKGM9ITApO2N8fGEuaS5wdXNoKGIpfQpmdW5jdGlvbiBGYShhKXt2YXIgYj1NYXRoLGM9Yi5tYXgsZD15YShhLmgpLGU9YS5qLGY9MDtpZigwPGUubGVuZ3RoKXt2YXIgbD1BYShhLmgsZSk7YT1sLmlhO2w9bC5qYTtmb3IodmFyIGc9MDtnPGEubGVuZ3RoLTE7ZysrKWZvcih2YXIgaD0oYVtnXSsoYVtnXSsxKSkvMixrPWFbZysxXS1hW2ddLG09MDttPGwubGVuZ3RoLTE7bSsrKXtmb3IodmFyIHQ9KGxbbV0rKGxbbV0rMSkpLzIsRT1sW20rMV0tbFttXSxBPSExLEg9MDtIPGUubGVuZ3RoO0grKyl7dmFyIEk9eShlW0hdKTtpZihJLng8aCYmSS54K0kud2lkdGg+aCYmSS55PHQmJkkueStJLmhlaWdodD50KXtBPSEwO2JyZWFrfX1BJiYoZis9TWF0aC5yb3VuZChrKSpNYXRoLnJvdW5kKEUpKX19cmV0dXJuIGMuY2FsbChiLDAsZC1mKX07ZnVuY3Rpb24gTWEoYSxiLGMsZCxlKXt2YXIgZj1uZXcgRGE7Yj1uZXcgeChiLCExKTtHYShmLGIpO05hKGEsYixmLGQpO2lmKCFlKXJldHVybiBmLmk9Wyd1bm1lYXN1cmFibGUnXSxmLnM9dm9pZCAwLGYuQT0wLGYuaj1bXSxmLmcmJihhPWYuZyxjPXt9LGE9bmV3IHgoKGMueD0wLGMueT0wLGMud2lkdGg9YS53aWR0aCxjLmhlaWdodD1hLmhlaWdodCxjKSxhLmcpLGYuZz1hKSxmLmg9SGEoKSxmO2Iubm9PdXRwdXREZXZpY2UmJih6KGYsJ2JhY2tncm91bmRlZCcpLHooZiwnbm9PdXRwdXREZXZpY2UnKSk7aWYoJ2JhY2tncm91bmRlZCc9PT1jKXooZiwnYmFja2dyb3VuZGVkJyk7ZWxzZSBpZih2b2lkIDAhPT1mLmcpe2ZvcihhPTA7YTxmLm0ubGVuZ3RoO2ErKylMYShmLGYubVthXSkmJmYudi5wdXNoKGYubVthXSk7Zm9yKGE9MDthPGYuby5sZW5ndGg7YSsrKXtpZihjPUxhKGYsZi5vW2FdKSl7YTp7Yz1mLm9bYV07Zm9yKGQ9MDtkPGYuai5sZW5ndGg7ZCsrKWlmKGYualtkXS5PKGMpKXtjPQohMDticmVhayBhfWM9ITF9Yz0hY31jJiYoeihmLCdvYnN0cnVjdGVkJyksZi5qLnB1c2goZi5vW2FdKSl9S2EoZil9ZWxzZSB6KGYsJ25vdEZvdW5kJyk7cmV0dXJuIGZ9CmZ1bmN0aW9uIE5hKGEsYixjLGQpe3ZhciBlPWIuaXNDcmVhdGl2ZT8hMDpiLmFkU2Vzc2lvbklkPT09ZDtpZihlKXtjLmc9Yjt2YXIgZj13YShjLmcpO2E9SWEoYy5sLGYpO3ZhciBsPWMuZzsnbm90QXR0YWNoZWQnPT09bC5ub3RWaXNpYmxlUmVhc29ufHwnbm9XaW5kb3dGb2N1cyc9PT1sLm5vdFZpc2libGVSZWFzb258fCdub0FkVmlldyc9PT1sLm5vdFZpc2libGVSZWFzb24/KHooYywnbm90Rm91bmQnKSxjLmg9bmV3IHgoSGEoKSwhMSkpOihsPWMuZywndmlld0ludmlzaWJsZSc9PT1sLm5vdFZpc2libGVSZWFzb258fCd2aWV3R29uZSc9PT1sLm5vdFZpc2libGVSZWFzb258fCd2aWV3Tm90VmlzaWJsZSc9PT1sLm5vdFZpc2libGVSZWFzb258fCd2aWV3QWxwaGFaZXJvJz09PWwubm90VmlzaWJsZVJlYXNvbnx8J3ZpZXdIaWRkZW4nPT09bC5ub3RWaXNpYmxlUmVhc29ufHx2b2lkIDAhPT1jLmcubm90VmlzaWJsZVJlYXNvbnx8emEoYy5nKT8oeihjLCdoaWRkZW4nKSxjLmg9bmV3IHgoSGEoKSwKITEpKTooYy5nLmx8fCh6KGMsJ2JhY2tncm91bmRlZCcpLHooYywnbm9XaW5kb3dGb2N1cycpKSxKYShhLGYpJiZ6KGMsJ2NsaXBwZWQnKSxjLmg9bmV3IHgoYSwhMSkpKX1lbHNlIGlmKGY9ITAsYi5nJiYoZj0tMSE9PWIuaXNGcmllbmRseU9ic3RydWN0aW9uRm9yLmluZGV4T2YoZCk/ITE6ITE9PT1iLmNsaXBzVG9Cb3VuZHMpLGYpe2w9Yi5jaGlsZFZpZXdzO2Zvcih2YXIgZz0wO2c8bC5sZW5ndGg7ZysrKWY9dm9pZCAwIT09Yy5nLE5hKGEsbmV3IHgobFtnXSxmKSxjLGQpfWV8fHZvaWQgMD09PWMuZ3x8KGIuZz8tMSE9PWIuaXNGcmllbmRseU9ic3RydWN0aW9uRm9yLmluZGV4T2YoZCk/Yy5tLnB1c2goYik6Yy5vLnB1c2goYik6KGU9d2EoYiksZD13YShjLmgpLHkoYy5oKSwhemEoYy5oKSYmYi5jbGlwc1RvQm91bmRzJiYoYj1JYShkLGUpLEphKGIsZCkmJih6KGMsJ2NsaXBwZWQnKSxjLmg9bmV3IHgoYiwhMSkpKSkpfTtmdW5jdGlvbiBPYShhLGIpe3RoaXMueT10aGlzLng9MDt0aGlzLndpZHRoPWE7dGhpcy5oZWlnaHQ9Yn07ZnVuY3Rpb24gUGEoKXtyZXR1cm57YXBpVmVyc2lvbjonMS4wJyxhY2Nlc3NNb2RlOidsaW1pdGVkJyxlbnZpcm9ubWVudDonYXBwJyxvbWlkSnNJbmZvOntvbWlkSW1wbGVtZW50ZXI6J29tc2RrJyxzZXJ2aWNlVmVyc2lvbjonMS40LjUtaWFiNDAxMSd9fX1mdW5jdGlvbiBRYSgpe3RoaXMuYWRTZXNzaW9uSWQ9bnVsbDt0aGlzLmk9UGEoKTt0aGlzLkQ9bnVsbDt0aGlzLkM9J2ZvcmVncm91bmRlZCc7dGhpcy51PXRoaXMubz0nbm9uZSc7dGhpcy5zPXRoaXMubD10aGlzLmo9dGhpcy5tPXRoaXMuaD10aGlzLmc9dGhpcy5KPXRoaXMuSD1udWxsO3RoaXMuST0hMDt0aGlzLkE9bmV3IE1hcDt0aGlzLk09bmV3IE1hcDt0aGlzLk49ITE7dGhpcy52PW51bGx9dmFyIEI7ZnVuY3Rpb24gQygpe0J8fChCPW5ldyBRYSk7cmV0dXJuIEJ9CmZ1bmN0aW9uIFJhKCl7Qi5hZFNlc3Npb25JZD1udWxsO0IuaT1QYSgpO0IuRD1udWxsO0IuTD12b2lkIDA7Qi5BYT12b2lkIDA7Qi5VPW51bGw7Qi5WPW51bGw7Qi5LPW51bGw7Qi5DPSdmb3JlZ3JvdW5kZWQnO0Iubz0nbm9uZSc7Qi51PSdub25lJztCLkg9bnVsbDtCLko9bnVsbDtCLmc9bnVsbDtCLmg9bnVsbDtCLm09bnVsbDtCLmo9bnVsbDtCLmw9bnVsbDtCLnM9bnVsbDtCLkk9ITA7Qi5BPW5ldyBNYXA7Qi5NPW5ldyBNYXA7Qi5OPSExO0Iudj1udWxsfTt2YXIgRD1mdW5jdGlvbigpe2lmKCd1bmRlZmluZWQnIT09dHlwZW9mIG9taWRHbG9iYWwmJm9taWRHbG9iYWwpcmV0dXJuIG9taWRHbG9iYWw7aWYoJ3VuZGVmaW5lZCchPT10eXBlb2YgZ2xvYmFsJiZnbG9iYWwpcmV0dXJuIGdsb2JhbDtpZigndW5kZWZpbmVkJyE9PXR5cGVvZiB3aW5kb3cmJndpbmRvdylyZXR1cm4gd2luZG93O2lmKCd1bmRlZmluZWQnIT09dHlwZW9mIGdsb2JhbFRoaXMmJmdsb2JhbFRoaXMpcmV0dXJuIGdsb2JhbFRoaXM7dmFyIGE9RnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtpZihhKXJldHVybiBhO3Rocm93IEVycm9yKCdDb3VsZCBub3QgZGV0ZXJtaW5lIGdsb2JhbCBvYmplY3QgY29udGV4dC4nKTt9KCk7ZnVuY3Rpb24gU2EoYSxiKXt0aGlzLmc9YTt0aGlzLmg9Yn1lYS5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhTYS5wcm90b3R5cGUse2V2ZW50Ontjb25maWd1cmFibGU6ITAsZW51bWVyYWJsZTohMCxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nfX0sb3JpZ2luOntjb25maWd1cmFibGU6ITAsZW51bWVyYWJsZTohMCxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ofX19KTtmdW5jdGlvbiBHKCl7dmFyIGE9dS5hcHBseSgwLGFyZ3VtZW50cyk7VGEoZnVuY3Rpb24oKXt0aHJvdyBuZXcgKEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmFwcGx5KEVycm9yLFtudWxsLCdDb3VsZCBub3QgY29tcGxldGUgdGhlIHRlc3Qgc3VjY2Vzc2Z1bGx5IC0gJ10uY29uY2F0KHEoYSkpKSk7fSxmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLmVycm9yLmFwcGx5KGNvbnNvbGUscShhKSl9KX1mdW5jdGlvbiBVYSgpe3ZhciBhPXUuYXBwbHkoMCxhcmd1bWVudHMpO1RhKGZ1bmN0aW9uKCl7fSxmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLmVycm9yLmFwcGx5KGNvbnNvbGUscShhKSl9KX1mdW5jdGlvbiBUYShhLGIpeyd1bmRlZmluZWQnIT09dHlwZW9mIGphc21pbmUmJmphc21pbmU/YSgpOid1bmRlZmluZWQnIT09dHlwZW9mIGNvbnNvbGUmJmNvbnNvbGUmJmNvbnNvbGUuZXJyb3ImJmIoKX07ZnVuY3Rpb24gVmEoKXt0aGlzLmo9W107dGhpcy5oPVtdO3RoaXMuaT1bXTt0aGlzLmw9W107dGhpcy5tPXt9O3RoaXMuZz1DKCl9ZnVuY3Rpb24gV2EoYSl7YS5qPVtdO2EuaD1bXTthLmk9W107YS5sPVtdfWZ1bmN0aW9uIFhhKGEsYil7aWYodm9pZCAwIT09YS5nJiZhLmcuYWRTZXNzaW9uSWQmJiExIT09WWEoYSxiKSl7dmFyIGM9Yi5ldmVudDthLmkuZmlsdGVyKGZ1bmN0aW9uKGQpe3JldHVybiBkLnR5cGU9PT1jLnR5cGV9KS5mb3JFYWNoKGZ1bmN0aW9uKGQpe3JldHVybiBKKGEsZCxjKX0pfX1mdW5jdGlvbiBaYShhLGIpe2Euai5wdXNoKGIpO1hhKGEsYil9ZnVuY3Rpb24gJGEoYSxiLGMpe3ZvaWQgMCE9PWEuZyYmYS5nLmFkU2Vzc2lvbklkJiZhLmouZmlsdGVyKGZ1bmN0aW9uKGQpe3JldHVybiBkLmV2ZW50LnR5cGU9PT1iJiZZYShhLGQpfSkubWFwKGZ1bmN0aW9uKGQpe3JldHVybiBkLmV2ZW50fSkuZm9yRWFjaChmdW5jdGlvbihkKXtKKGEsYyxkKX0pfQpmdW5jdGlvbiBZYShhLGIpe3ZhciBjPWIuZXZlbnQudHlwZSxkPS0xIT09T2JqZWN0LnZhbHVlcyh3KS5pbmRleE9mKGMpJiYndm9sdW1lQ2hhbmdlJyE9PWM7cmV0dXJuJ2ltcHJlc3Npb24nPT09Y3x8J2xvYWRlZCc9PT1jJiZhLmcuaD9iLm9yaWdpbj09PUMoKS51OmQ/Yi5vcmlnaW49PT1DKCkubzohMH1WYS5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbihhLGIsYyl7J21lZGlhJz09PWF8fCd2aWRlbyc9PT1hP2FiKHRoaXMsYixjKTooYj17dHlwZTphLFA6YyxSOmJ9LHRoaXMuaS5wdXNoKGIpLCRhKHRoaXMsYSxiKSl9O2Z1bmN0aW9uIGFiKGEsYixjKXtPYmplY3Qua2V5cyh3KS5mb3JFYWNoKGZ1bmN0aW9uKGQpe2Q9d1tkXTt2YXIgZT17dHlwZTpkLFA6YyxSOmJ9O2EuaS5wdXNoKGUpOyRhKGEsZCxlKX0pfQpmdW5jdGlvbiBiYihhLGIsYyxkKXt2YXIgZT17VzpjLFA6ZCxSOmJ9O2EubC5wdXNoKGUpO2EuaC5mb3JFYWNoKGZ1bmN0aW9uKGYpe3ZhciBsPWNiKGYpOydzZXNzaW9uU3RhcnQnPT09Zi5ldmVudC50eXBlJiZkYihhLGwsZSk7SihhLGUsbCl9KX1mdW5jdGlvbiBlYihhLGIsYyl7dmFyIGQ9SyhhLCdzZXNzaW9uRXJyb3InLCduYXRpdmUnLHtlcnJvclR5cGU6YixtZXNzYWdlOmN9KTthLmgucHVzaChkKTthLmwuZm9yRWFjaChmdW5jdGlvbihlKXtKKGEsZSxkLmV2ZW50KX0pfQpmdW5jdGlvbiBmYihhLGIpe2EubT1PYmplY3QuYXNzaWduKGEubSxiKTtiPWEuZy5pO2lmKHZvaWQgMCE9PWIpe2I9T2JqZWN0LmFzc2lnbih7fSxnYihhLGhiKGEsaWIoYSx7Y29udGV4dDpifSksITApKSx7c3VwcG9ydHNMb2FkZWRFdmVudDohIWEuZy5ofHwndmlkZW8nPT1hLmcuZ30pO09iamVjdC5hc3NpZ24oYix7cGFnZVVybDpudWxsLGNvbnRlbnRVcmw6YS5nLkR9KTt2YXIgYz1LKGEsJ3Nlc3Npb25TdGFydCcsJ25hdGl2ZScsYik7YS5oLnB1c2goYyk7YS5sLmZvckVhY2goZnVuY3Rpb24oZCl7dmFyIGU9Y2IoYyk7ZGIoYSxlLGQpO0ooYSxkLGUpfSxhKTtqYihhKX19CmZ1bmN0aW9uIGRiKGEsYixjKXtjLlcmJihiLmRhdGEudmVyaWZpY2F0aW9uUGFyYW1ldGVycz1hLm1bYy5XXSk7Yy5QJiYoYz1hLmcuQS5nZXQoYy5QKSkmJihiLmRhdGEudmVyaWZpY2F0aW9uUGFyYW1ldGVycz1jLnZlcmlmaWNhdGlvblBhcmFtZXRlcnMsYi5kYXRhLmNvbnRleHQuYWNjZXNzTW9kZT1jLmFjY2Vzc01vZGUsJ2Z1bGwnPT09Yy5hY2Nlc3NNb2RlJiYoYS5nLmwmJihiLmRhdGEuY29udGV4dC52aWRlb0VsZW1lbnQ9YS5nLmwpLGEuZy5qJiYoYi5kYXRhLmNvbnRleHQuc2xvdEVsZW1lbnQ9YS5nLmopKSl9ZnVuY3Rpb24ga2IoYSl7dmFyIGI9YS5sLGM9SyhhLCdzZXNzaW9uRmluaXNoJywnbmF0aXZlJyk7YS5oLnB1c2goYyk7dmFyIGQ9YS5nLmk7KGQ9IWR8fCduYXRpdmUnIT09ZC5hZFNlc3Npb25UeXBlKSYmV2EoYSk7Yi5mb3JFYWNoKGZ1bmN0aW9uKGUpe3JldHVybiBKKGEsZSxjLmV2ZW50KX0pO2QmJihhLm09e30sUmEoKSxSYSgpKX0KZnVuY3Rpb24gSihhLGIsYyl7dmFyIGQ9Yi5SO2I9Yi5QOyFifHxhLmcuQS5oYXMoYil8fGEuZy5OP2EubyhkLGMpOkcoJ0xpc3RlbmVyL29ic2VydmVyIG5vdCBjYWxsZWQsIHByb2JhYmx5IGJlY2F1c2UgaXQgd2FzIGFkZGVkIGFmdGVyIGl0cyBpbnRlbmRlZCBhZCBzZXNzaW9uIGhhZCBhbHJlYWR5IGZpbmlzaGVkLicpfVZhLnByb3RvdHlwZS5vPWZ1bmN0aW9uKGEpe3ZhciBiPXUuYXBwbHkoMSxhcmd1bWVudHMpO3RyeXthLmFwcGx5KG51bGwscShiKSl9Y2F0Y2goYyl7VWEoYyl9fTtmdW5jdGlvbiBsYihhLGIpe3ZhciBjPShjPUMoKS5LKT9FYShjKTp2b2lkIDA7Yz1oYihhLGliKGEsYykpO1phKGEsSyhhLCdpbXByZXNzaW9uJyxiLGMpKX1mdW5jdGlvbiBtYihhLGIsYyl7aWYoYS5nLmh8fCdkaXNwbGF5JyE9YS5nLmcpYj1LKGEsJ2xvYWRlZCcsYixoYihhLGliKGEsdm9pZCAwPT09Yz9udWxsOmMpKSksWmEoYSxiKX0KZnVuY3Rpb24gbmIoYSxiLGMsZCl7J3N0YXJ0JyE9PWImJid2b2x1bWVDaGFuZ2UnIT09Ynx8bnVsbCE9KGQmJmQuZGV2aWNlVm9sdW1lKXx8KGQuZGV2aWNlVm9sdW1lPWEuZy5IKTtpZihkJiYoJ3N0YXJ0Jz09PWJ8fCd2b2x1bWVDaGFuZ2UnPT09Yikpe3ZhciBlPWQudmlkZW9QbGF5ZXJWb2x1bWUsZj1kLm1lZGlhUGxheWVyVm9sdW1lO251bGwhPWU/KE9iamVjdC5hc3NpZ24oZCx7bWVkaWFQbGF5ZXJWb2x1bWU6ZX0pLGEuZy5KPWUpOm51bGwhPWYmJihPYmplY3QuYXNzaWduKGQse3ZpZGVvUGxheWVyVm9sdW1lOmZ9KSxhLmcuSj1mKX1aYShhLEsoYSxiLGMsZCkpfQpmdW5jdGlvbiBqYihhKXt2YXIgYj1hLmouZmlsdGVyKGZ1bmN0aW9uKGYpe3JldHVybiBPYmplY3QudmFsdWVzKHcpLmluY2x1ZGVzKGYuZXZlbnQudHlwZSkmJid2aWRlbyc9PWEuZy5nJiZmLm9yaWdpbj09PWEuZy5vfHwnbG9hZGVkJz09Zi5ldmVudC50eXBlJiYnZGlzcGxheSc9PWEuZy5nJiZmLm9yaWdpbj09PWEuZy51PyEwOiExfSkubWFwKGZ1bmN0aW9uKGYpe3JldHVybiBmLmV2ZW50fSksYz1hLmcuYWRTZXNzaW9uSWR8fCcnLGQ9e307Yj1wKGIpO2Zvcih2YXIgZT1iLm5leHQoKTshZS5kb25lO2Q9e0Y6ZC5GfSxlPWIubmV4dCgpKXtkLkY9ZS52YWx1ZTtkLkYuYWRTZXNzaW9uSWR8fChkLkYuYWRTZXNzaW9uSWQ9Yyk7aWYoJ2xvYWRlZCc9PWQuRi50eXBlKXtpZighYS5nLmgmJidkaXNwbGF5Jz09YS5nLmcpY29udGludWU7ZC5GLmRhdGE9aGIoYSxpYihhLGQuRi5kYXRhKSl9YS5pLmZpbHRlcihmdW5jdGlvbihmKXtyZXR1cm4gZnVuY3Rpb24obCl7cmV0dXJuIGwudHlwZT09PQpmLkYudHlwZX19KGQpKS5mb3JFYWNoKGZ1bmN0aW9uKGYpe3JldHVybiBmdW5jdGlvbihsKXtyZXR1cm4gbC5SKGYuRil9fShkKSl9fWZ1bmN0aW9uIG9iKGEsYixjKXthOntjPW5ldyBTZXQoYyk7YT1wKGEuai5jb25jYXQoYS5oKSk7Zm9yKHZhciBkPWEubmV4dCgpOyFkLmRvbmU7ZD1hLm5leHQoKSlpZihkPWQudmFsdWUsYy5oYXMoZC5ldmVudC50eXBlKSYmZC5vcmlnaW4hPWIpe2I9ITA7YnJlYWsgYX1iPSExfXJldHVybiBiPyhHKCdFdmVudCBvd25lciBjYW5ub3QgYmUgcmVnaXN0ZXJlZCBhZnRlciBpdHMgZXZlbnRzIGhhdmUgYWxyZWFkeSBiZWVuIHB1Ymxpc2hlZC4nKSwhMSk6ITB9ZnVuY3Rpb24gcGIoYSxiKXtvYihhLGIsT2JqZWN0LnZhbHVlcyh3KSkmJkwoYSxiKSYmKGEuZy5vPWIpfWZ1bmN0aW9uIHFiKGEsYil7b2IoYSxiLFsnaW1wcmVzc2lvbiddKSYmcmIoYSxiKSYmKGEuZy51PWIpfQpmdW5jdGlvbiByYihhLGIpe3ZhciBjPWEuZy51O3JldHVybidub25lJyE9YyYmYyE9Yj8oRygnSW1wcmVzc2lvbiBldmVudCBpcyBvd25lZCBieSAnKyhhLmcudSsnLCBub3QgJykrKGIrJy4nKSksITEpOiEwfWZ1bmN0aW9uIEwoYSxiKXt2YXIgYz1hLmcubztyZXR1cm4nbm9uZSchPWMmJmMhPWI/KEcoJ01lZGlhIGV2ZW50cyBhcmUgb3duZWQgYnkgJysoYS5nLm8rJywgbm90ICcrYisnLicpKSwhMSk6ITB9ZnVuY3Rpb24gaGIoYSxiLGMpe2M9dm9pZCAwPT09Yz8hMTpjO2I9T2JqZWN0LmFzc2lnbih7fSxiKTthLmcuZyYmT2JqZWN0LmFzc2lnbihiLHttZWRpYVR5cGU6YS5nLmd9KTthLmcuaCYmKGN8fCdkZWZpbmVkQnlKYXZhU2NyaXB0JyE9PWEuZy5oKSYmT2JqZWN0LmFzc2lnbihiLHtjcmVhdGl2ZVR5cGU6YS5nLmh9KTtyZXR1cm4gYn1mdW5jdGlvbiBnYihhLGIpe3JldHVybiBhLmcudj9PYmplY3QuYXNzaWduKGIse2xhc3RBY3Rpdml0eTphLmcudn0pOmJ9CmZ1bmN0aW9uIGliKGEsYil7cmV0dXJuIGEuZy5tP09iamVjdC5hc3NpZ24oe30sYix7aW1wcmVzc2lvblR5cGU6YS5nLm19KTpifWZ1bmN0aW9uIEsoYSxiLGMsZCl7cmV0dXJuIG5ldyBTYSh7YWRTZXNzaW9uSWQ6YS5nLmFkU2Vzc2lvbklkfHwnJyx0aW1lc3RhbXA6KG5ldyBEYXRlKS5nZXRUaW1lKCksdHlwZTpiLGRhdGE6ZH0sYyl9ZnVuY3Rpb24gY2IoYSl7YT1hLmV2ZW50O3ZhciBiPWEuZGF0YT9PYmplY3QuYXNzaWduKHt9LGEuZGF0YSk6dm9pZCAwOydzZXNzaW9uU3RhcnQnPT09YS50eXBlJiYoYi5jb250ZXh0PU9iamVjdC5hc3NpZ24oe30sYi5jb250ZXh0KSk7cmV0dXJue2FkU2Vzc2lvbklkOmEuYWRTZXNzaW9uSWQsdGltZXN0YW1wOmEudGltZXN0YW1wLHR5cGU6YS50eXBlLGRhdGE6Yn19O2Z1bmN0aW9uIHNiKGEsYixjKXsnY29udGFpbmVyJz09PWImJnZvaWQgMCE9PWEuZy5MJiZ2b2lkIDAhPT1hLmcmJm51bGwhPWEuZy5hZFNlc3Npb25JZCYmKGEuZy5VPU1hKGEuaSxhLmcuTCxhLmcuQyxhLmcuYWRTZXNzaW9uSWQsITApKTtiPWEuZzt2YXIgZD1iLlUsZT1iLlY7aWYoZClpZihlKXtiPW5ldyBEYTt2YXIgZj1kLnMsbD1kLmcsZz1kLmgsaD1lLmcsaz1lLmg7ZiYmbCYmZyYmaCYmayYmKEdhKGIsZiksYi51PW5ldyB4KGwsITEpLGIuRD1uZXcgeChnLCExKSxiLm89T2JqZWN0LmFzc2lnbihbXSxkLm8pLGIuaj1PYmplY3QuYXNzaWduKFtdLGQuaiksYi5tPU9iamVjdC5hc3NpZ24oW10sZC5tKSxiLnY9T2JqZWN0LmFzc2lnbihbXSxkLnYpLGIuaT1PYmplY3QuYXNzaWduKFtdLGUuaSxkLmkpLGQ9Yi51LngsZT1iLnUueSxoPW5ldyB4KGgsITEpLGs9bmV3IHgoaywhMSkseGEoaCxkLGUpLHhhKGssZCxlKSxiLmc9aCxiLmg9SWEoayxnKSxLYShiKSl9ZWxzZSBiPWQ7ZWxzZSBiPQpudWxsO2c9YS5nLks7aWYoYiYmIWIuTyhnKXx8YylnPUVhKGIpLGMmJihnLmFkVmlldy5yZWFzb25zPWcuYWRWaWV3LnJlYXNvbnN8fFtjXSksYz1hLmgsJ2F1ZGlvJyE9Yy5nLmgmJlphKGMsSyhjLCdnZW9tZXRyeUNoYW5nZScsJ25hdGl2ZScsZykpLGEuZy5LPWJ9O2Z1bmN0aW9uIE0oYSl7cmV0dXJuJ29iamVjdCc9PT10eXBlb2YgYX1mdW5jdGlvbiBOKGEpe3JldHVybidudW1iZXInPT09dHlwZW9mIGEmJiFpc05hTihhKSYmMDw9YX1mdW5jdGlvbiBPKGEpe3JldHVybidzdHJpbmcnPT09dHlwZW9mIGF9ZnVuY3Rpb24gUChhLGIpe3JldHVybiBPKGEpJiYtMSE9PU9iamVjdC52YWx1ZXMoYikuaW5kZXhPZihhKX1mdW5jdGlvbiB0YihhKXtyZXR1cm4hKCFhfHwhYS50YWdOYW1lfHwnaWZyYW1lJyE9PWEudGFnTmFtZS50b0xvd2VyQ2FzZSgpKX07ZnVuY3Rpb24gUShhLGIsYyl7dGhpcy5qPWE7dGhpcy5OPWI7dGhpcy5LPWM7dGhpcy5pPUMoKTt0aGlzLmg9bnVsbDt0aGlzLmc9dGhpcy5sPXRoaXMuQz12b2lkIDA7dGhpcy5NPSEwO3RoaXMuST12b2lkIDA7Uih0aGlzKX1mdW5jdGlvbiBSKGEpe2lmKCFhLmgpe3ZhciBiO2E6e2lmKChiPWEuai5kb2N1bWVudCkmJmIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSYmKGI9Yi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdvbWlkLWVsZW1lbnQnKSkpe2lmKDE9PWIubGVuZ3RoKXtiPWJbMF07YnJlYWsgYX0xPGIubGVuZ3RoJiZhLk0mJihlYihhLkssJ2dlbmVyaWMnLCJNb3JlIHRoYW4gb25lIGVsZW1lbnQgd2l0aCAnb21pZC1lbGVtZW50JyBjbGFzcyBuYW1lLiIpLGEuTT0hMSl9Yj1udWxsfWlmKGImJmIudGFnTmFtZSYmJ3ZpZGVvJz09PWIudGFnTmFtZS50b0xvd2VyQ2FzZSgpKWEuaS5sPWI7ZWxzZSBpZihiJiZiLnRhZ05hbWUpYS5pLmo9YjtlbHNlIHJldHVybjt1YihhKX19CmZ1bmN0aW9uIHViKGEpe2EuaS5sPyhhLmg9YS5pLmwsYS5vKCkpOmEuaS5qJiYoYS5oPWEuaS5qLHRiKGEuaCk/YS5pLnMmJmEubygpOmEubygpKX1mdW5jdGlvbiB2YihhKXthLmcmJih0YihhLmgpP2EuaS5zJiYoYS5KKCksd2IoYSkpOihhLkooKSx3YihhKSkpfVEucHJvdG90eXBlLkE9ZnVuY3Rpb24oKXt0aGlzLkkmJih0aGlzLmouZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndmlzaWJpbGl0eWNoYW5nZScsdGhpcy5JKSx0aGlzLkk9dm9pZCAwKX07US5wcm90b3R5cGUubz1mdW5jdGlvbigpe307ZnVuY3Rpb24gd2IoYSl7YS5DJiYoYS5pLlY9YS5DLHNiKGEuTiwnY3JlYXRpdmUnKSl9ZnVuY3Rpb24geGIoYSl7aWYoYS5nJiZhLmkucyl7dmFyIGI9bmV3IHgoYS5pLnMsITEpO3hhKGIsYS5nLngsYS5nLnkpO2IuY2xpcHNUb0JvdW5kcz0hMDtyZXR1cm4gYn19O2Z1bmN0aW9uIFMoKXt2YXIgYTt0aGlzLmc9YT12b2lkIDA9PT1hP29taWRHbG9iYWw6YX1TLnByb3RvdHlwZS5zZXRJbnRlcnZhbD1mdW5jdGlvbihhLGIpe3JldHVybiB5Yih0aGlzLCdzZXRJbnRlcnZhbCcpKGEsYil9O1MucHJvdG90eXBlLmNsZWFySW50ZXJ2YWw9ZnVuY3Rpb24oYSl7eWIodGhpcywnY2xlYXJJbnRlcnZhbCcpKGEpfTtTLnByb3RvdHlwZS5zZXRUaW1lb3V0PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHliKHRoaXMsJ3NldFRpbWVvdXQnKShhLGIpfTtTLnByb3RvdHlwZS5jbGVhclRpbWVvdXQ9ZnVuY3Rpb24oYSl7eWIodGhpcywnY2xlYXJUaW1lb3V0JykoYSl9O2Z1bmN0aW9uIHliKGEsYil7cmV0dXJuIGEuZyYmYS5nW2JdP2EuZ1tiXTp6YihhLGIpfQpmdW5jdGlvbiBBYihhLGIsYyxkKXtpZihhLmcuZG9jdW1lbnQmJmEuZy5kb2N1bWVudC5ib2R5KXt2YXIgZT1hLmcuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7ZS53aWR0aD0xO2UuaGVpZ2h0PTE7ZS5zdHlsZS5kaXNwbGF5PSdub25lJztlLnNyYz1iO2MmJmUuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsZnVuY3Rpb24oKXtyZXR1cm4gYygpfSk7ZCYmZS5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsZnVuY3Rpb24oKXtyZXR1cm4gZCgpfSk7YS5nLmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZSl9ZWxzZSB6YihhLCdzZW5kVXJsJykoYixjLGQpfWZ1bmN0aW9uIHpiKGEsYil7aWYoYS5nJiZhLmcub21pZE5hdGl2ZSYmYS5nLm9taWROYXRpdmVbYl0pcmV0dXJuIGEuZy5vbWlkTmF0aXZlW2JdLmJpbmQoYS5nLm9taWROYXRpdmUpO3Rocm93IEVycm9yKCdOYXRpdmUgaW50ZXJmYWNlIG1ldGhvZCAiJytiKyciIG5vdCBmb3VuZC4nKTt9O2Z1bmN0aW9uIFQoYSxiLGMsZCxlKXtRLmNhbGwodGhpcyxhLGMsZSk7dGhpcy51PWI7dGhpcy5tPXZvaWQgMDt0aGlzLnM9ZH1sYShULFEpO1QucHJvdG90eXBlLkE9ZnVuY3Rpb24oKXt2b2lkIDAhPT10aGlzLm0mJih0aGlzLnMuY2xlYXJJbnRlcnZhbCh0aGlzLm0pLHRoaXMubT12b2lkIDApO1EucHJvdG90eXBlLkEuY2FsbCh0aGlzKX07VC5wcm90b3R5cGUubz1mdW5jdGlvbigpe3ZhciBhPXRoaXM7US5wcm90b3R5cGUuby5jYWxsKHRoaXMpO251bGw9PXRoaXMuaD90aGlzLm09dm9pZCAwOnZvaWQgMD09PXRoaXMubSYmKHRoaXMubT10aGlzLnMuc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtyZXR1cm4gQmIoYSl9LDIwMCksQmIodGhpcykpfTsKVC5wcm90b3R5cGUuSj1mdW5jdGlvbigpe2lmKHRoaXMubCl7dmFyIGE9eGIodGhpcyk7aWYoYSl7dGhpcy5nLmlzQ3JlYXRpdmU9ITE7YS5pc0NyZWF0aXZlPSEwO2Zvcih2YXIgYj0hMSxjPTA7Yzx0aGlzLmcuY2hpbGRWaWV3cy5sZW5ndGg7YysrKWlmKHRoaXMuZy5jaGlsZFZpZXdzW2NdLmlzQ3JlYXRpdmUpe3RoaXMuZy5jaGlsZFZpZXdzW2NdPWE7Yj0hMDticmVha31ifHx0aGlzLmcuY2hpbGRWaWV3cy5wdXNoKGEpfWVsc2UgdGhpcy5nLmlzQ3JlYXRpdmU9ITA7dGhpcy5DPU1hKHRoaXMudSx0aGlzLmwsdGhpcy5pLkMsdGhpcy5pLmFkU2Vzc2lvbklkLHRoaXMuSCgpKX19O1QucHJvdG90eXBlLkg9ZnVuY3Rpb24oKXtyZXR1cm4hMH07CmZ1bmN0aW9uIEJiKGEpe2lmKHZvaWQgMCE9PWEubSl7Yjp7dHJ5e3ZhciBiPWEuai50b3A7dmFyIGM9MDw9Yi5pbm5lckhlaWdodCYmMDw9Yi5pbm5lcldpZHRoO2JyZWFrIGJ9Y2F0Y2goZCl7fWM9ITF9Yz8oYz1hLmoudG9wLGM9bmV3IHgobmV3IE9hKGMuaW5uZXJXaWR0aCxjLmlubmVySGVpZ2h0KSwhMSkpOmM9bmV3IHgobmV3IE9hKDAsMCksITEpO2I9YS5oLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO2lmKG51bGw9PWIueHx8aXNOYU4oYi54KSliLng9Yi5sZWZ0O2lmKG51bGw9PWIueXx8aXNOYU4oYi55KSliLnk9Yi50b3A7Yj1uZXcgeChiLCExKTtjLk8oYS5sKSYmYi5PKGEuZyl8fChhLmc9YixhLmcuY2xpcHNUb0JvdW5kcz0hMCxhLmw9YyxhLmwuY2hpbGRWaWV3cy5wdXNoKGEuZyksdmIoYSkpfX07ZnVuY3Rpb24gVShhLGIsYyxkKXtRLmNhbGwodGhpcyxhLGMsZCk7dGhpcy52PXRoaXMucz10aGlzLnU9dGhpcy5tPXZvaWQgMDt0aGlzLkw9ITE7dGhpcy5EPXZvaWQgMH1sYShVLFEpO1UucHJvdG90eXBlLkE9ZnVuY3Rpb24oKXt0aGlzLm0mJnRoaXMubS5kaXNjb25uZWN0KCk7Q2IodGhpcyk7US5wcm90b3R5cGUuQS5jYWxsKHRoaXMpfTtVLnByb3RvdHlwZS5vPWZ1bmN0aW9uKCl7US5wcm90b3R5cGUuby5jYWxsKHRoaXMpO3RoaXMuaCYmKHRoaXMubXx8KHRoaXMubT1EYih0aGlzKSksRWIodGhpcyksRmIodGhpcy5oKSYmR2IodGhpcykpfTsKVS5wcm90b3R5cGUuSj1mdW5jdGlvbigpe2lmKHRoaXMuZyYmdGhpcy5EKXt2YXIgYT14Yih0aGlzKTtpZihhKXt2YXIgYj1hO3ZhciBjPXRoaXMuRDt2YXIgZD1NYXRoLm1heChhLngsYy54KTt2YXIgZT1NYXRoLm1heChhLnksYy55KSxmPU1hdGgubWluKGEuZW5kWCxjLmVuZFgpO2E9TWF0aC5taW4oYS5lbmRZLGMuZW5kWSk7Zjw9ZHx8YTw9ZT9kPW51bGw6KGM9e30sZD1uZXcgeCgoYy54PWQsYy55PWUsYy53aWR0aD1NYXRoLmFicyhmLWQpLGMuaGVpZ2h0PU1hdGguYWJzKGEtZSksYyksITEpKTtkfHwoZD1uZXcgeCh7eDowLHk6MCx3aWR0aDowLGhlaWdodDowfSwhMSkpfWVsc2UgYj10aGlzLmcsZD10aGlzLkQ7ZT1uZXcgRGE7dGhpcy5sJiZHYShlLHRoaXMubCk7ZS5nPWI7ZS5oPWQ7S2EoZSk7dGhpcy5MP3phKGUuZyk/eihlLCdoaWRkZW4nKToxMDA9PT1lLkF8fHooZSwnY2xpcHBlZCcpOnooZSwndmlld3BvcnQnKTt0aGlzLkM9ZX19O1UucHJvdG90eXBlLkg9ZnVuY3Rpb24oKXtyZXR1cm4hMH07CmZ1bmN0aW9uIENiKGEpe2EudSYmKGEudS5kaXNjb25uZWN0KCksYS51PXZvaWQgMCk7YS5zJiYoYS5zLmRpc2Nvbm5lY3QoKSxhLnM9dm9pZCAwKTthLnYmJigoMCxhLmoucmVtb3ZlRXZlbnRMaXN0ZW5lcikoJ3Jlc2l6ZScsYS52KSxhLnY9dm9pZCAwKX1mdW5jdGlvbiBFYihhKXthLm0mJmEuaCYmKGEubS51bm9ic2VydmUoYS5oKSxhLm0ub2JzZXJ2ZShhLmgpKX1mdW5jdGlvbiBGYihhKXthPWEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7cmV0dXJuIDA9PWEud2lkdGh8fDA9PWEuaGVpZ2h0fQpmdW5jdGlvbiBEYihhKXtyZXR1cm4gbmV3IGEuai5JbnRlcnNlY3Rpb25PYnNlcnZlcihmdW5jdGlvbihiKXt0cnl7aWYoYi5sZW5ndGgpe2Zvcih2YXIgYyxkPWJbMF0sZT0xO2U8Yi5sZW5ndGg7ZSsrKWJbZV0udGltZT5kLnRpbWUmJihkPWJbZV0pO2M9ZDthLmw9SGIoYy5yb290Qm91bmRzKTthLmc9SGIoYy5ib3VuZGluZ0NsaWVudFJlY3QpO2EuRD1IYihjLmludGVyc2VjdGlvblJlY3QpO2EuTD0hIWMuaXNJbnRlcnNlY3Rpbmc7dmIoYSl9fWNhdGNoKGYpe2EuQSgpLGViKGEuSywnZ2VuZXJpYycsJ1Byb2JsZW0gaGFuZGxpbmcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIgY2FsbGJhY2s6ICcrZi5tZXNzYWdlKX19LHtyb290Om51bGwscm9vdE1hcmdpbjonMHB4Jyx0aHJlc2hvbGQ6WzAsLjEsLjIsLjMsLjQsLjUsLjYsLjcsLjgsLjksMV19KX0KZnVuY3Rpb24gR2IoYSl7YS5qLlJlc2l6ZU9ic2VydmVyP2EudXx8KGEudT1JYihhLGZ1bmN0aW9uKCl7cmV0dXJuIEpiKGEpfSksYS51Lm9ic2VydmUoYS5oKSk6KGEudnx8KGEudj1mdW5jdGlvbigpe3JldHVybiBKYihhKX0sKDAsYS5qLmFkZEV2ZW50TGlzdGVuZXIpKCdyZXNpemUnLGEudikpLGEuc3x8KGEucz1uZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbigpe3JldHVybiBKYihhKX0pLGEucy5vYnNlcnZlKGEuaCx7Y2hpbGRMaXN0OiExLGF0dHJpYnV0ZXM6ITAsc3VidHJlZTohMX0pKSl9ZnVuY3Rpb24gSmIoYSl7YS5oJiYhRmIoYS5oKSYmKEViKGEpLENiKGEpKX1mdW5jdGlvbiBJYihhLGIpe3JldHVybiBuZXcgYS5qLlJlc2l6ZU9ic2VydmVyKGIpfWZ1bmN0aW9uIEhiKGEpe2lmKGEmJm51bGwhPT1hLngmJm51bGwhPT1hLnkmJm51bGwhPT1hLndpZHRoJiZudWxsIT09YS5oZWlnaHQpcmV0dXJuIG5ldyB4KGEsITEpfTtmdW5jdGlvbiBLYihhKXtyZXR1cm4gYSYmTShhKT9PYmplY3QuZW50cmllcyhhKS5yZWR1Y2UoZnVuY3Rpb24oYixjKXt2YXIgZD1wKGMpO2M9ZC5uZXh0KCkudmFsdWU7ZD1kLm5leHQoKS52YWx1ZTtyZXR1cm4gYiYmTyhjKSYmbnVsbCE9ZCYmTShkKSYmTyhkLnJlc291cmNlVXJsKX0sITApOiExfTtmdW5jdGlvbiBWKGEsYixjLGQpe3RoaXMuaD1hO3RoaXMubWV0aG9kPWI7dGhpcy52ZXJzaW9uPWM7dGhpcy5nPWR9ZnVuY3Rpb24gTGIoYSl7cmV0dXJuISFhJiZ2b2lkIDAhPT1hLm9taWRfbWVzc2FnZV9ndWlkJiZ2b2lkIDAhPT1hLm9taWRfbWVzc2FnZV9tZXRob2QmJnZvaWQgMCE9PWEub21pZF9tZXNzYWdlX3ZlcnNpb24mJidzdHJpbmcnPT09dHlwZW9mIGEub21pZF9tZXNzYWdlX2d1aWQmJidzdHJpbmcnPT09dHlwZW9mIGEub21pZF9tZXNzYWdlX21ldGhvZCYmJ3N0cmluZyc9PT10eXBlb2YgYS5vbWlkX21lc3NhZ2VfdmVyc2lvbiYmKHZvaWQgMD09PWEub21pZF9tZXNzYWdlX2FyZ3N8fHZvaWQgMCE9PWEub21pZF9tZXNzYWdlX2FyZ3MpfWZ1bmN0aW9uIE1iKGEpe3JldHVybiBuZXcgVihhLm9taWRfbWVzc2FnZV9ndWlkLGEub21pZF9tZXNzYWdlX21ldGhvZCxhLm9taWRfbWVzc2FnZV92ZXJzaW9uLGEub21pZF9tZXNzYWdlX2FyZ3MpfQpmdW5jdGlvbiBPYihhKXt2YXIgYj17fTtiPShiLm9taWRfbWVzc2FnZV9ndWlkPWEuaCxiLm9taWRfbWVzc2FnZV9tZXRob2Q9YS5tZXRob2QsYi5vbWlkX21lc3NhZ2VfdmVyc2lvbj1hLnZlcnNpb24sYik7dm9pZCAwIT09YS5nJiYoYi5vbWlkX21lc3NhZ2VfYXJncz1hLmcpO3JldHVybiBifTtmdW5jdGlvbiBQYihhKXt0aGlzLmk9YX07ZnVuY3Rpb24gVyhhKXt0aGlzLmk9YTt0aGlzLmhhbmRsZUV4cG9ydGVkTWVzc2FnZT1XLnByb3RvdHlwZS5qLmJpbmQodGhpcyl9bGEoVyxQYik7Vy5wcm90b3R5cGUuaD1mdW5jdGlvbihhLGIpe2I9dm9pZCAwPT09Yj90aGlzLmk6YjtpZighYil0aHJvdyBFcnJvcignTWVzc2FnZSBkZXN0aW5hdGlvbiBtdXN0IGJlIGRlZmluZWQgYXQgY29uc3RydWN0aW9uIHRpbWUgb3Igd2hlbiBzZW5kaW5nIHRoZSBtZXNzYWdlLicpO2IuaGFuZGxlRXhwb3J0ZWRNZXNzYWdlKE9iKGEpLHRoaXMpfTtXLnByb3RvdHlwZS5qPWZ1bmN0aW9uKGEsYil7TGIoYSkmJnRoaXMuZyYmdGhpcy5nKE1iKGEpLGIpfTtmdW5jdGlvbiBRYihhKXtyZXR1cm4gUmIoYSwnU2Vzc2lvblNlcnZpY2UuJyl9ZnVuY3Rpb24gUmIoYSxiKXtyZXR1cm4oYT1hLm1hdGNoKG5ldyBSZWdFeHAoJ14nK2IrJyguKiknKSkpJiZhWzFdfTtmdW5jdGlvbiBTYihhLGIpe3RoaXMuaT1iPXZvaWQgMD09PWI/RDpiO3ZhciBjPXRoaXM7YS5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJyxmdW5jdGlvbihkKXtpZignb2JqZWN0Jz09PXR5cGVvZiBkLmRhdGEpe3ZhciBlPWQuZGF0YTtMYihlKSYmZC5zb3VyY2UmJmMuZyYmYy5nKE1iKGUpLGQuc291cmNlKX19KX1sYShTYixQYik7U2IucHJvdG90eXBlLmg9ZnVuY3Rpb24oYSxiKXtiPXZvaWQgMD09PWI/dGhpcy5pOmI7aWYoIWIpdGhyb3cgRXJyb3IoJ01lc3NhZ2UgZGVzdGluYXRpb24gbXVzdCBiZSBkZWZpbmVkIGF0IGNvbnN0cnVjdGlvbiB0aW1lIG9yIHdoZW4gc2VuZGluZyB0aGUgbWVzc2FnZS4nKTtiLnBvc3RNZXNzYWdlKE9iKGEpLCcqJyl9O2Z1bmN0aW9uIFRiKCl7cmV0dXJuJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLGZ1bmN0aW9uKGEpe3ZhciBiPTE2Kk1hdGgucmFuZG9tKCl8MDtyZXR1cm4neSc9PT1hPyhiJjN8OCkudG9TdHJpbmcoMTYpOmIudG9TdHJpbmcoMTYpfSl9O2Z1bmN0aW9uIFViKGEpe2lmKCFhLmd8fCFhLmcuZG9jdW1lbnQpdGhyb3cgRXJyb3IoJ09NSUQgU2VydmljZSBTY3JpcHQgaXMgbm90IHJ1bm5pbmcgd2l0aGluIGEgd2luZG93LicpO3ZhciBiPWEuaDthLmg9W107Yi5mb3JFYWNoKGZ1bmN0aW9uKGMpe3RyeXt2YXIgZD1hLmkuST8nbGltaXRlZCc6J2Z1bGwnLGU9UChjLmFjY2Vzc01vZGUsc2EpP2MuYWNjZXNzTW9kZTpudWxsO3ZhciBmPWU/J2Z1bGwnPT1lJiYnbGltaXRlZCc9PWQ/ZDonZG9tYWluJz09ZT8nbGltaXRlZCc6ZTpkO2MuYWNjZXNzTW9kZT1mO2E6e3ZhciBsPWMucmVzb3VyY2VVcmwsZz1hLmcubG9jYXRpb24ub3JpZ2luO3RyeXt2YXIgaD1uZXcgVVJMKGwsZyk7YnJlYWsgYX1jYXRjaChIKXt9dHJ5e2g9bmV3IFVSTChsKTticmVhayBhfWNhdGNoKEgpe31oPW51bGx9aWYoZD1oKXt2YXIgaz1UYigpLG09YS5nLmRvY3VtZW50LHQ9bS5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTt0LmlkPSdvbWlkLXZlcmlmaWNhdGlvbi1zY3JpcHQtZnJhbWUtJysKazt0LnN0eWxlLmRpc3BsYXk9J25vbmUnO1snZnVsbCcsJ2xpbWl0ZWQnXS5pbmNsdWRlcyhmKT90LnNyY2RvYz0iPGh0bWw+PGhlYWQ+XG48c2NyaXB0IHR5cGU9XCJ0ZXh0L2phdmFzY3JpcHRcIj53aW5kb3dbJ29taWRWZXJpZmljYXRpb25Qcm9wZXJ0aWVzJ10gPSB7XG4nc2VydmljZVdpbmRvdyc6IHdpbmRvdy5wYXJlbnQsXG4naW5qZWN0aW9uU291cmNlJzogJ2FwcCcsXG4naW5qZWN0aW9uSWQnOiAnIisoaysnXCcsXG59O1x4M2Mvc2NyaXB0PlxuPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iJykrZC5ocmVmKyciPlx4M2Mvc2NyaXB0PlxuPC9oZWFkPjxib2R5PjwvYm9keT48L2h0bWw+JzonZG9tYWluJz09ZiYmKHQuc3JjPVZiKGEsayxkKS5ocmVmKTtbJ2RvbWFpbicsJ2xpbWl0ZWQnXS5pbmNsdWRlcyhmKSYmKHQuc2FuZGJveD0nYWxsb3ctc2NyaXB0cycpO20uYm9keS5hcHBlbmRDaGlsZCh0KTthLmkuTS5zZXQoayx0KTt2YXIgRT1jLnZlbmRvcktleSwKQT1jLnZlcmlmaWNhdGlvblBhcmFtZXRlcnM7RT12b2lkIDA9PT1FPycnOkU7QT12b2lkIDA9PT1BPycnOkE7RSYmJ3N0cmluZyc9PT10eXBlb2YgRSYmJychPT1FJiZBJiYnc3RyaW5nJz09PXR5cGVvZiBBJiYnJyE9PUEmJihhLmoubVtFXT1BKTthLmkuQS5zZXQoayxjKX19Y2F0Y2goSCl7VWEoJ09NSUQgdmVyaWZpY2F0aW9uIHNjcmlwdCAnK2MucmVzb3VyY2VVcmwrJyBmYWlsZWQgdG8gbG9hZDogJytIKX19KX0KZnVuY3Rpb24gVmIoYSxiLGMpe3ZhciBkPScvLndlbGwta25vd24vb21pZC9vbWxvYWRlci12MS5odG1sIyc7KG5ldyBNYXAoW1sndmVyaWZpY2F0aW9uU2NyaXB0VXJsJyxjLmhyZWZdLFsnaW5qZWN0aW9uSWQnLGJdXSkpLmZvckVhY2goZnVuY3Rpb24oZSxmKXtkKz1lbmNvZGVVUklDb21wb25lbnQoZikrJz0nK2VuY29kZVVSSUNvbXBvbmVudChlKSsnJid9KTtiPW51bGw7dHJ5e2I9bmV3IFVSTChkLGEuZy5wYXJlbnQubG9jYXRpb24ub3JpZ2luKX1jYXRjaChlKXt0aHJvdyBFcnJvcignT01JRCBTZXJ2aWNlIFNjcmlwdCBjYW5ub3QgYWNjZXNzIHRoZSBwYXJlbnQgd2luZG93LicpO31yZXR1cm4gYn07ZnVuY3Rpb24gV2IoKXt2YXIgYT1YYixiPVliLGM9dGhpczt0aGlzLmk9WDt0aGlzLmg9YTt0aGlzLmc9QygpO3RoaXMubD1iO3RoaXMuaj0hMTt0aGlzLnJlZ2lzdGVyU2Vzc2lvbk9ic2VydmVyKGZ1bmN0aW9uKGQpe3JldHVybiBaYihjLGQpfSl9bj1XYi5wcm90b3R5cGU7bi5yZWdpc3RlclNlc3Npb25PYnNlcnZlcj1mdW5jdGlvbihhKXtiYih0aGlzLmksYSl9O24uc2V0U2xvdEVsZW1lbnQ9ZnVuY3Rpb24oYSl7YSYmYS50YWdOYW1lPyh0aGlzLmcuaj1hLHRoaXMuaCYmdWIodGhpcy5oKSk6Rygnc2V0U2xvdEVsZW1lbnQgY2FsbGVkIHdpdGggYSBub24tSFRNTEVsZW1lbnQuICBJdCB3aWxsIGJlIGlnbm9yZWQuJyl9O24uc2V0RWxlbWVudEJvdW5kcz1mdW5jdGlvbihhKXt0aGlzLmcucz1hO3RoaXMuaCYmdWIodGhpcy5oKTt0aGlzLmgmJnZiKHRoaXMuaCl9O24uZXJyb3I9ZnVuY3Rpb24oYSxiKXtlYih0aGlzLmksYSxiKX07Cm4ucmVnaXN0ZXJBZEV2ZW50cz1mdW5jdGlvbigpe3FiKHRoaXMuaSwnamF2YXNjcmlwdCcpfTtuLnJlZ2lzdGVyTWVkaWFFdmVudHM9ZnVuY3Rpb24oKXtwYih0aGlzLmksJ2phdmFzY3JpcHQnKX07ZnVuY3Rpb24gWShhLGIsYyl7J2ltcHJlc3Npb24nPT1iP3JiKGEuaSwnamF2YXNjcmlwdCcpJiYobGIoYS5pLCdqYXZhc2NyaXB0JyksYS5oJiZSKGEuaCkpOignbG9hZGVkJz09Yj8oYz12b2lkIDA9PT1jP251bGw6YyxMKGEuaSwnamF2YXNjcmlwdCcpJiZtYihhLmksJ2phdmFzY3JpcHQnLGMpKTpMKGEuaSwnamF2YXNjcmlwdCcpJiZuYihhLmksYiwnamF2YXNjcmlwdCcsYyksWydsb2FkZWQnLCdzdGFydCddLmluY2x1ZGVzKGIpJiZhLmgmJlIoYS5oKSl9bi5pbmplY3RWZXJpZmljYXRpb25TY3JpcHRSZXNvdXJjZXM9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5sO2IuaC5wdXNoLmFwcGx5KGIuaCxxKGEpKTtpZih0aGlzLmopdHJ5e1ViKHRoaXMubCl9Y2F0Y2goYyl7RyhjLm1lc3NhZ2UpfX07Cm4uc2V0Q3JlYXRpdmVUeXBlPWZ1bmN0aW9uKGEsYil7Yj12b2lkIDA9PT1iP251bGw6YjtpZighdGhpcy5nLmd8fHRoaXMuZy5oKXRoaXMuZy5oPWEsJ3ZpZGVvJz09YXx8J2F1ZGlvJz09YT90aGlzLmcuZz0ndmlkZW8nOidodG1sRGlzcGxheSc9PWF8fCduYXRpdmVEaXNwbGF5Jz09YT90aGlzLmcuZz0nZGlzcGxheSc6J2RlZmluZWRCeUphdmFTY3JpcHQnPT1hJiZiJiYodGhpcy5nLmc9J25vbmUnPT1iPydkaXNwbGF5JzondmlkZW8nKX07bi5zZXRJbXByZXNzaW9uVHlwZT1mdW5jdGlvbihhKXtpZighdGhpcy5nLmd8fHRoaXMuZy5oKXRoaXMuZy5tPWF9OwpmdW5jdGlvbiBaYihhLGIpe2lmKCdzZXNzaW9uU3RhcnQnPT09Yi50eXBlKXthLmo9ITA7dHJ5e1ViKGEubCl9Y2F0Y2goYyl7RyhjLm1lc3NhZ2UpfX0nc2Vzc2lvbkZpbmlzaCc9PT1iLnR5cGUmJihhLmo9ITEsKGI9QygpLmkpJiYnbmF0aXZlJz09Yi5hZFNlc3Npb25UeXBlfHxhLnJlZ2lzdGVyU2Vzc2lvbk9ic2VydmVyKGZ1bmN0aW9uKGMpe3JldHVybiBaYihhLGMpfSkpfW4uc2V0Q2xpZW50SW5mbz1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcy5nLml8fHt9O2Qub21pZEpzSW5mbz1PYmplY3QuYXNzaWduKHt9LGQub21pZEpzSW5mbyx7c2Vzc2lvbkNsaWVudFZlcnNpb246YSxwYXJ0bmVyTmFtZTpiLHBhcnRuZXJWZXJzaW9uOmN9KTt0aGlzLmcuaT1kO3JldHVybiB0aGlzLmcuaS5vbWlkSnNJbmZvLnNlcnZpY2VWZXJzaW9ufTtmdW5jdGlvbiAkYihhKXthPWEuc3BsaXQoJy0nKVswXS5zcGxpdCgnLicpO2Zvcih2YXIgYj1bJzEnLCcwJywnMyddLGM9MDszPmM7YysrKXt2YXIgZD1wYXJzZUludChhW2NdLDEwKSxlPXBhcnNlSW50KGJbY10sMTApO2lmKGQ+ZSlicmVhaztlbHNlIGlmKGQ8ZSlyZXR1cm4hMX1yZXR1cm4hMH07ZnVuY3Rpb24gYWMoYSxiKXtyZXR1cm4vXGQrXC5cZCtcLlxkKygtLiopPy8udGVzdChhKSYmJGIoYSk/YjpKU09OLnN0cmluZ2lmeShiKX1mdW5jdGlvbiBiYyhhLGIpe3JldHVybi9cZCtcLlxkK1wuXGQrKC0uKik/Ly50ZXN0KGEpJiYkYihhKT9iP2I6W106YiYmJ3N0cmluZyc9PT10eXBlb2YgYj9KU09OLnBhcnNlKGIpOltdfTt2YXIgY2M9bmV3IGZ1bmN0aW9uKCl7fTtmdW5jdGlvbiBkYygpe3ZhciBhPWVjO3ZhciBiPXZvaWQgMD09PWI/b21pZEdsb2JhbDpiO3RoaXMuZz1hO3RoaXMuaT1iO3RoaXMuaj1uZXcgVzt0aGlzLmkub21pZD10aGlzLmkub21pZHx8e307dGhpcy5pLm9taWQudjFfU2Vzc2lvblNlcnZpY2VDb21tdW5pY2F0aW9uPXRoaXMuajt0aGlzLmg9YiYmYi5hZGRFdmVudExpc3RlbmVyJiZiLnBvc3RNZXNzYWdlP25ldyBTYihiKTpudWxsO3RoaXMubD1udWxsO3RoaXMuai5nPXRoaXMubS5iaW5kKHRoaXMpO3RoaXMuaCYmKHRoaXMuaC5nPXRoaXMuby5iaW5kKHRoaXMpKX1kYy5wcm90b3R5cGUubT1mdW5jdGlvbihhLGIpe251bGwhPVFiKGEubWV0aG9kKSYmZmModGhpcyxjYykmJmdjKHRoaXMsYSxiLHRoaXMuail9O2RjLnByb3RvdHlwZS5vPWZ1bmN0aW9uKGEsYil7bnVsbCE9UWIoYS5tZXRob2QpJiZmYyh0aGlzLGIpJiZnYyh0aGlzLGEsYix0aGlzLmgpfTsKZnVuY3Rpb24gZmMoYSxiKXthLmx8fChhLmw9Yik7cmV0dXJuIGEubCE9Yj8oRygnVGhlIHNvdXJjZSBvZiBzZXNzaW9uIGNsaWVudCBtZXNzYWdlcyBjYW5ub3QgYmUgY2hhbmdlZCBmcm9tIHRoZSBzb3VyY2Ugb2YgdGhlIGZpcnN0IG1lc3NhZ2UuJyksITEpOiEwfQpmdW5jdGlvbiBnYyhhLGIsYyxkKXtmdW5jdGlvbiBlKCl7dmFyIGg9bmV3IFYoZiwncmVzcG9uc2UnLGcsYWMoZyx1LmFwcGx5KDAsYXJndW1lbnRzKSkpO2QuaChoLGMpfXZhciBmPWIuaCxsPWIubWV0aG9kLGc9Yi52ZXJzaW9uO2I9YmMoZyxiLmcpO3RyeXtoYyhhLGwsZSxiKX1jYXRjaChoKXtkLmgobmV3IFYoZiwnZXJyb3InLGcsJ1xuICAgICAgICBuYW1lOiAnK2gubmFtZSsnXG4gICAgICAgIG1lc3NhZ2U6ICcraC5tZXNzYWdlKydcbiAgICAgICAgZmlsZW5hbWU6ICcraC5maWxlbmFtZSsnXG4gICAgICAgIGxpbmVOdW1iZXI6ICcraC5saW5lTnVtYmVyKydcbiAgICAgICAgY29sdW1uTnVtYmVyOiAnK2guY29sdW1uTnVtYmVyKydcbiAgICAgICAgc3RhY2s6ICcraC5zdGFjaysnXG4gICAgICAgIHRvU3RyaW5nKCk6ICcraC50b1N0cmluZygpKSxjKX19CmZ1bmN0aW9uIGhjKGEsYixjLGQpe2lmKG51bGwhPVFiKGIpKXN3aXRjaChRYihiKSl7Y2FzZSAncmVnaXN0ZXJBZEV2ZW50cyc6YS5nLnJlZ2lzdGVyQWRFdmVudHMoKTticmVhaztjYXNlICdyZWdpc3Rlck1lZGlhRXZlbnRzJzphLmcucmVnaXN0ZXJNZWRpYUV2ZW50cygpO2JyZWFrO2Nhc2UgJ3JlZ2lzdGVyU2Vzc2lvbk9ic2VydmVyJzphLmcucmVnaXN0ZXJTZXNzaW9uT2JzZXJ2ZXIoYyk7YnJlYWs7Y2FzZSAnc2V0U2xvdEVsZW1lbnQnOmM9cChkKS5uZXh0KCkudmFsdWU7YS5nLnNldFNsb3RFbGVtZW50KGMpO2JyZWFrO2Nhc2UgJ3NldFZpZGVvRWxlbWVudCc6Yz1wKGQpLm5leHQoKS52YWx1ZTthPWEuZztjJiZjLnRhZ05hbWUmJid2aWRlbyc9PT1jLnRhZ05hbWUudG9Mb3dlckNhc2UoKT8oYS5nLmw9YyxhLmgmJnViKGEuaCkpOkcoJ3NldFZpZGVvRWxlbWVudCBjYWxsZWQgd2l0aCBhIG5vbi1IVE1MVmlkZW9FbGVtZW50LiBJdCB3aWxsIGJlIGlnbm9yZWQuJyk7YnJlYWs7CmNhc2UgJ3NldEVsZW1lbnRCb3VuZHMnOmM9cChkKS5uZXh0KCkudmFsdWU7YS5nLnNldEVsZW1lbnRCb3VuZHMoYyk7YnJlYWs7Y2FzZSAnc3RhcnRTZXNzaW9uJzpHKCdTZXNzaW9uIHN0YXJ0IGZyb20gSlMgaXMgbm90IHN1cHBvcnRlZCBpbiBtb2JpbGUgYXBwLicpO2JyZWFrO2Nhc2UgJ2ZpbmlzaFNlc3Npb24nOkcoJ1Nlc3Npb24gZmluaXNoIGZyb20gSlMgaXMgbm90IHN1cHBvcnRlZCBpbiBtb2JpbGUgYXBwLicpO2JyZWFrO2Nhc2UgJ2ltcHJlc3Npb25PY2N1cnJlZCc6WShhLmcsJ2ltcHJlc3Npb24nKTticmVhaztjYXNlICdsb2FkZWQnOihjPXAoZCkubmV4dCgpLnZhbHVlKT8oYj17c2tpcHBhYmxlOmMuaXNTa2lwcGFibGUsYXV0b1BsYXk6Yy5pc0F1dG9QbGF5LHBvc2l0aW9uOmMucG9zaXRpb259LGMuaXNTa2lwcGFibGUmJihiLnNraXBPZmZzZXQ9Yy5za2lwT2Zmc2V0KSxZKGEuZywnbG9hZGVkJyxiKSk6WShhLmcsJ2xvYWRlZCcpO2JyZWFrO2Nhc2UgJ3N0YXJ0JzpiPQpwKGQpO2M9Yi5uZXh0KCkudmFsdWU7Yj1iLm5leHQoKS52YWx1ZTtZKGEuZywnc3RhcnQnLHtkdXJhdGlvbjpjLG1lZGlhUGxheWVyVm9sdW1lOmJ9KTticmVhaztjYXNlICdmaXJzdFF1YXJ0aWxlJzpZKGEuZywnZmlyc3RRdWFydGlsZScpO2JyZWFrO2Nhc2UgJ21pZHBvaW50JzpZKGEuZywnbWlkcG9pbnQnKTticmVhaztjYXNlICd0aGlyZFF1YXJ0aWxlJzpZKGEuZywndGhpcmRRdWFydGlsZScpO2JyZWFrO2Nhc2UgJ2NvbXBsZXRlJzpZKGEuZywnY29tcGxldGUnKTticmVhaztjYXNlICdwYXVzZSc6WShhLmcsJ3BhdXNlJyk7YnJlYWs7Y2FzZSAncmVzdW1lJzpZKGEuZywncmVzdW1lJyk7YnJlYWs7Y2FzZSAnYnVmZmVyU3RhcnQnOlkoYS5nLCdidWZmZXJTdGFydCcpO2JyZWFrO2Nhc2UgJ2J1ZmZlckZpbmlzaCc6WShhLmcsJ2J1ZmZlckZpbmlzaCcpO2JyZWFrO2Nhc2UgJ3NraXBwZWQnOlkoYS5nLCdza2lwcGVkJyk7YnJlYWs7Y2FzZSAndm9sdW1lQ2hhbmdlJzpjPXttZWRpYVBsYXllclZvbHVtZTpwKGQpLm5leHQoKS52YWx1ZX07ClkoYS5nLCd2b2x1bWVDaGFuZ2UnLGMpO2JyZWFrO2Nhc2UgJ3BsYXllclN0YXRlQ2hhbmdlJzpjPXtzdGF0ZTpwKGQpLm5leHQoKS52YWx1ZX07WShhLmcsJ3BsYXllclN0YXRlQ2hhbmdlJyxjKTticmVhaztjYXNlICdhZFVzZXJJbnRlcmFjdGlvbic6Yz17aW50ZXJhY3Rpb25UeXBlOnAoZCkubmV4dCgpLnZhbHVlfTtZKGEuZywnYWRVc2VySW50ZXJhY3Rpb24nLGMpO2JyZWFrO2Nhc2UgJ3NldENsaWVudEluZm8nOnZhciBlPXAoZCk7Yj1lLm5leHQoKS52YWx1ZTtkPWUubmV4dCgpLnZhbHVlO2U9ZS5uZXh0KCkudmFsdWU7YT1hLmcuc2V0Q2xpZW50SW5mbyhiLGQsZSk7YyhhKTticmVhaztjYXNlICdpbmplY3RWZXJpZmljYXRpb25TY3JpcHRSZXNvdXJjZXMnOmM9cChkKS5uZXh0KCkudmFsdWU7YS5nLmluamVjdFZlcmlmaWNhdGlvblNjcmlwdFJlc291cmNlcyhjKTticmVhaztjYXNlICdzZXRDcmVhdGl2ZVR5cGUnOmM9cChkKS5uZXh0KCkudmFsdWU7YS5nLnNldENyZWF0aXZlVHlwZShjKTsKYnJlYWs7Y2FzZSAnc2V0SW1wcmVzc2lvblR5cGUnOmM9cChkKS5uZXh0KCkudmFsdWU7YS5nLnNldEltcHJlc3Npb25UeXBlKGMpO2JyZWFrO2Nhc2UgJ3NldENvbnRlbnRVcmwnOmM9cChkKS5uZXh0KCkudmFsdWU7YS5nLmcuRD1jO2JyZWFrO2Nhc2UgJ3Nlc3Npb25FcnJvcic6Yj1wKGQpLGM9Yi5uZXh0KCkudmFsdWUsYj1iLm5leHQoKS52YWx1ZSxhLmcuZXJyb3IoYyxiKX19O2Z1bmN0aW9uIFooKXt2YXIgYT1YLGI9aWMsYz1qYyxkPVhiO3RoaXMuaj1lYzt0aGlzLmg9YTt0aGlzLmk9Yjt0aGlzLm09Yzt0aGlzLmw9ZDt0aGlzLmc9QygpfW49Wi5wcm90b3R5cGU7Cm4uYmE9ZnVuY3Rpb24oYSl7aWYoISghKGEmJk0oYSkmJlAoYS5pbXByZXNzaW9uT3duZXIscmEpKXx8J3ZpZGVvRXZlbnRzT3duZXInaW4gYSYmbnVsbCE9YS52aWRlb0V2ZW50c093bmVyJiYhUChhLnZpZGVvRXZlbnRzT3duZXIscmEpfHwnbWVkaWFFdmVudHNPd25lcidpbiBhJiZudWxsIT1hLm1lZGlhRXZlbnRzT3duZXImJiFQKGEubWVkaWFFdmVudHNPd25lcixyYSkpKXtpZihhLmNyZWF0aXZlVHlwZSYmYS5pbXByZXNzaW9uVHlwZSl7dmFyIGI9YS5tZWRpYUV2ZW50c093bmVyO251bGw9PXRoaXMuZy5oJiZ0aGlzLmouc2V0Q3JlYXRpdmVUeXBlKGEuY3JlYXRpdmVUeXBlLGIpO251bGw9PXRoaXMuZy5tJiYodGhpcy5nLm09YS5pbXByZXNzaW9uVHlwZSk7cGIodGhpcy5oLGIpfWVsc2UgYj1hLnZpZGVvRXZlbnRzT3duZXIsdGhpcy5nLmc9bnVsbD09Ynx8J25vbmUnPT09Yj8nZGlzcGxheSc6J3ZpZGVvJyx0aGlzLmcuaD1udWxsLHRoaXMuZy5tPW51bGwscGIodGhpcy5oLApiKTtxYih0aGlzLmgsYS5pbXByZXNzaW9uT3duZXIpO2EmJm51bGwhPWEuaXNvbGF0ZVZlcmlmaWNhdGlvblNjcmlwdHMmJidib29sZWFuJz09PXR5cGVvZiBhLmlzb2xhdGVWZXJpZmljYXRpb25TY3JpcHRzJiYodGhpcy5nLkk9YS5pc29sYXRlVmVyaWZpY2F0aW9uU2NyaXB0cyl9fTsKbi4kPWZ1bmN0aW9uKGEsYixjLGQpe2ImJidzdHJpbmcnPT09dHlwZW9mIGIuYWRTZXNzaW9uVHlwZSYmKGIuYWRTZXNzaW9uVHlwZT1iLmFkU2Vzc2lvblR5cGUudG9Mb3dlckNhc2UoKSk7dmFyIGU7aWYoTShiKSl7aWYoZT1QKGIuZW52aXJvbm1lbnQsdWEpJiZQKGIuYWRTZXNzaW9uVHlwZSxxYSkpZT1iLm9taWROYXRpdmVJbmZvLGU9TShlKT9PKGUucGFydG5lck5hbWUpJiZPKGUucGFydG5lclZlcnNpb24pOiExO2UmJihlPWIuYXBwLGU9TShlKT9PKGUubGlicmFyeVZlcnNpb24pJiZPKGUuYXBwSWQpOiExKX1lbHNlIGU9ITE7aWYoZSl7aWYoS2IoZCkpe2U9cChPYmplY3QudmFsdWVzKGQpKTtmb3IodmFyIGY9ZS5uZXh0KCk7IWYuZG9uZTtmPWUubmV4dCgpKWYudmFsdWUuYWNjZXNzTW9kZT0nbGltaXRlZCc7dGhpcy5nLkE9bmV3IE1hcChPYmplY3QuZW50cmllcyhkKSl9ZWxzZSB0aGlzLmcuTj0hMDtkPXRoaXMuajtjPXZvaWQgMD09PWM/bnVsbDpjO251bGw9PWEmJihhPQpUYigpKTtiLmNhbk1lYXN1cmVWaXNpYmlsaXR5PWQuaC5IKCk7ZC5nLmFkU2Vzc2lvbklkPWE7YT1kLmc7ZT1iO3ZvaWQgMCE9PWUuY29udGVudFVybCYmKGEuRD1lLmNvbnRlbnRVcmwsZS5jb250ZW50VXJsPXZvaWQgMCk7ZT1hLml8fHt9O2Iub21pZEpzSW5mbz1PYmplY3QuYXNzaWduKHt9LGUub21pZEpzSW5mb3x8e30sYi5vbWlkSnNJbmZvfHx7fSk7ZT1iPU9iamVjdC5hc3NpZ24oe30sZSxiKTthLkl8fChudWxsIT1hLmw/KGUudmlkZW9FbGVtZW50PWEubCxlLmFjY2Vzc01vZGU9J2Z1bGwnKTpudWxsIT1hLmomJihlLnNsb3RFbGVtZW50PWEuaixlLmFjY2Vzc01vZGU9J2Z1bGwnKSk7YS5pPWI7ZmIoZC5pLGMpO2QuaCYmUihkLmgpfWVsc2UgRygnTmF0aXZlIGFkIHNlc3Npb24gY29udGV4dCBpbnZhbGlkOyBzZXNzaW9uIG5vdCBzdGFydGVkLicpfTtuLlk9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmo7a2IoYS5pKTthLmguQSgpfTsKbi5nYT1mdW5jdGlvbihhKXtNKGEpJiZOKGEueCkmJk4oYS55KSYmTihhLndpZHRoKSYmTihhLmhlaWdodCkmJih0aGlzLmcuTD1hLHNiKHRoaXMuaSwnY29udGFpbmVyJykpfTtuLmhhPWZ1bmN0aW9uKGEpe1AoYSx0YSkmJih0aGlzLmcuQz1hLCdiYWNrZ3JvdW5kZWQnPT09YT9zYih0aGlzLmksJ2NvbnRhaW5lcicsJ2JhY2tncm91bmRlZCcpOnNiKHRoaXMuaSwnY29udGFpbmVyJykpfTtuLmNhPWZ1bmN0aW9uKGEpeydpbXByZXNzaW9uJz09PWEmJih0aGlzLlMoKSx0aGlzLmwmJlIodGhpcy5sKSl9O24uUz1mdW5jdGlvbigpe3JiKHRoaXMuaCwnbmF0aXZlJykmJmxiKHRoaXMuaCwnbmF0aXZlJyl9O24uWj1mdW5jdGlvbihhKXthPXZvaWQgMD09PWE/bnVsbDphO0wodGhpcy5oLCduYXRpdmUnKSYmbWIodGhpcy5oLCduYXRpdmUnLGEpfTtuLmVycm9yPWZ1bmN0aW9uKGEsYil7UChhLHBhKSYmZWIodGhpcy5oLGEsYil9O24uZGE9ZnVuY3Rpb24oYSxiKXt0aGlzLlQoYSxiKX07Cm4uVD1mdW5jdGlvbihhLGIpe0wodGhpcy5oLCduYXRpdmUnKSYmUChhLHcpJiYodm9pZCAwPT09Ynx8TShiKSkmJignbG9hZGVkJz09YT9tYih0aGlzLmgsJ25hdGl2ZScsYik6bmIodGhpcy5oLGEsJ25hdGl2ZScsYikpfTtuLmVhPWZ1bmN0aW9uKGEpe2lmKCdub25lJyE9PXRoaXMuaC5nLm8mJidudW1iZXInPT09dHlwZW9mIGEmJiFpc05hTihhKSl7dGhpcy5nLkg9YTthPXRoaXMubTt2YXIgYj1hLmcuSjtudWxsIT1iJiZuYihhLmgsJ3ZvbHVtZUNoYW5nZScsJ25hdGl2ZScse21lZGlhUGxheWVyVm9sdW1lOmIsZGV2aWNlVm9sdW1lOmEuZy5IfSl9fTtuLmZhPWZ1bmN0aW9uKGEpe2lmKGEmJk0oYSkmJk4oYS50aW1lc3RhbXApKXt2YXIgYj0odGhpcy5nLnZ8fHt9KS50aW1lc3RhbXA7aWYoIWJ8fGI8YS50aW1lc3RhbXApdGhpcy5nLnY9YX19O1oucHJvdG90eXBlLnN0YXJ0U2Vzc2lvbj1aLnByb3RvdHlwZS4kO1oucHJvdG90eXBlLmVycm9yPVoucHJvdG90eXBlLmVycm9yOwpaLnByb3RvdHlwZS5maW5pc2hTZXNzaW9uPVoucHJvdG90eXBlLlk7Wi5wcm90b3R5cGUucHVibGlzaEFkRXZlbnQ9Wi5wcm90b3R5cGUuY2E7Wi5wcm90b3R5cGUucHVibGlzaEltcHJlc3Npb25FdmVudD1aLnByb3RvdHlwZS5TO1oucHJvdG90eXBlLnB1Ymxpc2hWaWRlb0V2ZW50PVoucHJvdG90eXBlLmRhO1oucHJvdG90eXBlLnB1Ymxpc2hNZWRpYUV2ZW50PVoucHJvdG90eXBlLlQ7Wi5wcm90b3R5cGUucHVibGlzaExvYWRlZEV2ZW50PVoucHJvdG90eXBlLlo7Wi5wcm90b3R5cGUuc2V0TmF0aXZlVmlld0hpZXJhcmNoeT1aLnByb3RvdHlwZS5nYTtaLnByb3RvdHlwZS5zZXRTdGF0ZT1aLnByb3RvdHlwZS5oYTtaLnByb3RvdHlwZS5zZXREZXZpY2VWb2x1bWU9Wi5wcm90b3R5cGUuZWE7Wi5wcm90b3R5cGUuaW5pdD1aLnByb3RvdHlwZS5iYTtaLnByb3RvdHlwZS5zZXRMYXN0QWN0aXZpdHk9Wi5wcm90b3R5cGUuZmE7ZnVuY3Rpb24ga2MoKXt2YXIgYT1YLGI9bGMsYz10aGlzO3ZhciBkPXZvaWQgMD09PWQ/RDpkO3RoaXMuaj1hO3RoaXMuZz1iO3RoaXMubT17fTt0aGlzLmw9e307dGhpcy5pPW5ldyBXO2Qub21pZD1kLm9taWR8fHt9O2Qub21pZC52MV9WZXJpZmljYXRpb25TZXJ2aWNlQ29tbXVuaWNhdGlvbj10aGlzLmk7dGhpcy5oPW51bGw7ZCYmZC5hZGRFdmVudExpc3RlbmVyJiZkLnBvc3RNZXNzYWdlJiYodGhpcy5oPW5ldyBTYihkKSk7dGhpcy5pLmc9ZnVuY3Rpb24oZSxmKXttYyhjLGUsZixjLmkpfTt0aGlzLmgmJih0aGlzLmguZz1mdW5jdGlvbihlLGYpe2MuaCYmbWMoYyxlLGYsYy5oKX0pfW49a2MucHJvdG90eXBlO24uYWRkRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbihhLGIsYyl7dGhpcy5qLmFkZEV2ZW50TGlzdGVuZXIoYSxiLGMpfTtmdW5jdGlvbiBuYyhhLGIsYyxkKXtBYihhLmcsYixjLGQpfQpuLnNldFRpbWVvdXQ9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5nLnNldFRpbWVvdXQoYSxiKX07bi5jbGVhclRpbWVvdXQ9ZnVuY3Rpb24oYSl7dGhpcy5nLmNsZWFyVGltZW91dChhKX07bi5zZXRJbnRlcnZhbD1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmcuc2V0SW50ZXJ2YWwoYSxiKX07bi5jbGVhckludGVydmFsPWZ1bmN0aW9uKGEpe3RoaXMuZy5jbGVhckludGVydmFsKGEpfTtmdW5jdGlvbiBvYyhhLGIsYyxkKXt6YihhLmcsJ2Rvd25sb2FkSmF2YVNjcmlwdFJlc291cmNlJykoYixjLGQpfQpmdW5jdGlvbiBtYyhhLGIsYyxkKXtmdW5jdGlvbiBlKCl7dmFyIEY9bmV3IFYoZiwncmVzcG9uc2UnLGcsYWMoZyx1LmFwcGx5KDAsYXJndW1lbnRzKSkpO2QuaChGLGMpfXZhciBmPWIuaCxsPWIubWV0aG9kLGc9Yi52ZXJzaW9uO2I9YmMoZyxiLmcpO2lmKG51bGwhPVJiKGwsJ1ZlcmlmaWNhdGlvblNlcnZpY2UuJykpe2w9UmIobCwnVmVyaWZpY2F0aW9uU2VydmljZS4nKTt0cnl7c3dpdGNoKGwpe2Nhc2UgJ2FkZEV2ZW50TGlzdGVuZXInOnZhciBoPXAoYiksaz1oLm5leHQoKS52YWx1ZSxtPWgubmV4dCgpLnZhbHVlfHxwYyhjKTthLmFkZEV2ZW50TGlzdGVuZXIoayxlLG0pO2JyZWFrO2Nhc2UgJ2FkZFNlc3Npb25MaXN0ZW5lcic6dmFyIHQ9cChiKSxFPXQubmV4dCgpLnZhbHVlLEE9dC5uZXh0KCkudmFsdWV8fHBjKGMpO2JiKGEuaixlLEUsQSk7YnJlYWs7Y2FzZSAnc2VuZFVybCc6dmFyIEg9cChiKS5uZXh0KCkudmFsdWU7bmMoYSxILGZ1bmN0aW9uKCl7cmV0dXJuIGUoITApfSwKZnVuY3Rpb24oKXtyZXR1cm4gZSghMSl9KTticmVhaztjYXNlICdzZXRUaW1lb3V0Jzp2YXIgST1wKGIpLHVjPUkubmV4dCgpLnZhbHVlLHZjPUkubmV4dCgpLnZhbHVlO2EubVt1Y109YS5zZXRUaW1lb3V0KGUsdmMpO2JyZWFrO2Nhc2UgJ2NsZWFyVGltZW91dCc6dmFyIHdjPXAoYikubmV4dCgpLnZhbHVlO2EuY2xlYXJUaW1lb3V0KGEubVt3Y10pO2JyZWFrO2Nhc2UgJ3NldEludGVydmFsJzp2YXIgTmI9cChiKSx4Yz1OYi5uZXh0KCkudmFsdWUseWM9TmIubmV4dCgpLnZhbHVlO2EubFt4Y109YS5zZXRJbnRlcnZhbChlLHljKTticmVhaztjYXNlICdjbGVhckludGVydmFsJzp2YXIgemM9cChiKS5uZXh0KCkudmFsdWU7YS5jbGVhckludGVydmFsKGEubFt6Y10pO2JyZWFrO2Nhc2UgJ2luamVjdEphdmFTY3JpcHRSZXNvdXJjZSc6dmFyIEFjPXAoYikubmV4dCgpLnZhbHVlO29jKGEsQWMsZnVuY3Rpb24oRil7cmV0dXJuIGUoITAsRil9LGZ1bmN0aW9uKCl7cmV0dXJuIGUoITEpfSk7CmJyZWFrO2Nhc2UgJ2dldFZlcnNpb24nOnAoYikubmV4dCgpO3ZhciBCYz1DKCkuaS5vbWlkSnNJbmZvO2UoQmMuc2VydmljZVZlcnNpb24pfX1jYXRjaChGKXtkLmgobmV3IFYoZiwnZXJyb3InLGcsJ1xuICAgICAgICAgICAgICBuYW1lOiAnK0YubmFtZSsnXG4gICAgICAgICAgICAgIG1lc3NhZ2U6ICcrRi5tZXNzYWdlKydcbiAgICAgICAgICAgICAgZmlsZW5hbWU6ICcrRi5maWxlbmFtZSsnXG4gICAgICAgICAgICAgIGxpbmVOdW1iZXI6ICcrRi5saW5lTnVtYmVyKydcbiAgICAgICAgICAgICAgY29sdW1uTnVtYmVyOiAnK0YuY29sdW1uTnVtYmVyKydcbiAgICAgICAgICAgICAgc3RhY2s6ICcrRi5zdGFjaysnXG4gICAgICAgICAgICAgIHRvU3RyaW5nKCk6ICcrRi50b1N0cmluZygpKydcbiAgICAgICAgICAnKSxjKX19fQpmdW5jdGlvbiBwYyhhKXtmb3IodmFyIGI9QygpLk0sYz1wKGIua2V5cygpKSxkPWMubmV4dCgpOyFkLmRvbmU7ZD1jLm5leHQoKSl7ZD1kLnZhbHVlO3ZhciBlPWIuZ2V0KGQpO2lmKGUpe2lmKGUuY29udGVudFdpbmRvdz09PWEpcmV0dXJuIGQ7dHJ5e2lmKGUuY29udGVudFdpbmRvdy5PYmplY3QucHJvdG90eXBlLmlzUHJvdG90eXBlT2YoYSkpcmV0dXJuIGR9Y2F0Y2goZil7fX19fTtmdW5jdGlvbiBxYygpe3ZhciBhPUQuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7YS5pZD0nb21pZF92MV9wcmVzZW50JzthLm5hbWU9J29taWRfdjFfcHJlc2VudCc7YS5zdHlsZS5kaXNwbGF5PSdub25lJztELmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSl9ZnVuY3Rpb24gcmMoKXt2YXIgYT1uZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbihiKXtiLmZvckVhY2goZnVuY3Rpb24oYyl7J0JPRFknPT09Yy5hZGRlZE5vZGVzWzBdLm5vZGVOYW1lJiYocWMoKSxhLmRpc2Nvbm5lY3QoKSl9KX0pO2Eub2JzZXJ2ZShELmRvY3VtZW50LmRvY3VtZW50RWxlbWVudCx7Y2hpbGRMaXN0OiEwfSl9O3ZhciBYPW5ldyBWYSxsYz1uZXcgUztuZXcga2M7dmFyIHNjPW5ldyBmdW5jdGlvbigpe30sdGM9bmV3IGZ1bmN0aW9uKCl7fSxpYz1uZXcgZnVuY3Rpb24oKXt0aGlzLmg9WDt0aGlzLmk9dGM7dGhpcy5nPUMoKX0sQ2M7RD9DYz1ELkludGVyc2VjdGlvbk9ic2VydmVyJiYoRC5NdXRhdGlvbk9ic2VydmVyfHxELlJlc2l6ZU9ic2VydmVyKT9uZXcgVShELHNjLGljLFgpOm5ldyBUKEQsdGMsaWMsbGMsWCk6Q2M9bnVsbDt2YXIgWGI9Q2MsWWI9bmV3IGZ1bmN0aW9uKCl7dmFyIGE9WDt2YXIgYj12b2lkIDA9PT1iP0Q6Yjt0aGlzLmo9YTt0aGlzLmc9Yjt0aGlzLmk9QygpO3RoaXMuaD1bXX0sZWM9bmV3IFdiLGpjPW5ldyBmdW5jdGlvbigpe3ZhciBhPVgsYj1DKCk7dGhpcy5oPWE7dGhpcy5nPWJ9O0Qub21pZEJyaWRnZT1uZXcgWjtuZXcgZGM7CmlmKEQuZnJhbWVzJiZELmRvY3VtZW50JiYhKCdvbWlkX3YxX3ByZXNlbnQnaW4gRC5mcmFtZXMpKXt2YXIgRGM7aWYoRGM9bnVsbD09RC5kb2N1bWVudC5ib2R5KURjPSdNdXRhdGlvbk9ic2VydmVyJ2luIEQ7RGM/cmMoKTpELmRvY3VtZW50LmJvZHk/cWMoKTpELmRvY3VtZW50LndyaXRlKCc8aWZyYW1lIHN0eWxlPSJkaXNwbGF5Om5vbmUiIGlkPSJvbWlkX3YxX3ByZXNlbnQiIG5hbWU9Im9taWRfdjFfcHJlc2VudCI+PC9pZnJhbWU+Jyl9Owp9KS5jYWxsKHRoaXMsIHRoaXMpOw=="

    .line 21
    invoke-static {v5, v7}, Landroid/util/Base64;->decode(Ljava/lang/String;I)[B

    move-result-object v5

    .line 22
    new-instance v6, Ljava/lang/String;

    invoke-direct {v6, v5}, Ljava/lang/String;-><init>([B)V

    .line 23
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v5, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    const-string v6, "dmFyIGVsZW1lbnRUb1NjYWxlRm91bmQgPSBmYWxzZTsKICAgICAgICB2YXIgZWxlbWVudFRvU2NhbGUgPSBudWxsOwoKICAgICAgICBjb25zdCBjcmVhdGl2ZVJlc2l6ZSA9IGZ1bmN0aW9uIChwYXJlbnRfd2lkdGgsIHBhcmVudF9oZWlnaHQsIGVsZW1lbnQpIHsKICAgICAgICAgICAgbGV0IGNoaWxkX2RpdiA9IGVsZW1lbnQ7CgogICAgICAgICAgICBsZXQgY2hpbGRfaGVpZ2h0ID0gcGFyZW50X2hlaWdodDsKICAgICAgICAgICAgbGV0IGNoaWxkX3dpZHRoID0gcGFyZW50X3dpZHRoOwoKICAgICAgICAgICAgLy8gRFNQcyBjb3VsZCBiZSBhdHRhY2hpbmcgYmVhY29ucyhpbWcgMVgxKSBpbiBjaGlsZCBkaXYsIGRvIG5vdCBjb25zaWRlciBpdCBhcyBjcmVhdGl2ZSBmb3IgcmVzaXplCiAgICAgICAgICAgIGlmIChjaGlsZF9kaXYub2Zmc2V0SGVpZ2h0ID4gMSAmJiBjaGlsZF9kaXYub2Zmc2V0V2lkdGggPiAxKSB7CiAgICAgICAgICAgICAgICBjaGlsZF9oZWlnaHQgPSBjaGlsZF9kaXYub2Zmc2V0SGVpZ2h0OwogICAgICAgICAgICAgICAgY2hpbGRfd2lkdGggPSBjaGlsZF9kaXYub2Zmc2V0V2lkdGg7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxldCBhc3BlY3Rfd2lkdGggPSBjaGlsZF93aWR0aDsKICAgICAgICAgICAgbGV0IGFzcGVjdF9oZWlnaHQgPSBjaGlsZF9oZWlnaHQ7CiAgICAgICAgICAgIGlmIChjaGlsZF9oZWlnaHQgPCBwYXJlbnRfaGVpZ2h0IHx8IGNoaWxkX3dpZHRoIDwgcGFyZW50X3dpZHRoKSB7CiAgICAgICAgICAgICAgICBsZXQgcGFyZW50X2FzcGVjdCA9IHBhcmVudF93aWR0aCAvIHBhcmVudF9oZWlnaHQ7CiAgICAgICAgICAgICAgICBsZXQgY2hpbGRfYXNwZWN0ID0gY2hpbGRfd2lkdGggLyBjaGlsZF9oZWlnaHQ7CiAgICAgICAgICAgICAgICBsZXQgc2NhbGVfZmFjdG9yID0gMTsKICAgICAgICAgICAgICAgIGxldCBzY2FsZV9mYWN0b3JfeSA9IDE7CgogICAgICAgICAgICAgICAgaWYgKHBhcmVudF9hc3BlY3QgPiBjaGlsZF9hc3BlY3QpIHsKICAgICAgICAgICAgICAgICAgICBzY2FsZV9mYWN0b3IgPSAocGFyZW50X2hlaWdodCAvIGNoaWxkX2hlaWdodCk7CiAgICAgICAgICAgICAgICAgICAgYXNwZWN0X3dpZHRoID0gY2hpbGRfd2lkdGggKiBzY2FsZV9mYWN0b3I7CiAgICAgICAgICAgICAgICAgICAgYXNwZWN0X2hlaWdodCA9IHBhcmVudF9oZWlnaHQ7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHNjYWxlX2ZhY3RvciA9IChwYXJlbnRfd2lkdGggLyBjaGlsZF93aWR0aCk7CiAgICAgICAgICAgICAgICAgICAgc2NhbGVfZmFjdG9yX3kgPSAocGFyZW50X2hlaWdodCAvIGNoaWxkX2hlaWdodCk7CiAgICAgICAgICAgICAgICAgICAgYXNwZWN0X3dpZHRoID0gcGFyZW50X3dpZHRoOwogICAgICAgICAgICAgICAgICAgIGFzcGVjdF9oZWlnaHQgPSBjaGlsZF9oZWlnaHQgKiAoc2NhbGVfZmFjdG9yKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoYXNwZWN0X3dpZHRoIDwgcGFyZW50X3dpZHRoKSB7CiAgICAgICAgICAgICAgICAgICAgY2hpbGRfZGl2LnN0eWxlLm1hcmdpbkxlZnQgPSAocGFyZW50X3dpZHRoIC0gYXNwZWN0X3dpZHRoKSAvIDIgKyAicHgiOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChhc3BlY3RfaGVpZ2h0IDwgcGFyZW50X2hlaWdodCkgewogICAgICAgICAgICAgICAgICAgIGxldCB0cmFuc2xhdGlvblBpeGVscyA9IChwYXJlbnRfaGVpZ2h0IC0gY2hpbGRfaGVpZ2h0KSAvIDIgKyAicHgiOwogICAgICAgICAgICAgICAgICAgIGNoaWxkX2Rpdi5zdHlsZS50cmFuc2Zvcm0gKz0gInRyYW5zbGF0ZSgwcHgsIiArIHRyYW5zbGF0aW9uUGl4ZWxzICsgIikiOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNoaWxkX2Rpdi5zdHlsZS50cmFuc2Zvcm0gKz0gInNjYWxlKCIgKyBzY2FsZV9mYWN0b3IgKyAiLCIgKyBzY2FsZV9mYWN0b3JfeSArICIpIjsKICAgICAgICAgICAgfQogICAgICAgIH07CgogICAgICAgIGNvbnN0IGZpbmRFbGVtZW50QnlTaXplID0gZnVuY3Rpb24gKGN1cnJlbnRFbGVtZW50LCB3aWR0aCwgaGVpZ2h0KSB7CiAgICAgICAgICAgIGlmIChjdXJyZW50RWxlbWVudC5vZmZzZXRIZWlnaHQgPT09IGhlaWdodCAmJiBjdXJyZW50RWxlbWVudC5vZmZzZXRXaWR0aCA9PT0gd2lkdGgpIHsKICAgICAgICAgICAgICAgIGVsZW1lbnRUb1NjYWxlID0gY3VycmVudEVsZW1lbnQ7CiAgICAgICAgICAgICAgICBlbGVtZW50VG9TY2FsZUZvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoY3VycmVudEVsZW1lbnQuY2hpbGRyZW4ubGVuZ3RoICE9PSAwKSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGN1cnJlbnRFbGVtZW50LmNoaWxkcmVuLmxlbmd0aCAmJiAhZWxlbWVudFRvU2NhbGVGb3VuZDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgZmluZEVsZW1lbnRCeVNpemUoY3VycmVudEVsZW1lbnQuY2hpbGRyZW5baV0sIHdpZHRoLCBoZWlnaHQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBjb25zdCB1cGRhdGVDcmVhdGl2ZVNpemUgPSBmdW5jdGlvbiAod2lkdGgsIGhlaWdodCkgewogICAgICAgICAgICBlbGVtZW50VG9TY2FsZSA9IG51bGw7CiAgICAgICAgICAgIGVsZW1lbnRUb1NjYWxlRm91bmQgPSBmYWxzZTsKICAgICAgICAgICAgbGV0IHBhcmVudF9oZWlnaHQgPSBoZWlnaHQ7CiAgICAgICAgICAgIGxldCBwYXJlbnRfd2lkdGggPSB3aWR0aDsKICAgICAgICAgICAgbGV0IGFkX2NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoeWJpZC1hZCcpOwogICAgICAgICAgICBmaW5kRWxlbWVudEJ5U2l6ZShhZF9jb250YWluZXIsIDMyMCwgNDgwKTsKCiAgICAgICAgICAgIGlmIChlbGVtZW50VG9TY2FsZUZvdW5kICYmIGVsZW1lbnRUb1NjYWxlICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGNyZWF0aXZlUmVzaXplKHBhcmVudF93aWR0aCwgcGFyZW50X2hlaWdodCwgZWxlbWVudFRvU2NhbGUpOwogICAgICAgICAgICB9CiAgICAgICAgfQ=="

    .line 24
    invoke-static {v6, v7}, Landroid/util/Base64;->decode(Ljava/lang/String;I)[B

    move-result-object v6

    .line 25
    new-instance v8, Ljava/lang/String;

    invoke-direct {v8, v6}, Ljava/lang/String;-><init>([B)V

    .line 26
    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v3, "<head[^>]*>"

    .line 27
    invoke-static {v3, v2}, Ljava/util/regex/Pattern;->compile(Ljava/lang/String;I)Ljava/util/regex/Pattern;

    move-result-object v2

    .line 28
    invoke-virtual {v2, v0}, Ljava/util/regex/Pattern;->matcher(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;

    move-result-object v2

    .line 29
    invoke-virtual {v2, v7}, Ljava/util/regex/Matcher;->find(I)Z

    move-result v3

    if-eqz v3, :cond_4

    .line 30
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "<style>"

    invoke-virtual {v3, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, "body { margin:0; padding:0;}"

    invoke-virtual {v3, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, "*:not(input) { -webkit-touch-callout:none; -webkit-user-select:none; -webkit-text-size-adjust:none; }"

    invoke-virtual {v3, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, "</style>"

    invoke-virtual {v3, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    .line 31
    invoke-virtual {v2}, Ljava/util/regex/Matcher;->end()I

    move-result v2

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v7, "<meta name=\'viewport\' content=\'width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no\' />"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object p0

    invoke-virtual {v0, v2, p0}, Ljava/lang/StringBuffer;->insert(ILjava/lang/String;)Ljava/lang/StringBuffer;

    .line 32
    :cond_4
    invoke-virtual {v0}, Ljava/lang/StringBuffer;->toString()Ljava/lang/String;

    move-result-object p0

    return-object p0
.end method

.method private static removeAllScripts(Ljava/lang/String;)Ljava/lang/String;
    .locals 2

    const-string v0, ""

    if-eqz p0, :cond_1

    .line 1
    invoke-virtual {p0}, Ljava/lang/String;->isEmpty()Z

    move-result v1

    if-eqz v1, :cond_0

    goto :goto_0

    :cond_0
    const-string v1, "<script[\\s\\S]*?>[\\s\\S]*?<\\/script>"

    .line 2
    invoke-virtual {p0, v1, v0}, Ljava/lang/String;->replaceAll(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;

    move-result-object p0

    return-object p0

    :cond_1
    :goto_0
    return-object v0
.end method
